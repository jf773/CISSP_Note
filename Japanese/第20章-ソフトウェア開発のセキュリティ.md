# 第20章 ソフトウェア開発のセキュリティ

- [システム開発管理の紹介](#introducing-systems-development-controls)
  - [ソフトウェア開発](#software-development)
  - [システム開発ライフサイクル](#systems-development-life-cycle)
  - [ライフサイクルモデル](#life-cycle-models)
  - [ガントチャートとPERT](#gantt-charts-and-pert)
  - [変更管理と構成管理](#change-and-configuration-management)
  - [DevOps アプローチ](#the-devops-approach)
  - [アプリケーション プログラミング インターフェース](#application-programming-interfaces)
  - [ソフトウェアテスト](#software-testing)
  - [コードリポジトリ](#code-repositories)
  - [サービスレベル契約](#service-level-agreements)
  - [サードパーティソフトウェアの取得](#third-party-software-acquisition)
- [データベースとデータウェアハウスの構築](#establishing-databases-and-data-warehousing)
  - [データベース管理システムのアーキテクチャ](#database-management-system-architecture)
  - [データベーストランザクション](#database-transactions)
  - [マルチレベルデータベースのセキュリティ](#security-for-multilevel-databases)
  - [オープンデータベースコネクティビティ](#open-database-connectivity)
  - [NoSQL](#nosql)
- [ストレージの脅威](#storage-threats)
- [知識ベースシステムの理解](#understanding-knowledge-based-systems)
  - [エキスパートシステム](#expert-systems)
  - [機械学習](#machine-learning)
  - [ニューラルネットワーク](#neural-networks)
- [要約](#summary)

## システム開発管理の紹介
* 早い段階でセキュリティを構築すると、後から追加するよりも**安価**かつ**強力**になります。  
* 制御は、ポリシー、標準、安全なコーディング、厳格なテスト、変更/構成管理にわたります。

### ソフトウェア開発
セキュリティ タッチポイントは、**すべての** SDLC フェーズ (要件 ➝ 設計 ➝ コーディング ➝ テスト ➝ 展開 ➝ 保守) に存在します。

#### プログラミング言語
| 言語カテゴリ | 例 | セキュリティの長所 | セキュリティの短所 |
|-------------------|----------|---------------|---------------|
| **コンパイル済み** | C、C++、Go、Rust、Java (.class ファイル) | 📦 バイナリの改ざんが困難、実行時間が高速、メモリの安全性を強化可能 (Rust) | リバース エンジニアリングが可能、コンパイラ/フラグを誤って使用すると脆弱 |
| **インタープリタ** | Python、Perl、Ruby、JavaScript | ソースが閲覧可能 - ピアレビューに適しています 😎 | ソースが閲覧可能 - 変更しやすいですが、遅いです |
| **ハイブリッド / バイトコード** | Java (JVM)、.NET (CLR) | 移植性、ランタイム サンドボックス | バイトコードは依然として可逆的ですが、JIT により攻撃対象領域が生じます |

##### キーワード  
* **マシン言語** – 生の CPU オペコード。  
* **アセンブリ** – 機械語のニーモニック略語。  
* **高レベル** – 人間に優しく、コンパイラまたはインタープリタに依存します。  
* **難読化** – コンパイルされたコードを意図的に逆コンパイルしにくくします。

#### ライブラリ
* 再利用可能なコード (オープンソースまたは独自のもの)。  
* リスク: 継承された脆弱性 (例: OpenSSL の **Heartbleed**)、サプライ チェーン攻撃。  
* 軽減策: SBOM 📝、定期的なパッチ適用、依存関係スキャン (SCA)。

#### 開発ツールセット
* **IDE** – 統合開発環境 (Visual Studio、IntelliJ、RStudio など) は、編集 + デバッグ + ビルドを統合します。  
* 安全な IDE 構成により、危険なプラグインが無効になり、コード署名が強制され、SAST が実行されます。

#### オブジェクト指向プログラミング (OOP)
| コンセプト | 概要 | セキュリティの観点 |
|---------|-------|----------------|
| クラス / オブジェクト | ブループリントとインスタンス | カプセル化によりデータが隠され、攻撃対象領域が縮小されます。 |
| 継承 | サブクラスは親の特性を引き継ぎます | **置換** (Liskov) 原則に従います。 |
| ポリモーフィズム | 同じメッセージ ⇒ 異なる動作 | 予期しない権限の使用につながる不正使用を回避します。 |
| 凝集性（非常に良い） | 同様の目的の方法 | 監査を簡素化 🕵️‍♂️ |
| 結合度 (低良好) | 外部依存関係が少ない | 連鎖障害を制限します。 |

#### 保証
* システムの存続期間中、コントロールがポリシーを **正しく実装** するという確信。  
* Common Criteria 🔐 は評価保証レベル (EAL) 1 ～ 7 を提供します。

#### システム障害の回避と軽減
##### 入力検証
* サーバー側、ホワイトリスト、境界と制限のチェック、正規化。  
* 挿入されたメタ文字を拒否またはエスケープします。

##### 認証とセッション管理
* エンタープライズ IAM (SSO、MFA) を活用します。  
* 長くランダムなセッション トークン、タイムアウトと再認証。

##### エラー処理
* ユーザー向け ➝ 汎用。  
* 詳細なスタック トレースは保護されたログにのみ保存されます。

##### ログ記録
* 集中管理型、一度だけ書き込み可能、クロック同期。  
* OWASP では、認証失敗、アクセス制御エラー、改ざん、TLS の問題などをログに記録することを推奨しています。

##### フェイルセキュア vs. フェイルオープン
| モード | 説明 | 一般的な使用法 |
|------|--------------|--------------|
| **フェイルセキュア** 🔒 | 障害発生時にすべて拒否し、機密性/整合性を維持 | ほとんどのセキュリティ制御 |
| **フェールオープン** 🚦 | 可用性を維持するためにアクセスを許可する | 重要でないガード デバイス (まれ) |

### システム開発ライフサイクル

#### 🛡️ 概要  
セキュリティは、**SDLCのあらゆるフェーズにわたって計画、組み込み、管理されたときに最大のROIをもたらします**。ライフサイクルモデル（ウォーターフォール、アジャイル、スパイラルなど）は、開発を目標どおりに進め、セキュアコーディングのベストプラクティスを組み込み、CISSP試験の目標に沿ったプロジェクト管理の足場を提供します。

#### コアアクティビティの概要  

| SDLC アクティビティ | 目的 | セキュリティの焦点 🤔 |
|---------------|---------|-------------------|
| 概念的な定義 | プロジェクトの大まかな目的と範囲の草案 | **データ分類** と予備的な保護目標の特定 |
| 機能要件の決定 | システムが実行する必要があることを文書化します | 機密性、整合性、可用性 (CIA) 要件を組み込みます |
| 制御仕様の開発 | セキュリティ ニーズを具体的な制御に変換 | アクセス制御、暗号化、監査、フォールト トレランス |
| 設計レビュー | コーディング前にアーキテクチャを検証 | 設計が機能およびセキュリティ仕様を満たしていることを確認 |
| コーディング | セキュアコーディングの原則を使用して設計を実装 | 最小権限、入力検証、エラー処理に従う |
| コード レビューのウォークスルー | 欠陥と脆弱性のコード ピア レビュー | ロジック エラー、安全でない API、不適切な暗号の使用を検出 |
| システム テストのレビュー | システムが意図したとおりに動作し、セキュリティが確保されていることを検証 | 機能、セキュリティ、回帰、および **UAT** テスト |
| メンテナンスと変更管理 | 導入後の安全な運用の維持 | パッチ管理、インシデント対応、正式な変更管理 |

##### 概念定義  
* 利害関係者が合意した 1 段落の **コンセプト ステートメント**。  
* プロジェクトのビジョン、範囲、および**初期** (高レベル) セキュリティ要件を確立します。  
* デザイナーは**データ分類**と処理標準にフラグを立てます。

##### 機能要件の決定  
* 次の内容を含む**機能要件ドキュメント (FRD)**を作成します。  
  * **入力** – 受け入れられたデータ  
  * **動作** – ビジネスロジック/ルール  
  * **出力** – 生成されたデータ  
* 利害関係者の合意を得る必要があります。後で **UAT チェックリスト** として使用されます。

##### 制御仕様の開発  
* セキュリティ制御のプロアクティブな設計 - 決して後付けではありません。  
* 住所:  
  * **アクセス制御** (authN/authZ)  
  * **機密性** – 暗号化、保存データ/転送データの保護  
  * **整合性と説明責任** – ログ記録、監査  
  * **可用性** – 冗長性、フォールトトレランス  
* 設計が大幅に変更された場合は、コントロールを見直します。

##### 設計レビュー  
* 建築家がモジュール設計とタイムラインを最終決定します。  
* **正式なレビュー会議** により、制御仕様との整合性が確保されます。  
* セキュリティ専門家は、設計が CIA とコンプライアンスのニーズを尊重していることを検証します。

##### コーディング  
* 開発者は**セキュアコーディング標準**（入力検証、出力エンコード、最小権限モジュール、安全な API）に従います。  
* 脆弱性を早期に最小限に抑えることを目指します。後で修正するよりも安価です。

##### コードレビューのウォークスルー  
* スケジュールされたマイルストーンピアレビュー。  
* 論理的な欠陥、安全でないパターン、エラー処理の不足を検出します。  
* 知識の共有と一貫したコーディング スタイルを促進します。

##### システムテストのレビュー  
1. **開発者/統合テスト** – 明らかなエラーを検出します。  
2. **機能テスト** – 要件を検証します。  
3. **セキュリティ テスト** – 侵入、ファジング、脆弱性スキャン。  
4. **回帰テスト** – 更新によって既存の機能が損なわれないことを確認します。  
5. **ユーザー受け入れテスト (UAT)** – エンドユーザーがビジネスへの適合性を検証します。  

> 📌 **成果物**: 監査証跡用の署名済みテスト計画と結果アーカイブ。

##### 保守と変更管理  
* 継続的な運用には以下が必要です。  
  * 定期メンテナンスおよび緊急メンテナンス  
  * **パッチと脆弱性の管理**  
  * パフォーマンス/セキュリティ監視  
* すべての更新は、**正式な変更管理プロセス** (識別、評価、承認、実装、レビュー) を経て、整合性とコンプライアンスを維持します。

##### 試験のヒント 📖  
* **セキュリティを早期に組み込む** か、後から追加するかについての質問が予想されます。  
* **UAT、回帰テスト、機能テスト** の違いを理解する。  
* 覚えておいてください: 変更管理 = **不正な変更** に対する保護。  
* SDLC アクティビティは、CISSP CBK ドメイン 8「ソフトウェア開発セキュリティ」に密接にマッピングされます。

### ライフサイクルモデル

#### 📚 概要  
ライフサイクルモデルは**ソフトウェア開発ライフサイクル（SDLC）**を形式化し、すべてのフェーズにセキュリティを組み込みます。CISSPドメイン8では、以下のスキルが求められます。  

* 主要な SDLC フレームワークを認識し、それが最適な場合を把握します。  
* セキュリティ アクティビティが各モデルにどのようにマッピングされるかを理解します。  
* 組織のソフトウェア プロセス能力を評価する成熟度フレームワーク (CMM、SAMM、IDEAL) を評価します。  

#### ウォーターフォールモデル  

##### 主な特徴  
* **シーケンシャル/フェーズゲート**: システム要件 → ソフトウェア要件 → 予備設計 → 詳細設計 → コードとデバッグ → テスト → 運用と保守  
* **反復ウォーターフォール** は *フィードバック ループ* 🌀 を追加し、プロジェクトが **1 つの** フェーズに戻って、発見された欠陥を修正できるようにします。  
* **検証と検証**:  
  * **検証** – *正しく構築できましたか?*  
  * **検証** – *正しいものを構築できましたか?*  

##### 強みと弱み  

| 👍 強み | 👎 弱み |
|-------------|--------------|
| 明確なマイルストーンとドキュメント | 欠陥の発見が遅れる |
| よく理解され、変更の少ないプロジェクトに適しています | 変化する要件に対応するのは困難です |
| 規制コンプライアンス監査の簡素化 | 早期のビジネス価値の提供はまれ |

#### スパイラルモデル  

##### 主な特徴  
* **バリー・ボーム (1988)**; *メタモデル* (モデルのモデル)。  
* ウォーターフォール サイクル (「ループ」) を繰り返して、増分プロトタイプ (P1、P2、P3) を生成します。  
* 各ループは、**リスク分析** → エンジニアリング → 評価 → 計画を扱います。  
* 変化する要件に合わせて**計画に戻る**ことが可能になります。  

##### スパイラルの強さ  
* 高リスク項目の早期検出・軽減。  
* 段階的な改良により、使用可能なプロトタイプがより早く作成されます。  
* 大規模でリスクが高く、進化するシステムに適しています。

#### アジャイルソフトウェア開発  

##### アジャイルマニフェストのハイライト  
* **プロセス/ツールよりも個人とインタラクション** を重視します。  
* **動作するソフトウェア** 徹底的なドキュメントよりも。  
* **顧客との協力** 契約交渉において。  
* **変化に対応する** 厳格な計画に従うことよりも。  

###### アジャイル原則（要約）  
早期かつ継続的なデリバリー、歓迎すべき変化、頻繁なリリース、日々のビジネス開発コラボレーション、やる気のあるチーム、対面でのコミュニケーション、進捗指標としてのソフトウェアの活用、持続可能なペース、技術的な卓越性、シンプルさ、自己組織化チーム、定期的な反映。

##### 一般的な方法論  

| 方法論 | コアアイデア | セキュリティフック |
|-------------|------------|----------------|
| **スクラム** | 毎日のスタンドアップ (スクラム)、1～4 週間の **スプリント**、スクラム マスターが促進し、各スプリントで出荷可能な製品の増分を提供 | **セキュリティ ユーザー ストーリー** を統合、*完了の定義* にセキュリティ基準を含む |
| **カンバン** | カンバン ボードによる WIP 制限付きの継続的なフロー | **セキュリティ タスク/レーン** による継続的な強化 |
| **エクストリーム プログラミング (XP)** | ペア プログラミング、TDD、継続的インテグレーション | 組み込みテストにより安全なコードがサポートされ、ペア レビューにより欠陥が削減されます |
| **Lean / RAD / DSDM / AUP** | 無駄の削減やラピッドプロトタイピングに重点を置いたバリエーション | **セキュアコーディング** チェックリストを迅速なサイクルで適用 |

#### 統合製品チーム  

* **DoD コンセプト (1995)** – 部門横断的なチーム (開発、運用、セキュリティ、ビジネス) が製品ライフサイクルを通じて継続的に連携します。  
* 分野間での**並行した意思決定**と早期のセキュリティ統合を促進します。

#### スケールドアジャイルフレームワーク（SAFe）  

##### 構成レベル  

| レベル | 範囲 | 注記 |
|-------|-------|-------|
| **必須** | 基礎; **アジャイル リリース トレイン (ART)** はプログラム増分 (8～12 週間) を提供します | チーム レベルでの従来の Scrum と XP |
| **大規模ソリューション** | 複数の ART を調整 | システムオブシステムの追加ロール/アーティファクト |
| **ポートフォリオ** | **リーン ポートフォリオ管理** を介して戦略と投資を調整します | **エピック**、**バリュー ストリーム** を使用します |
| **フル** | 上記のすべてを組み合わせ、企業全体の俊敏性をサポート | 数百/数千人の専門家向け |

##### 10 の SAFe 原則 (覚えておくべきヒント: **EAST CALM-O!** 🧭)  
1. 経済的観点  
2. システム思考を適用する  
3. 変動性/オプションの保存  
4. 段階的にテストと構築を行う  
5. 客観的なマイルストーンによるチェックポイント  
6. 価値の流れを許可する  
7. リズムを崩さずに同期させる  
8. 知識労働者のモチベーションを高める  
9. 意思決定を分散化する *(-O は価値を中心に組織化する)*  
10. 価値を中心に整理する  

#### 能力成熟度モデル (CMM) と CMM 統合 (CMMI)  

| レベル | 名前 (CMM) | 主な焦点 | セキュリティへの影響 |
|-------|------------|---------------|-----------------------|
| **1** | 初期 | アドホック / 無秩序なプロセス | 予測不可能な品質、高リスク |
| **2** | 繰り返し可能 | 基本的な PM と再利用 | 構成管理、QA ポイントが文書化されています |
| **3** | 定義済み | 組織全体の標準 | セキュリティ ポリシーの統合の開始 |
| **4** | 管理済み ★ (CMMI: *定量的に管理*) | メトリックと定量的制御 | 欠陥密度、脆弱性の傾向を測定 |
| **5** | 最適化 | 継続的な改善 | プロアクティブな欠陥防止と脅威インテリジェンス ループ |

> 🗝️ **違い**: CMM は *分離された* プロセスを対象としますが、 **CMMI** は組織全体でそれらのプロセスを *統合* することに重点を置いています。

#### ソフトウェア保証成熟度モデル (SAMM) – OWASP  

| ビジネス機能 | セキュリティプラクティス |
|-------------------|--------------------|
| **ガバナンス** | 戦略と指標、ポリシーとコンプライアンス、教育とガイダンス |
| **設計** | 脅威モデル、セキュリティ要件、セキュリティ アーキテクチャ |
| **実装** | セキュアビルド、セキュアデプロイメント、欠陥管理 |
| **検証** | アーキテクチャ評価、要件駆動テスト、セキュリティ テスト |
| **運用** | インシデント管理、環境管理、運用管理 |

*成熟度を評価し、セキュリティ活動を SDLC に組み込むためのロードマップをガイドします。*

#### 理想的なモデル  

| フェーズ | 目的 |
|-------|----------|
| **開始** | ビジネス推進要因を特定し、スポンサーシップを確立 |
| **診断** | 現在の状態を評価し、改善を推奨 |
| **確立** | 実行可能な作業計画を策定 |
| **実行** | ソリューションを実装、テスト、改良 |
| **学習** | 結果を分析し、改善点をフィードバック |

> 👁️‍🗨️ **記憶法** SW-CMM と IDEAL の組み合わせを思い出すには:  
> 「*私…私、エド博士は、低いです。*」  
> *II DR ED AM LO* → **開始、診断、確立、実行、学習** (IDEAL) 対 **初期、再現可能、定義、管理、最適化** (CMM)。

#### モデル比較表  

| モデル | スタイル | 変更を処理しますか? | セキュリティ統合ポイント |
|-------|-------|-----------------|----------------------------|
| ウォーターフォール | シーケンシャル | 不十分 (フィードバックは 1 フェーズのみ) | 要件の後で仕様を制御 |
| スパイラル | 反復的なリスク主導 | 優秀 (各ループで再評価) | ループごとのリスク分析 |
| アジャイル / スクラム | 増分、タイムボックス | 優秀 (バックログの優先順位が再設定) | スプリントごとのセキュリティ ストーリー、CI/CD テスト |
| SAFe | 大規模なアジャイル | 優秀 (ART PI 計画) | 完了の定義、実践コミュニティにセキュリティが組み込まれています |
| CMMI / IDEAL | *プロセス成熟度* フレームワーク | N/A (開発スタイルではなく組織を評価) | セキュリティ成熟度はレベルに応じて増加します |
| SAMM | *セキュリティ成熟度*フレームワーク | N/A | セキュリティ アクティビティを SDLC 機能に直接マッピングします |

#### CISSP 試験のヒント 💡  
* ウォーターフォール vs. スパイラル vs. アジャイル = **変更管理とリスク処理** の違いを理解する。  
* CMM/CMMI 成熟度 **レベルとキーワード** はテストのお気に入りです。  
* アジャイル セキュリティ = 各スプリントに **ユーザー ストーリー、脅威モデリング、自動テスト** を組み込みます。  
* SAFe は **Essential ➜ Full** レイヤーを追加します。**ART** と **Program Increments** に注意してください。  
* SAMM と IDEAL は出現頻度は低いですが、**継続的な改善** の概念を強化します。

### ガントチャートとPERT

#### 📚 概要  
プロジェクトスケジューリングツールは、**タスク、期間、依存関係、リソース**を視覚化することで、複雑なソフトウェア開発プロジェクトを順調に進めることができます。試験に関連する2つの手法は、**ガントチャート**と**プログラム評価レビュー手法（PERT）**です。  
*それぞれの使用時期、図の解釈、基本的な計算 (PERT の予想時間と標準偏差など) に関する質問が予想されます。*⚠️

#### ガントチャート  

＃＃＃＃＃ コンセプト  
* タスク (行) を **タイムライン** (列) に対してマッピングする水平の **棒グラフ**。  
* 各バーの長さ = タスクの期間、位置 = 開始日/終了日。  
* **マイルストーン** はダイヤモンドまたは特別なマーカーとして表示されます。  
* **依存関係** は接続矢印として表示される場合があります。  

###### 利点  
1. **直感的な視覚化** – 関係者は進捗状況をすぐに確認できます。  
2. **リソース調整** – 重複によりリソースの競合が明らかになります。  
3. **ベースラインと実際** – スケジュールの差異を追跡します📊。  

###### 制限事項  
* **複雑なタスク関係** (複数の先行タスク) を表現するのが難しくなります。  
* 非常に大規模なプロジェクトでは乱雑になる可能性があります。  

#### プログラム評価レビュー手法 (PERT)  

＃＃＃＃＃ コンセプト  
* **タスクのシーケンスと依存関係**を示す**ネットワーク図**。  
* ノード = マイルストーン/イベント、矢印 = タスク (アクティビティ)。  
* 時間の不確実性に対処するために *確率的推定* を組み込みます ⏳。  

###### 3点推定  
各アクティビティについて、次の情報を収集します。  
* **O** – 楽観的な時間（最良のケース）  
* **M** – 最も可能性の高い時間  
* **P** – 悲観的な時間（最悪の場合）  

> **予想時間（TE）**  
> \( TE = \dfrac{O + 4M + P}{6} \)

> **標準偏差（σ）**  
> \( σ = \dfrac{P - O}{6} \)

*スケジュールのリスクを定量化し、バッファを通知するために使用されます。*

###### クリティカルパス  
* **ネットワークを通過する最長時間パス**。  
* **Slack/float** = プロジェクトを遅らせることなくアクティビティを延期できる時間。  
* クリティカル パスの遅延 → プロジェクト全体が遅れる 🚨。  

#### 比較表  

| 機能 | **ガントチャート** | **PERT** |
|---------|-----------------|-----------|
| プライマリ ビュー | タイムライン バー | ネットワーク ダイアグラム |
| 最適な用途 | 進捗状況とリソース割り当ての視覚化 | タスクの **シーケンス**、**不確実性**、クリティカル パスの分析 |
| 時間見積もり | 決定論的 (単一期間) | 確率論的 (O、M、P) |
| リスク メトリック | スケジュール差異の追跡 | σ と予想時間で **スケジュール リスク** を計算 |
| 複雑さの処理 | 中程度。乱雑になる可能性あり | 複雑な依存関係の処理に優れています |
| 一般的な使用方法 | ステータス レポート ✔️ | 計画と what-if 分析 ✔️ |

#### CISSP のヒント 💡  

* TE と σ の PERT 式を **暗記** してください。これらは模擬試験に出題されます。  
* 覚えておいてください: **Gantt = タイムライン**、**PERT = ネットワーク + 確率**。  
* 試験で、**リソースの競合**や**経営陣へのスケジュールの伝達に重点が置かれている場合は→ガントチャート**。**クリティカルパス、依存関係、リスクバッファーに重点が置かれている場合は→PERT**。  

### 変更および構成管理

#### 🗺️ 全体像  
コードが本番環境に昇格された後は、**新しい機能の追加、バグ修正、メンテナンス**が避けられません。  
*制御されていない変更 ➡️ 不安定性、セキュリティ ホール、監査の失敗。*  
CISSP 候補者は、整合性、可用性、追跡可能性を維持する **プロセス規律** を理解している必要があります。

#### 変更管理 🙋‍♀️

＃＃＃＃＃ 目的  
* 生産システムを変更するための**整理された監査可能なフレームワーク**を提供します。  
* **承認、テスト、ドキュメント化、ロールバック** がすべての変更の不可欠な部分であることを確認することで、リスクを最小限に抑えます。

##### 3つのコアコンポーネント  

| コンポーネント | 主なアクティビティ | セキュリティへの影響 |
|-----------|----------------|-----------------|
| **リクエスト制御** | • ユーザー/開発者が正式な変更リクエストを送信します 📝 <br>• 経営陣がコスト/利益と優先順位付けを実行します| *ビジネス上の正当性*と*リスク評価*を保証します。 |
| **変更管理** | • 開発者が問題を再現するか、機能を構築します <br>• コード、構成、またはインフラストラクチャの変更が非本番環境で作成およびテストされます <br>• 品質ゲート + ピアレビュー | 許可されていない変更や設計が不十分な変更が本番環境に到達するのを防ぎます。 |
| **リリース管理** | • 最終承認 ✔️ <br>• **受け入れテスト** 関係者による <br>• デバッグ コードやバックドアが残っていないことを確認 <br>• 制御されたメカニズムによるデプロイ (CMDB 更新) | **CIA** を維持しながら、検証されたバージョンのみがライブ環境にリリースされることを保証します。 |

> 💡 **試験のヒント:** *ファイル整合性監視* + 変更チケット🎫 = 不正な変更の迅速な検出であることを理解してください。

#### 構成管理 🗄️

> **目標:** 企業全体で **一貫性があり、安全で、既知の** ソフトウェア状態を維持します。

##### 4つの柱  

1. **構成の識別**  
   *インベントリとベースライン* すべてのソフトウェア/ファームウェアのバージョンとその場所。

2. **構成管理**  
   **承認されたパッケージのみ** が展開されるように強制します。変更管理ワークフローに直接結び付けられます。

3. **構成ステータスのアカウンティング**  
   承認されたすべての変更を継続的に**記録**します。

4. **構成監査**  
   定期的なレビュー🔍 生産が文書化されたベースラインと等しいことを確認し、不正な変更を発見します。

#### 変更管理と構成管理 - クイックビュー  

| 側面 | **変更管理** | **構成管理** |
|--------|------------------|-------------------------|
| 焦点 | システムを変更する*プロセス* | 変更後のシステムの*状態* |
| トリガー | 新しい要件、欠陥、または機能強化のリクエスト | ベースラインからのドリフトの検出 |
| 出力 | 承認された変更パッケージ、更新されたチケット | 更新されたベースライン、CMDB エントリ |
| キー管理 | 要求 / 変更 / リリース サイクル | 識別 / 管理 / アカウンティング / 監査 |

#### セキュリティユースケースの例  

*ファイル整合性監視（FIM）システム*  
1. FIM は `/opt/app/bin/login` のハッシュの変更を検出します😱  
2. SOC は **変更チケット #1234** と相関します。  
3. **一致** の場合 → イベントは正当なものとして記録されます。  
4. **相関関係なし**の場合 → IR にエスカレーションします。マルウェア/改ざんの可能性があります。  

**結果:** 管理のノイズが軽減され、アラートが実行可能になります。

#### CISSP 試験のヒント 🎯  

* **リクエスト、変更、リリース** 制御の定義を期待します。  
* **SCM** コンポーネントを変更管理段階と区別します。  
* 両方のプロセスが**監査、調査、トラブルシューティング、コンプライアンス**に証拠を提供することを理解してください。  
* ツール (FIM、CMDB、バージョン管理) がこれらのフレームワークをどのようにサポートするかを理解します。  

### DevOpsアプローチ

＃＃＃＃ 概要
DevOps は、**ソフトウェア開発**、**品質保証**、および **IT 運用** を統合して、安全で高品質のソフトウェアを **迅速かつ**確実に**提供します。

- 組織のサイロを破壊します🤝  
- 自動化、コラボレーション、継続的なフィードバックを重視  
- **アジャイル**の価値と原則に沿っている  

#### 主な特徴

| 特徴 | 従来のモデル | DevOps モデル |
| :-- | :-- | :-- |
| チーム構造 | 開発 / QA / 運用のサイロを分離 | 部門横断的、協調的 |
| デプロイメント頻度 | 四半期ごと / 年ごと | 1 日に複数回 (CI/CD) |
| フィードバック ループ | 遅い、手動 | 速い、自動化 🔄 |
| サイズの変更 | 大規模リリース | 小規模な増分 |
| 自動化 | 限定的 | パイプライン全体にわたって広範囲 ⚙️ |
| 文化 | 責任の押し付けと引き継ぎ | 責任の共有 |
| メトリクス | 稼働時間、リリース後の不具合 | リードタイム、MTTR、デプロイメントの成功 |

#### DevOps パイプラインのステージ

1. **計画** – 要件を取得し、バックログを更新します。  
2. **コード** – 開発者は共有リポジトリにコミットします。  
3. **ビルド** – 自動コンパイルと単体テストでコミットを検証します。  
4. **テスト** – 機能、統合、パフォーマンス、およびセキュリティのテストを自動化します。  
5. **リリース** – 成果物をパッケージ化し、承認をトリガーします。  
6. **デプロイ** – 本番環境への自動ロールアウト (ブルーグリーン、カナリアなど)。  
7. **運用** – KPI を監視、記録、測定します。  
8. **監視/フィードバック** – テレメトリは改善を**計画**にフィードバックします。

#### 継続的インテグレーション / 継続的デリバリー

| 用語 | 定義 | 主な利点 |
| :-- | :-- | :-- |
| 継続的インテグレーション (CI) | 自動ビルド/テストによるメイン ブランチへの頻繁なマージ | 統合の問題を早期に検出 🐛 |
| 継続的デリバリー (CD) | ステージング環境への自動リリース | 関係者からのフィードバックの迅速化 |
| 継続的デプロイ | テスト合格後の本番環境への自動プッシュ | オンデマンド、低リスクのリリース 🚀 |

#### DevSecOps（DevOpsにおけるセキュリティ）

セキュリティは**すべての**パイプライン ステージに統合されています (**シフトレフト**):

- **セキュリティ アズ コード** – パイプライン スクリプトにコード化されたポリシーと制御。  
- **自動スキャン** – SAST、DAST、依存関係、コンテナ、IaC スキャン 🛡️  
- **継続的なコンプライアンス** – リアルタイムの証拠収集と監査。  

> **目標:** セキュリティを犠牲にすることなく DevOps のスピードに匹敵する。

#### 自動化とツールのカテゴリ

| 機能 | 代表的なツール（例） |
| :-- | :-- |
| ソース管理 | Git、GitHub、GitLab |
| CI サーバー | Jenkins、GitHub Actions、GitLab CI |
| コンテナ化 | Docker、Podman |
| オーケストレーション | Kubernetes、OpenShift |
| コードとしてのインフラストラクチャ | Terraform、AWS CloudFormation |
| 構成管理 | Ansible、Puppet、Chef |
| 監視 / 可観測性 | Prometheus、Grafana、ELK スタック |
| セキュリティ スキャン | Snyk、Trivy、OWASP ZAP、SonarQube |

*(試験では、製品の詳細ではなく、カテゴリを把握してください。)*

#### ベストプラクティス

- **コラボレーションの文化** – 非難のない事後検証と共有 KPI。  
- **自動化ファースト** – 人的エラーを減らすために手動の手順をスクリプト化します。  
- **小さく元に戻せる変更** – 爆発半径を縮小し、迅速なロールバックを可能にします。  
- **すべてをバージョン管理** – コード、インフラストラクチャ、構成。  
- **監視と測定** – リードタイム、展開頻度、変更失敗率、MTTR。  
- **セキュリティを早期に組み込む** – CI での自動スキャン、ポリシー アズ コード。  

#### 試験のヒント

- **DevOps** を従来のサイロ化されたモデルと区別します。  
- CI/CD フローとその **セキュリティ タッチ ポイント** を理解します。  
- **DevSecOps** と「シフトレフト」セキュリティの概念を認識します。  
- 主要な**指標**を記憶します: リードタイム、展開頻度、MTTR、変更失敗率。  
- 自動化ツールのカテゴリとパイプラインにおけるその役割を思い出してください。

### アプリケーションプログラミングインターフェース

＃＃＃＃ 導入
現代のウェブアプリケーションは、単独で動作することはほとんどありません。代わりに、**アプリケーションプログラミングインターフェース（API）**を介して他のサービス（eコマース🛒、ソーシャルメディア📣、配送📦など）と**相互運用**されます。APIは、構造化されたリクエスト（REST、GraphQL、SOAPなど）を介して従来のウェブUIをバイパスし、バックエンド機能を他のアプリケーションに直接公開します。

#### 一般的な API 操作 (例: ソーシャル メディア)
| 操作 | 目的 |
| :-- | :-- |
| `PostStatus` | ユーザーコンテンツを公開する |
| `FollowUser` | 他のユーザーの更新を購読する |
| `UnfollowUser` | サブスクリプションを削除 |
| `LikePost` / `FavoritePost` | コンテンツに対する承認を表明 |

#### セキュリティに関する考慮事項

##### ⚙️ 認証と承認
- **パブリック API** – 読み取り専用、認証は不要 (例: 天気)。  
- **プライベート/パートナー API** – **API キー** または OAuth トークンが必要です。  
- **ユーザー スコープの API** – 呼び出しごとにユーザー ID と権限を検証する必要があります。

> 🔑 **API キー** はパスワードのように機能し、安全に保管し、**暗号化されたチャネル (TLS)** 経由でのみ送信します。

##### 🔄 入力検証とサニタイズ
- API 呼び出し内のパラメータを他の信頼できない入力と同様に扱います。  
- **SQLi、XSS、コマンド インジェクション** から保護します。

##### 🔒 トランスポートセキュリティ
- すべての API トラフィックに HTTPS/TLS を適用します。  
- 最新の暗号を使用し、弱いプロトコル (SSL 3.0、TLS <1.2) を無効にします。

##### 📈 レート制限とスロットリング
- クォータ、バースト制限、CAPTCHA による不正使用/DoS を防止します。

##### 📝 ログ記録と監視
- リクエストのメタデータ、認証結果、エラー コードを記録します。  
- 異常なパターン (スパイク、無効な認証試行など) を監視します。

#### API テストと評価

| テスト方法 | 説明 | ツール/テクニック |
| :-- | :-- | :-- |
| 機能テスト | 有効な入力に対する意図した出力を検証 | Postman、ユニットテスト |
| セキュリティ（ペン）テスト | 脆弱性の特定（認証バイパス、インジェクション、IDOR） | OWASP ZAP、Burp Suite |
| ファジング | ランダムなデータや不正な形式のデータを送信して障害を観察 | Boofuzz、Peach |
| 静的解析 (SAST) | 安全でないパターンのソースコードを評価 | SonarQube、Semgrep |
| 動的分析 (DAST) | 実行中のサービスの脆弱性をスキャン | OWASP ZAP、Nikto |

#### curl と直接 API のやり取り
- **curl** は、API の *テスト* および *活用* に使用されるコマンドライン HTTP クライアントです。  
- POSTリクエストの例:

      curl -H "コンテンツタイプ: application/json" \
           -X ポスト \
           -d '{"週":10,"hrv":80,"sleephrs":9,"sleepquality":2,"stress":3,"paxid":1}' \
           https://prod.myapi.com/v1

  - `-H` はヘッダーを設定します  
  - `-X`はメソッドを指定する  
  - `-d` は JSON ペイロードを提供します

- 攻撃者は curl (または同様のツール) を使用してブルート フォース攻撃やインジェクション攻撃を自動化する可能性があります。防御者は疑わしいパターンを **ログに記録し、検出し、ブロック** する必要があります。

#### API セキュリティのベストプラクティス ✅
- API トークンに**最小権限**を適用します。  
- **トークンのローテーション**と失効メカニズムを実装します。  
- 厳密な検証には**入力スキーマ** (JSON スキーマ、OpenAPI) を使用します。  
- **ゼロ トラスト** アプローチを採用します。内部トラフィックが安全であると決して想定しないでください。  
- **定期的なセキュリティ評価** を実行し、CI/CD に統合します。  
- **バージョン管理されたエンドポイント** を公開し、安全でないバージョンを廃止します。  
- クライアントのコンプライアンスを支援するために、**詳細なレート制限ヘッダー** を含めます。

#### 試験のヒント 🎯
- **API キー** のセキュリティとキー漏洩のリスクを理解します。  
- API の **認証と承認** の要件を思い出してください。  
- **curl** を直接対話ツール (テストと活用) として認識します。  
- セキュリティ制御を特定します: TLS、レート制限、入力検証、ログ記録。  
- DevSecOps パイプラインにおける **継続的なセキュリティ テスト** の必要性を理解する。

### ソフトウェアテスト

#### SDLCにおける目的と統合
* **包括的なテスト** は、社内配布または一般公開の前にリスク分析 🛡️ とリスク軽減を行うために不可欠です。
* 完全なカバレッジと事前に定義された期待される結果を確保するために、モジュールと **並行して** テストを設計します。
* **ユースケース** (通常の操作) と **誤用ケース** (攻撃者のシナリオ) の両方を組み込みます。

#### 合理性チェック
* 返された値が**許容範囲内**であることを検証します。
  * 例: 人間の体重を計測するアルゴリズムが **612 ポンド** を返す ⇒ 妥当性チェックに失敗します。

#### テストにおけるデータの処理
* 機密性と整合性を保護するために、開発初期段階では **ライブ/本番環境のデータを避けてください**。
* ストレス テストとエッジ ケースの評価には、合成データセットまたは**サニタイズされたデータセット**を使用します。

#### 職務の分離
| 役割 | 責任 | 根拠 |
|------|---------------|-----------|
| **開発者** | コードの作成と修正 | テストの偏りを防ぐ |
| **テスター/QA** | 独立した機能およびセキュリティテスト | 客観的な評価を提供 |
| **セキュリティレビュー担当者** | セキュリティ要件を検証 | コンプライアンスと防御を確保 |

#### テストの哲学
| アプローチ | ソースコードへのアクセス | 焦点 | 一般的な使用法 |
|----------|-----------------------|--------|-------------|
| **ホワイトボックス** | フル | 内部ロジックと制御フロー | ユニットテスト、コード監査 |
| **ブラックボックス** | なし | 入力 ↔ 出力 | ユーザーによる承認、最終検証 |
| **グレーボックス** | 限定的 | コードインサイトによる入出力 | 統合セキュリティ検証 |

#### セキュリティ重視のテスト
* **静的分析** (コードレビュー) – 実行せずにソース/バイナリを検査します。
* **動的分析** – 実際の環境/仮想環境で実行中のコードを評価します。
* **ファイル整合性監視** – 不正な変更を検出し、**変更管理** ワークフローと統合して誤検知を削減します。

#### 変更管理と構成管理の調整
1. **リクエスト制御** – 変更リクエストを記録し、優先順位を付けます。
2. **変更管理** – 更新の開発、テスト、ステージングを行います。
3. **リリース管理** – 更新プログラムの承認、展開、検証を行います。
4. **ソフトウェア構成管理 (SCM)** – バージョン追跡、監査、およびロールバック機能。

#### ドキュメント化と継続的な改善
* テスト計画と結果の**永久記録**を維持します。
* 学んだ教訓を **Agile/DevSecOps パイプライン** にフィードバックして、反復的な強化を行います。

##### 重要なポイント ✨
* 早期の独立した体系的なテストにより、**脆弱性** とプロジェクト リスクが軽減されます。
* **セキュリティ テスト ツール** (SAST、DAST、FIM) を CI/CD に統合します。
* **厳格な変更管理**を実施して、生産の整合性と迅速な問題解決を確保します。

### コードリポジトリ

#### ****共同開発における中心的な役割****
* 地理的に分散したチームにとって**唯一の真実の情報源**として機能します。  
* **バージョン管理**、**バグ追跡**、**リリース管理**、**チームコミュニケーション**を提供します。  
* 人気のプラットフォーム ⇒ **GitHub**、**Bitbucket**、**SourceForge** – **git** などのツールと緊密に統合されています。  

#### ****ライブラリとリポジトリの違い****
| コンセプト | 目的 | 範囲 |
|---------|---------|--------|
| **コード ライブラリ** | 再利用可能なパッケージ / モジュール | *単一* の関数または関数のセット |
| **リポジトリ** | エンドツーエンドのコラボレーション プラットフォーム | 完全な**プロジェクト**、複数のライブラリ、ドキュメント、CI/CD、問題追跡 |

リポジトリは多くの場合、内部ライブラリまたはパブリック ライブラリの配布を *ホスト* および *管理* します。

#### ****セキュリティリスクとアクセス制御****
* **アクセスデザイン**  
  * **読み取り** および **書き込み** 権限を **承認された** 個人にのみ付与します。  
  * 一般向けプロジェクト ⇒ 公開前にコンテンツをサニタイズします。  
* **過度に許容される読み取り** ▶︎ 独自のアルゴリズム、資格情報、または企業秘密の漏洩。  
* **過度に許可された書き込み** ▶︎ 不正なコード改ざん、バックドア、またはサプライチェーン攻撃。  

#### ****機密情報の落とし穴****
1. **APIキー**  
   * キーを使用すると、IaaS (AWS、Azure、GCP) をプログラムで制御できます。  
   * 公開 ⇢ 攻撃者がリソースをプロビジョニング → キー所有者にコストが請求されます。  
   * ボットはパブリックリポジトリを継続的にスキャンし、多くの場合 **数秒** 以内に検出されます。  
2. **パスワードと秘密**  
   * 秘密は **セキュア ボールト** または環境変数経由でのみ埋め込みます。  
   * データベース名、内部ホスト名、暗号化キーのハードコーディングは避けてください。

##### **軽減チェックリスト✅**
* **ブランチ保護** とプル リクエストのレビューを実施します。
* **コミット前フック** と **シークレットスキャンツール** (例: TruffleHog、Git-Secrets) を使用します。  
* 公開されたキーを**直ちに**ローテーションし、課金ダッシュボードで異常を監視します。  
* **暗号化されたシークレット マネージャー** (AWS Secrets Manager、HashiCorp Vault) を使用します。  
* リポジトリの権限を**定期的に**監査し、古くなったアクセスや不要なアクセスを削除します。  

### サービスレベル契約

#### ****目的と範囲****
* **サービスプロバイダー**と**顧客**間の正式な**コミットメント**。  
* **データ回線、アプリ、データベース、クラウド サービスなど** の測定可能な **パフォーマンス目標** を定義します。**  
* 期待値と救済策を設定することでビジネスの継続性を保護します。

#### ****主要パフォーマンス指標****
| メトリック | 説明 | 一般的なターゲット |
|--------|--------------|----------------|
| **システム稼働時間** | サービスが稼働している合計時間の割合 | 99.9% – 99.999% |
| **最大連続ダウンタイム** | 侵害前に許容される最長時間の単一停止 | 5～15 分 |
| **ピーク負荷処理** | 最大同時トランザクション数 / スループット | サービスごとに定義 |
| **平均負荷** | 通常の動作使用率 | ≤ 70% の容量 |
| **フェイルオーバー時間** | 冗長リソースへの切り替え時間 | < 60 秒 |

「診断の責任」 - SLA では、インシデントを調査して解決する当事者を明確に割り当てる必要があります。

#### ****執行と救済****
* **両当事者による合意された指標の継続的な監視**。  
* 違反が発生すると、**金銭的クレジット**、罰金、または延長サポートが発動されます。  
  * *例*: 15 分を超える停止 ⇒ *1 週間* の回線料金が免除されます。  
* **エスカレーション パス**、インシデント対応のタイムライン、レポート要件を規定できます。

#### ****ベストプラクティスチェックリスト✅****
* SLA メトリックを**ビジネス影響分析** (BIA) の結果と一致させます。  
* 測定方法と時間枠の**明確な定義**を含めます。  
* 変化するニーズに合わせて条件を調整するための**レビュー頻度**を確立します。  
* SLA 監視ダッシュボードを **アラートおよびチケット発行** システムと統合します。  
* 法律顧問が**救済条項**と責任限度額を確認することを確認します。  

### サードパーティソフトウェアの取得

#### ****獲得モデル****
* **商用オフザシェルフ (COTS)** – 組織はオンプレミスまたは IaaS でソフトウェアをインストールして管理します。  
* **サービスとしてのソフトウェア (SaaS)** – ベンダーがホストおよび運用し、ユーザーは Web/API 経由でアクセスします。  
* **オープンソースソフトウェア (OSS)** – コミュニティによって開発されており、自由に使用したり、他の製品に埋め込んだりできます。  
* **ハイブリッド使用** – ほとんどの企業は、さまざまなビジネスニーズを満たすために COTS、SaaS、OSS を組み合わせています。  

#### ****セキュリティ責任****
| モデル | 組織の義務 | ベンダーの義務 |
|-------|--------------|-----------------|
| **COTS** | セキュアな構成、パッチ管理、強化、監視 | 脆弱性の開示、パッチのリリース |
| **SaaS** | ベンダー評価、アカウントとアクセスの管理、コンプライアンスレビュー | インフラ + アプリのセキュリティ、パッチ適用、稼働時間 |
| **OSS** | コードレビュー、統合セキュリティ、コミュニティ パッチ追跡 | コミュニティがコードを保守し、修正を発行 |

**責任共有の原則:** モデルに関係なく、両方の当事者がセキュリティ負担の一部を負います。

#### ****デューデリジェンスとモニタリング****
* **監査、SOC レポート、ペンテスト** を通じてベンダーのセキュリティ体制を評価します。  
* 取得したすべてのソフトウェアの**セキュリティ情報とパッチ**を追跡します。  
* ベンダー契約における規制コンプライアンス (**GDPR、HIPAA、PCI-DSS など**) を確認します。  
* 導入された COTS / OSS の **継続的な脆弱性スキャン** を実装します。  

#### ****テスト要件****
1. **内部テスト** – 静的および動的分析、ファジング、統合テスト。  
2. **ベンダー提供の結果** – 侵入レポートとコード品質レポートを確認します。  
3. **独立したサードパーティテスト** – セキュリティに関する主張の客観的な検証。  

#### ****アクションチェックリスト✅****
* **すべてのサードパーティ製ソフトウェアとバージョン**の在庫を管理します。  
* セキュリティ更新とインシデント報告の**SLA/SLR条項**を定義します。  
* ベンダーに契約で**セキュリティ監査権**をサポートすることを要求します。  
* SaaS サービスで使用される **API キーとシークレット** の安全な管理を確保します。  
* パッチ展開パイプラインを自動化して、**平均修復時間 (MTTR)** を短縮します。  

## データベースとデータウェアハウスの構築  

### データベース管理システムのアーキテクチャ  
現代の企業はデータベース プラットフォームに大きく依存しており、それらを保護することは 🛡️ **機密性、整合性、可用性 (CIA)** にとって非常に重要です。  

##### 階層型および分散型 DBMS  
* **階層型 DBMS** – 1 対多の *ツリー* (親 ➜ 子) 構造。  
  * 例: 企業組織図、DNS 名前空間。  
  * 定義されたパスに沿った高速検索ですが、アドホック クエリの柔軟性は低くなります。  
* **分散 DBMS** – データは複数のネットワーク ノードに保存されますが、単一の論理 DB として表示されます。  
  * 多対多の関係。フォールト トレランスと負荷分散をサポートします。  
  * 同期、複製、強力なネットワーク セキュリティが必要です。  

##### リレーショナル DBMS (RDBMS)  
* 行 (**タプル**) と列 (**属性**) の **2 次元テーブル (リレーション)** に情報を格納します。  
* **1対1**のデータ マッピングを強制し、対話用の **SQL** をサポートします。  
* キーワード 🔑  
  | キーの種類 | 目的 | 例 |  
  |----------|---------|---------|  
  | 候補者 | 行を一意に識別する任意のフィールド | 会社 ID、電話番号 |  
  | プライマリ | 一意性のために使用される選択された候補 | 会社 ID |  
  | 代替 | 残りの候補キーが選択されていません | 電話 |  
  | 外部 | 別のテーブルの PK を参照し、**参照整合性** を保証します | 営業担当者 ID |  
* **カーディナリティ** – 行数。 **次数** – 列数。

| 従業員 ID | 従業員名 | 部門 |
|-------:|------------|------|
| 101 | アリス | HR |
| 102 | ボブ | IT |
| 103 | キャロル | IT |
| 104 | デイブ | セールス |
- **Cardinality (行数)** → **4**  
  4 行のデータがあります（Alice, Bob, Carol, Dave）。
- **次数（列数）** → **3**  
  列は `emp_id`, `emp_name`, `dept` の 3 つです。

* **SQL コンポーネント**:  
  * **DDL** – スキーマの作成/変更。  
  * **DML** – データの選択 / 挿入 / 更新 / 削除。  
  * きめ細かな承認 - テーブル、列、行、ビューごとに制限します。  

##### オブジェクトリレーショナルおよびオブジェクト指向 DBMS  
* **オブジェクト、クラス、継承** を使用してリレーショナル モデルを拡張します。  
* マルチメディア、CAD、複雑なデータとコードの再利用に適しています。  

#### データベーストランザクション 🔄  
| ACID プロパティ | 説明 | セキュリティ上の利点 |  
|---------------|-------------|------------------|  
| 原子性 | 「すべてかゼロか」; 失敗した場合はロールバック | 部分的な更新を防止 ↩️ |  
| 一貫性 | トランザクションは DB を有効な状態のままにします | 整合性を維持します ✔️ |  
| 分離 | 同時トランザクションが干渉しない | 競合状態を阻止 |  
| 耐久性 | コミットされたデータはクラッシュしても存続します | 可用性を向上します |  

Atomicity → “途中でやめない”
Consistency → “ルールを崩さない”
Isolation → “他の人とはぶつからない”
Durability → “確定したら消えない”
*一般的なフロー:* `BEGIN TRAN; … COMMIT;` または `ROLLBACK;`  

#### マルチレベルデータベースのセキュリティ  
* **ポリインスタンス化** – PK は同じだが機密ラベルが異なる複数の行。クリアランス レベル間の推論を停止します。  
* **ビュー** – 許可された列/行のみを公開する仮想テーブル🧐 (最小権限)。  
* **同時実行制御** – ロックとジャーナリングにより、**更新の損失** と **ダーティ リード** の弱点を防ぎます。  
* **集約** – 低レベルのデータを組み合わせて機密情報を推測し、クエリ制限と必要性に基づいて軽減します。  
* **推論** – 許可されたクエリから保護されたデータを推論します。データ マスキング、パーティション分割、ノイズに対処します。  

#### データベース接続とミドルウェア  
* **Open Database Connectivity (ODBC)** – アプリが多くの DBMS エンジンと通信できるようにする標準 API。強力な認証と暗号化されたチャネル (TLS など) によってセキュリティが確保されます。  
* **JDBC / OLE DB / ADO.NET** 他のエコシステムにおける同様の概念。  

#### データベースの正規化 ⚙️  
| 正規形 | 目標 | 主要要件 |  
|-------------|------|-----------------|  
| 1NF | 重複する列の削除、アトミック値 | 一意の行/列 |  
| 2NF | PK への部分的な依存関係を削除 | PK 以外のすべての属性は PK 全体に依存 |  
| 3NF | 推移的な依存関係を削除 | 非 PK 属性は PK に **のみ** 依存 |  
*正規化により冗長性と更新の異常が削減され、整合性と効率性が向上します。*  

#### 機械学習とビッグデータウェアハウス  
* **データ ウェアハウス** – 分析用に複数のソースからクレンジングされたデータを集約する中央リポジトリ。  
* **データ レイク** – ML 処理用に、生の、多くの場合は非構造化データを保存します。  
* セキュリティの焦点:  
  * 保存時および転送中の暗号化。  
  * 分析ジョブ間のアクセスセグメンテーション。  
  * コンプライアンスのための監査ログ (GDPR、HIPAA など)。  

#### 脅威と対策の概要  
| 脅威 🚨 | 説明 | 制御 🛡️ |  
|-----------|-------------|--------------|  
| SQL インジェクション | サニタイズされていない入力によるクエリの操作 | パラメーター化されたステートメント、入力検証 |  
| 過剰な権限 | ユーザー/アプリに付与される広範な DB ロール | RBAC、最小権限、定期的なレビュー |  
| バックアップの露出 | 暗号化されていないダンプがオフサイトにコピーされる | バックアップを暗号化し、強力なキー管理を行う |  
| メタデータ漏洩 | オプションのスキーマ情報が攻撃者を助ける | システム テーブルを制限し、エラー メッセージを削除する |  
| DB に対する DoS | テーブルのロック、接続の枯渇 | 接続スロットリング、レプリケーション、HA |  

#### 試験のヒント ✏️  
* 多段階セキュリティのために、**ポリインスタンス化** と **ビュー** を覚えておいてください。  
* **ACID** はトランザクションの整合性の中核であり、直接的な質問が想定されます。  
* **SQL 認証の粒度** (テーブル ➜ 行 ➜ 列) を理解します。  
* **外部キーは参照整合性を強制します**; 主キーは一意性を保証します。  
* **集約/推論** は別個のものですが、関連性のある機密性リスクです。  

### データベーストランザクション  

#### トランザクションの基礎  
リレーショナル DBMS は、データの整合性を保護するために SQL ステートメントを **トランザクション** にグループ化します。  
*例* 📑  
    トランザクションを開始
    アカウントを更新します。SET balance = balance + 250 WHERE account_number = 1001;
    アカウントを更新します。SET balance = balance - 250 WHERE account_number = 2002;
    COMMIT; -- エラーがない場合は暗黙的に実行されます  
いずれかのステートメントが失敗した場合、**ROLLBACK** は DB を以前の状態に戻します。  

#### コミットとロールバック  
| コマンド | 目的 | 効果 |  
|---------|---------|--------|  
| `COMMIT` | 成功したトランザクションを終了して保存します | 変更は永続的になります |  
| `ROLLBACK` | トランザクションを中止/元に戻す | DB はトランザクション前の状態に戻る |  
| 暗黙的なコミット | 成功時に自動 | 明示的な `COMMIT` と同じ |  
| 暗黙的なロールバック | クラッシュ/エラー時に自動 | 明示的な `ROLLBACK` と同じ |  

#### ACID モデル 🚦  
| プロパティ | 定義 | CISSP セキュリティへの影響 |  
|----------|------------|-----------------------|  
| **原子性** | 「すべてかゼロか」 – 部分的な書き込みは禁止 | 部分的な更新を防ぎ、整合性を維持します |  
| **一貫性** | ルールに準拠した状態で開始および終了します | トランザクションから制約違反は発生しません |  
| **分離** | 同時トランザクションは中間トランザクションを認識しません | 競合状態/ダーティ リードを防止します |  
| **耐久性** | コミットされたデータは障害発生時にも存続します | ログ、ジャーナリング、RAID/バックアップにより存続が保証されます |  

##### 並行性の問題と制御  
| 問題 | 例 | 軽減策 |  
|-------|---------|------------|  
| **更新の損失** | 2 つのコミットが互いを上書きします | 行/列のロック |  
| **ダーティ リード** | トランザクションはコミットされていないデータを読み取ります | 分離レベル (例: SERIALIZABLE) |  
| **繰り返し不可能な読み取り** | 同じクエリがトランザクション内で異なる結果を返す | スナップショット分離、MVCC |  
| **ファントム リード** | 新しい行が出現/消失 | 範囲ロック、SERIALIZABLE 分離 |  

#### トランザクションのセキュリティメカニズム  
* **トランザクション ログ / 先行書き込みログ (WAL)** – 耐久性とフォレンジック監査の基盤。  
* **きめ細かなアクセス制御** – 機密テーブルで `BEGIN TRAN` を実行できるユーザーを制限します。  
* **入力検証** – 🚫 SQLインジェクションはトランザクションロジックを破壊する可能性があります。パラメータ化されたクエリを使用してください。  
* **バックアップとリカバリ戦略** – ホット バックアップ、ポイントインタイム リカバリによりコミットされたデータを保護します。  

#### 試験のヒント ✏️  
* **ACID** の順序と定義を思い出してください。  
* コミット前のシステム障害 ⇒ 自動 **ROLLBACK**。  
* 分離は、*ダーティ、再現不可能、ファントム* の読み取りをカバーします。それぞれの用語を理解してください。  
* トランザクション ログは、**耐久性** と **監査** の両方の役割を果たします。  

### マルチレベルデータベースのセキュリティ  

＃＃＃＃ 概要  
現代のDBMSは、多くの場合、**複数の分類レベル**（例：公開、機密、極秘）でレコードを保存します。マルチレベルセキュリティ（MLS）は、強制アクセス制御を適用することで、ユーザーがアクセス権限と**必要に応じた**データのみを参照できるようにします。主な懸念事項：  
* **データベースの汚染** – 同じテーブル/ビューに異なるレベルのデータが混在している  
* **不正開示** – 推論および集約攻撃  
* **整合性と可用性** – 同時実行制御  
  
#### データベースの汚染と信頼できるフロントエンド  
* **汚染** 🦠は、高レベルと低レベルのデータが共存し、制御が弱まる場合に発生します  
* **信頼できるフロントエンド** – 次のセキュリティ「ゲートウェイ」:  
  * クエリがレガシーまたは安全でない DBMS に到達する前にラベルを適用します  
  * 制限された行/列を削除したり、ポリインスタンス化を適用したりするために結果をサニタイズします  
  * 否認防止のためにアクセス試行をログ/監査します  

#### ビューによるアクセス制限  
ビュー = テーブルを装った保存されたSQLクエリ。メリット:  
* データの**最小権限スライス** 🍰（行/列/セルレベル）を提示する  
* 重複した情報を保存せずに複数のテーブルからデータを結合または集計します  
* 低レベルのユーザーから機密の列や分類された記録を非表示にする  
| 機能 | テーブル | ビュー |  
|---------|--------|-------|  
| 物理ストレージ | はい | いいえ (保存されたクエリ) |  
| 正規化に従う | 必須 | 違反可能 |  
| パフォーマンス | 高速 | オンザフライ計算が必要な場合があります |  
| セキュリティ使用 | 限定 | きめ細かなアクセス制御 |  

#### 同時実行制御 🔄  
**複数のユーザーが同時に編集** する場合の整合性を確保します。コアツール: *ロック*。  
* **更新の損失** – 並行した変更が互いに上書きされる  
* **ダーティリード** – トランザクションはコミットされていないデータを読み取る  
* ロック（行、ページ、テーブル）は重複を防止し、コミット/ロールバック時に解除されます。  
* 並行性 + 監査 ⇒ *予防的および検出的* 制御  

#### 集約 ⚖️  
攻撃者は複数の低レベルの事実を組み合わせて、より高レベルの情報（例：兵士の数のカウント）を明らかにします。対策：  
* RBAC 経由で `COUNT`、`SUM`、`AVG` などを制限する  
* **必要最低限の権限** を適用する  
* ノイズ/摂動 – 統計的ファジングを導入して出力をぼかす  

#### 推論 🕵️‍♂️  
一見無害なデータポイントを相関させることによる論理的推論。例：採用前後の給与合計 ⇒ 個々の給与。コントロール：  
* 過去のクエリ/日付範囲を制限する  
* **ぼかし**: 値を丸め、正確な数値ではなく範囲を返す  
* **データベースパーティショニング** – データをレベルごとに別々のDBに分割します  
* ポリインスタンス化（下記参照）  

#### その他のセキュリティメカニズム  
| メカニズム | 目的 | CISSP のキーポイント |  
|-----------|---------|---------------------|  
| **セマンティック整合性** | データ ルール/制約を適用 📏 | 無効または範囲外のエントリを停止 |  
| **タイムスタンプ順序** | 分散 DB での時系列レプリケーション | 一貫性を維持 |  
| **コンテンツ依存制御** | アクセス前にデータ ペイロードをチェック | オーバーヘッドが高く、粒度が細かい |  
| **コンテキスト依存制御** | 全体的な状況 (セッション、クエリの組み合わせ) を考慮 | 悪意のあるパターンを識別 |  
| **セルの抑制** | 個々のフィールド/セルを非表示にする | 漏洩を防ぐ |  
| **データベース パーティショニング** | 機密性によって DB を分離 | 推論/集計を軽減 |  
| **ノイズと摂動** | 偽のデータを挿入 ✨ | 攻撃者を欺き、オペレーションに害を与えないようにします |  
| **ポリインスタンス化** | PK は同じだが分類が異なる複数のレコード | MLS をサポートし、推論を阻止 |  

##### ポリインスタンス化の例  
| 船舶 ID | 位置 | セキュリティ ラベル |
|---------|---------------------------------|
| USSアルファ | 北緯35度 東経140度 | 一般公開 |
| USSアルファ | 北緯28度 東経135度 | 秘密 |
| USSアルファ | 北緯12度 東経110度 | 極秘 |

* **PUBLIC** ユーザーによるクエリ → *35°N 140°E* (無害なデコイ) を返します  
* **SECRET** ユーザーによるクエリ → *28°N 135°E* を返します  
* **TOP-SECRET** ユーザーによるクエリ → *12°N 110°E* (実際の位置) を返します

#### 試験のヒント ✏️  
* 汚染 = 混合レベルのデータ → 信頼できるフロントエンドまたは DB パーティションを使用します。  
* **ビュー = テーブルへの最小権限ウィンドウ**。  
* 同時実行の問題: *更新の損失* と *ダーティ リード* - ロックと ACID 分離によって解決されます。  
* 集計 ≠ 推論: 集計では DB 計算が使用され、推論では人間の推論が使用されます。  
* **ポリインスタンス化** の定義と MLS ロールを覚えておいてください。

### オープンデータベース接続
* **目的**: アプリケーションとさまざまなバックエンド DBMS 間のミドルウェア 🔄 として機能し、**DB ベンダーの独立性** を実現します。  
* **仕組み**  
  1. アプリケーションが汎用 SQL を発行します。  
  2. ODBC ドライバー マネージャーが要求を受信します。  
  3. 適切な DB 固有のドライバーが SQL を変換し、DB と通信します。  
* **CISSP のポイント**  
  * コーディングは簡素化されますが、追加のレイヤーが追加されます。ドライバーの**安全な構成とパッチ適用**が不可欠です。  
  * ODBC ドライバーを **最小権限** に制限し、使用されていないドライバーを無効にして攻撃対象領域を減らします。  
  * 異常検出のために ODBC ログを監視します。  

| ODBC セキュリティ上の懸念 | 軽減策 |  
|-----------------------|-------------|  
| 不正/未使用のドライバー | 削除/無効化 📛 |  
| ドライバー経由のインジェクション | 入力を強化し、パラメーター化されたクエリを使用する |  
| ドライバーのスプーフィング | ドライバーのバイナリに署名して検証し、速やかにパッチを適用 |  

### ノーSQL
現代のワークロード（ビッグデータ、柔軟なスキーマ、リアルタイム分析）は、多くの場合、**RDBMS の制限を超えます**。*NoSQL* =「Not Only SQL」—非表形式のデータ モデルを使用するデータベース。  

##### 一般的な NoSQL ファミリー  
| タイプ | データ モデル | 強み | 使用例 |  
|------|------------|-----------|-------------------|  
| **キーバリューストア** | `{key : value}` | 超高速検索、大規模 | セッションデータ、キャッシュ |  
| **ドキュメント ストア** | 半構造化ドキュメント (JSON、XML) | 柔軟なスキーマ、階層型データ | コンテンツ管理、IoT |  
| **グラフ DB** | ノードとエッジ | 複雑な関係、トラバーサル | ソーシャル ネットワーク 🌐、不正検出 |  
| **列ファミリ** | スパース列指向 | 高い書き込みスループット、分析 | ログ集計、時系列 |  

##### セキュリティへの影響  
* **アクセス制御モデルはさまざま** – RDBMS の成熟したロールベースの制御が不足している可能性があり、外部の IAM と統合します。  
* **保存中/転送中のデータ** – 暗号化オプションが有効になっていることを確認します。一部の NoSQL 製品では、TLS がデフォルトで無効になっています。  
* **レプリケーションとシャーディング** – ノード間チャネルを保護し、クラスター メンバーを認証して不正なノードの挿入を防止します。  
* **入力検証** は依然として重要です。多くの NoSQL エンジンはインジェクション攻撃の対象となります (例: MongoDB クエリ インジェクション)。  

##### CISSP 試験のヒント ✏️  
* ODBC = 相互運用性レイヤー - ドライバーにパッチを適用し、使用を制限します。  
* NoSQL は**安全性が低いことを意味するものではありません**が、セキュリティ制御は異なります。キーの種類と対応する制御を把握してください。  
* 重要なセキュリティ タスクを覚えておいてください: 認証 🔐 を有効にする、データを暗号化する、ユーザー ロールに最小権限を付与する、クラスターを保護する。

## ストレージの脅威  

＃＃＃ 概要  
* DBMS コントロールは、承認された「フロントドア」クエリを通じてのみデータを保護します。  
* **ストレージ レイヤー** (メモリ、ディスク、SSD、クラウド バケット) は、個別に保護されていない場合は脆弱なままになります。  
* CISSP に重点を置く ➡️ **不正アクセス** と **秘密のストレージ チャネル** のリスクを理解する。  

### ストレージリソースへの不正アクセス  
* **弱いファイルシステム権限** – 保護されていないディレクトリ/ファイルにより、攻撃者が閲覧し、機密データを抽出できるようになります。  
* **OS 制御のバイパス** – 攻撃者は別の OS を起動するか、ドライブを取り外して生のブロックを読み取ります。防御 = **フルディスク/ファイルシステムの暗号化**。  
* **マルチレベル セキュリティ (MLS) に関する懸念** – 共有メモリ/ディスク バッファーは **ラベルの優位性** を強制する必要があります。つまり、高レベルのデータが下位レベルに漏れてはなりません。  
* **クラウドストレージの設定ミス** ☁️  
  * パブリック読み取りバケット (例: 誤って設定された S3 ACL) は、データをインターネットに公開します。  
  * 対策:  
    1. デフォルトの **deny-all** ポリシー。  
    2. 継続的な構成監視とアラート。  
    3. サーバー側/クライアント側でオブジェクトを暗号化します。  

| リスク | 影響 | 軽減 |  
|------|--------|------------|  
| 弱い ACL | データ漏洩 | 最小権限、定期的な監査 📝 |  
| RAW ディスク アクセス | DB/OS のバイパス、盗難 | フルディスク暗号化、UEFI/セキュア ブート |  
| クロスドメイン読み取り | MLS 違反 | 強制アクセス制御 (MAC)、データラベル付け |  
| クラウド バケットの公開 | 公開リーク 🌐 | 厳格な IAM、バケット ポリシー、暗号化 |  

### 秘密のストレージチャネル 🕵️‍♂️  
* **定義**: 共有ストレージを操作して、セキュリティ レベル間で情報を間接的に転送します。  
* **簡単な例**: 上位プロセスは秘密を世界が読み取り可能な一時ファイルに書き込み、下位プロセスはファイルを読み取ります。  
* **高度なテクニック**:  
  * ビットをエンコードするためにファイル サイズ/タイムスタンプを変更します。  
  * 空きディスク領域またはメモリ割り当てパターンの変更。  
* **対策**  
  * 厳密な MAC - 上位レベルのオブジェクトに対する下位分類の読み取りを防止します。  
  * セキュリティ レベルごとにストレージを分割し、**信頼できるメディエーター** を使用します。  
  * 監査と隠れチャネル分析 (第 8 章を参照) を使用して帯域幅を推定し、ノイズ/ランダム化を適用します。  

### CISSP 試験のヒント ✏️  
* 注意: **保存中および転送中の** データの暗号化は、DBMS の権限を置き換えるのではなく、補足するものです。  
* クラウド ストレージの脅威は、ベンダーのハイパーバイザーのハッキングではなく、**構成ミス** に重点を置いています。  
* 隠れチャネル ➡️ 2つのタイプ：**ストレージ vs. タイミング**。ここではストレージについて説明します。ブロッキングには、*共有リソースの削除*または*厳密な仲介*が必要です。

## 知識ベースシステムの理解  
コンピュータの登場以来、エンジニアや科学者は、人間を退屈で時間のかかる作業から解放するシステムの開発に取り組んできました。単なる計算処理にとどまらず、人間のような推論能力を持つ**人工知能（AI）**の研究も進められています。  
このセクションでは、**エキスパート システム、機械学習、ニューラル ネットワーク** という 3 つの AI アプローチを調査し、それらのセキュリティ アプリケーションについて説明します。

### エキスパートシステム  

* **目標** – 専門知識を収集し、それを日常的な意思決定に一貫して適用します。  
* **コアコンポーネント**  
  1. **ナレッジベース** – 専門家の洞察を表す *if/then* ルールのコレクション。  
     *ハリケーン規則の例（説明のみ）:*  
       * ハリケーン ≥ カテゴリー 4 の場合 → 洪水の高さ ≈ 20 フィート。  
       * 風速が時速 120 マイルを超える場合 → 木造建築物が破壊されます。  
  2. **推論エンジン** – ユーザーが提供する事実を考慮して、知識ベース ルールに論理的/あいまい推論を適用し、結論を導き出します。  
* **強み** – 感情に左右されない、迅速かつ繰り返し可能な意思決定を提供します (例: 信用スコアリング、緊急対応)。  
* **制限** – ルールの品質と推論アルゴリズムによってのみ向上します。

### 機械学習  
* **定義** – アルゴリズムは明示的なルールではなく、データから直接モデルを導出します。  
* **カテゴリー**  
  * **教師あり学習** – ラベル付きデータ (入力 + 正しい出力) でトレーニングします。  
    *例*「悪意のある」タグと「通常の」タグが付けられた履歴データを使用して、悪意のあるログインのモデルを構築します。  
  * **教師なし学習** – ラベルなしデータの構造を見つけます (クラスタリング、関連付け)。  
    *例* 類似のログインをグループ化し、アナリストがクラスターの異常を検査します。  

### ニューラルネットワーク  
* **概念** – 重み付けされた計算ユニットのチェーンが生物学的ニューロンを模倣します。機械学習（*ディープラーニング*）のサブセットです。  
* **利点** – 直線性、適応性のある入出力マッピング、トレーニングによる「学習」能力。  
* **トレーニング** – **デルタルール** を使用して接続の重みを調整し、予測出力と既知の出力間の誤差を最小限に抑えます。  
* **アプリケーション** – 音声/顔認識、天気予報、認知モデリング。  

#### セキュリティアプリケーション  
* 膨大なログ/監査データセットにおける迅速かつ一貫した異常検出。  
* 反復的なセキュリティ タスク (アラート トリアージ、脅威の分類) における人的エラーの削減。  
* 適応型、自己学習型防御システムの潜在的な基盤。  
