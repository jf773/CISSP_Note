# 第16章 セキュリティ運用の管理

- [基礎的なセキュリティ運用概念を適用する](#基礎的なセキュリティ運用概念を適用する)
  - [必要最低限の権限](#必要最低限の権限)
  - [職務の分離（SoD）と責任](#職務の分離sodと責任)
  - [二人操作](#二人操作)
  - [ジョブローテーション](#ジョブローテーション)
  - [必須休暇](#必須休暇)
  - [特権アカウント管理](#特権アカウント管理)
  - [サービスレベル契約 (SLA)](#サービスレベル契約-sla)
- [従業員の安全とセキュリティについて](#従業員の安全とセキュリティについて)
  - [強迫](#強迫)
  - [旅行](#旅行)
  - [緊急管理](#緊急管理)
  - [セキュリティトレーニングと意識向上](#セキュリティトレーニングと意識向上)
- [情報と資産を安全にプロビジョニングする](#情報と資産を安全にプロビジョニングする)
  - [情報と資産の所有権](#情報と資産の所有権)
  - [資産管理](#資産管理)
- [リソース保護を適用する](#リソース保護を適用する)
  - [メディア管理](#メディア管理)
  - [メディア保護技術](#メディア保護技術)
- [クラウドでのマネージド サービス](#クラウドでのマネージド-サービス)
  - [クラウド サービス モデルによる責任の共有](#クラウド-サービス-モデルによる責任の共有)
  - [スケーラビリティと弾力性](#スケーラビリティと弾力性)
  - [サーバーレスアーキテクチャ](#サーバーレスアーキテクチャ)
- [構成管理 (CM) を実行する](#構成管理-cm-を実行する)
  - [プロビジョニング](#プロビジョニング)
  - [ベースライン設定](#ベースライン設定)
  - [ベースライン作成に画像を使用する](#ベースライン作成に画像を使用する)
  - [自動化](#自動化)
- [変更管理](#変更管理)
  - [変更管理](#変更管理)
  - [バージョン管理](#バージョン管理)
  - [設定ドキュメント](#設定ドキュメント)
- [パッチを管理して脆弱性を減らす](#パッチを管理して脆弱性を減らす)
  - [管理対象システム](#管理対象システム)
  - [パッチ管理](#パッチ管理)
  - [脆弱性管理](#脆弱性管理)
  - [脆弱性スキャン](#脆弱性スキャン)
  - [共通脆弱性識別子](#共通脆弱性識別子)
- [要約](#要約)

## 基本的なセキュリティ運用の概念を適用する  

> *これらの運用レベルの管理策は、「デュー・ケア」（合理的な安全策の設定）と「デュー・デリジェンス」（長期にわたる維持）を示しています。どの管理策が内部不正を最も効果的に**検出**、**抑止**、または**防止**できるかを問うシナリオ質問が想定されます。*

| コンセプト | CISSP の重要ポイント | なぜ重要なのか |
|---------|---------------------|----------------|
| **16.1.1 必要最小限の権限と最小権限** | *必要最小限の権限* = タスクに必要な情報 (許可のみ) へのアクセスを **のみ** 許可します (機密データで最もよく使用されます)。<br>*最小権限* = 職務を遂行するために必要な **最小限の** 権限/権利 (ファイル権限、システム コマンド) を付与します。<br>明確に定義された職務を想定し、役割が変更になった場合は見直します。 | ✔ 攻撃対象領域と内部者の好奇心を制限します。<br>✔ 機密性 **と** 整合性を保護します。<br>❓ 試験のコツ: クリアランス ≠ 自動アクセス - 必要最小限の権限は依然として適用されます。 |
|  • 必要最低限のアクセス | 例: DBA は DB サーバーにパッチを適用できますが、顧客の PII テーブルを読み取ることはできません。<br>Secret がクリアされたユーザーは、各 Secret プロジェクトにそれぞれ追加する必要があります。 | |
|  • 最小権限の原則 | **ユーザー、アプリ、サービス、プロセス** に適用されます。<br>「everyone」を *Administrators* に追加したり、サービスを *root* として実行したりしないでください。<br>権限の昇格 = 違反された場合の脅威。 | |
| **16.1.2 職務の分離 (SoD)** | 重要なタスクの **すべての** ステップを 1 人の人間が実行することはできません。<br>不正行為には共謀が必要 ⇒ 抑止力。| ✔ 抑制と均衡。<br>✔ 単一点障害を削減します。|
|  • 2 人制御 / 2 人ルール | 2 人が **一緒に行動** する必要があります (例: それぞれがパスワードの半分を保持する、銀行の金庫の鍵を 2 つ保持する)。 | |
|  • 知識の分割 | SoD と 2 人の制御を組み合わせます。各人は秘密の **一部** のみを知ります (例: 暗号キーのコンポーネント)。 | |
| **16.1.3 ジョブローテーション** | 役割/責任の定期的な交換。<br>利点: ピアレビュー、不正検出、クロストレーニング、労働力の回復力。 | |
| **16.1.4 必須休暇** | 1 週間または 2 週間の連続休暇。代理人が職務を遂行 → 異常を発見します。 | 銀行/金融部門で広く使用されています。 |
| **16.1.5 特権アカウント管理 (PAM)** | **管理者/ルート** レベルのアカウントの作成、使用、監視を制御します。<br>手法: ジャストインタイム (JIT) 昇格、時間制限付きの Kerberos チケット、パスワード ボールト、特権アクションに関する SIEM アラート (PowerShell イベント ID 4104 など)。| ✔ 不正使用を阻止し、APT を検出します。<br>✔ 最小権限をサポートします。|
|  • APT アクティビティの検出 | APT プレイブック: エスカレーション、ログの消去、管理者ユーザーの作成、RDP (3389) のオープン、タスクのスケジュール。<br>PAM + SIEM の相関関係により異常を早期に検出します。 | |
| **16.1.6 サービス レベル アグリーメント (SLA)** | ベンダーとの契約で、**測定可能な** パフォーマンス (稼働時間、RTO、RPO、応答時間) とペナルティを定義します。<br>多くの場合、**MOU** (意図、ペナルティなし) と組み合わせて使用されます。| ✔ クラウド/アウトソーシング サービスに対する期待を設定します。<br>✔ 可用性の目標をサポートします。 |

### 必要最低限の権限 vs. 最小権限
どちらの原則も**アクセスを制限**しますが、次の 2 つの異なる質問に答えます。

| 原則 | **制限事項** | **中心的な質問** | 一般的なコントロール/例 |
|-----------|-------------------|-------------------|----------------------------|
| **知る必要がある情報** | 対象者が表示できる *情報* (許可のみ) | 「**今すぐ仕事をするためにこの特定のデータが必要ですか?**」 | • 行レベルまたはフィールド レベルの DB マスキング<br>• 区分された軍事情報 (プログラムに「読み込む」)<br>• HR スタッフは自分が管理する従業員の人事ファイルのみを開くことができます |
| **最小権限** | *どの* **機能** (権限/許可) をサブジェクトが実行できるか | 「**実行を許可する必要がある最小限のアクション セットは何ですか?**」 | • 一般ユーザーにはローカル管理者権限がありません<br>• サービス アカウントにはログ ディレクトリに対する *読み取り* 権限のみが付与されています<br>• Cloud IAM ロールには `GetObject` 権限がありますが `PutObject` 権限はありません |

### クイックメモリ補助
- **必要な権限 → データ** アクセス、**最小権限 → 機能** アクセス。
- **SoD + 2人ルール + 分割知識** = 「誰も一人で不正行為をすることはできません。」
- **JIT 管理者** = 管理者権限は *ジャストインタイム* で表示され、 *同じ速さで* 消えます。
- **必須休暇** は、ユーザーが不在のときに「ゴースト アクティビティ」を公開します。
- **SLA = 「稼働時間保険」**; ペナルティはベンダーのコンプライアンスを促進します。

> **試験対策のヒント:** 管理者が単独でログを変更することを *防止* し、**ピアレビューを強制する制御を尋ねられたら、最小権限ではなく、**職務の分離** または **2 人による制御** を選択します。

---
## 従業員の安全とセキュリティへの対応  
*人はかけがえのない存在です。資産の保護よりも、管理によって人を守る必要があります。*

### 強迫  
- **定義**: 強制または脅迫を受けている人員のためのサイレントアラーム機構。  
- **例**:  
  - 緊急警報パネルのパニックボタン  
  - 暗号ロックの代替「強制」コード（ドアを開ける + 警報を鳴らす）  
- **プロセス**：  
  1. ユーザーが強制システム（秘密のボタンまたはコード）を起動します。  
  2. 監視センターにリアルタイムで通知されます。  
  3. センターは安全を確認するために合言葉（「すべてが素晴らしい」）を呼びかけます。  
  4. コードワードが省略されているか間違っている場合、アラーム応答がエスカレートされます。  
- **CISSP フォーカス**: パニックと強制、サイレントアラームと可聴アラームの違い、コードワード検証。

＃＃＃ 旅行  
- **脅威**:  
  - **デバイスの紛失/盗難** → 保存中および転送中のデータを常に暗号化します。  
  - **マルウェア/ハードウェア インプラント** → デバイスを放置しないでください。旅行専用の貸出デバイスを検討してください。  
  - **Evil-twin Wi-Fi / MITM** → オープンホットスポットを避け、個人の携帯電話ホットスポットまたは VPN を使用します。  
- **ベストプラクティス**:  
  - フルディスク暗号化と強力なエンドポイント保護を有効にします。  
  - 旅行前に不要なサービスを無効にしてください。  
  - プレーンテキストの資格情報を保存しないでください。OTP アプリまたはハードウェア トークンを使用してください。  
  - ドアを開ける前に訪問者（ホテルのスタッフなど）を確認します。  
- **CISSP のヒント**: 無料 Wi-Fi、VPN の必要性、モバイル デバイスの MDM のリスクを認識します。

### 緊急管理  
- **範囲**: 自然災害 (洪水、地震) および人為的事象 (火災、停電)。  
- **重要な要素**:  
  1. **避難計画** と安全な出口の設計 (例: 停電時にロックが解除されるフェイルセーフロック)。  
  2. **コミュニケーション プラン** (一括通知、コール ツリー、冗長チャネル)。  
  3. **重要な役割の継続性** (クロストレーニングを受けたバックアップ、代替の作業現場)。  
- **設計原則**: 資産の保護と生命の安全を常にバランスさせ、人を閉じ込めないようにします。  
- **試験の焦点**: BC 対 DR 対緊急対応、ドアロック解除のフェイルセーフ設計。

### セキュリティトレーニングと意識向上  
- **目的**: 安全/セキュリティ慣行におけるスタッフのスキルと警戒心を構築します。  
- **フォーマット**:  
  - **テーブルトップ演習** (ウォークスルーシナリオ)  
  - **キャプチャー・ザ・フラッグ（CTF）** ゲーム化された攻撃/防御  
  - **レッド/ブルー/ホワイトチーム** と **パープルチーム** (演習後の知識共有)  
- **コアトピック**:  
  - **強迫手順**と暗号語  
  - **旅行のセキュリティ** (デバイスの衛生、安全な通信)  
  - **緊急時の手順**と訓練  
  - **内部脅威**、**ソーシャルメディアの衛生**、**2FA疲労**  
- **CISSP のヒント**: 赤、青、白、紫のチームの役割と CTF スコアリングの基本を理解します。

---
## 情報と資産を安全にプロビジョニングする  
すべてのハードウェア、ソフトウェア、データが作成から廃棄まで管理され、保護されていることを確認します。

### 情報と資産の所有権  
- **データ所有者**  
  - 特定のデータ セットに対して最終的な責任を負う上級管理職 (CEO、部門長など)。  
  - 日常的なタスク (アクセス制御、バックアップなど) を **データ管理者** に委任します。  
- **ハードウェア所有者**  
  - 物理資産 (サーバー、ルーター) を担当する IT 部門または施設管理者。  
- **なぜ重要なのか**  
  - 説明責任を割り当てます。各資産には指名されたエグゼクティブ スポンサーがいます。  
  - 分類、保護レベル、廃棄に関する決定を誰が行うかを明確にします。

＃＃＃ 資産運用管理  
有形資産と無形資産の両方をライフサイクル全体にわたって追跡し、保護します。

#### 有形資産  
1. **ハードウェア インベントリ**  
   - **バーコード/RFIDタグ**  
     - 各デバイス (PC、サーバー、プリンター) に固有のバーコードまたは RFID のタグを付けます。  
     - 定期的にスキャンを実行して、ネットワーク上の存在を確認します。  
2. **ソフトウェアインベントリ**  
   - **ライセンスキー管理**  
     - アクティベーション数と購入済みライセンスを追跡します。  
     - 不正なインストールや期限切れのライセンスに関する警告。  
   - **不正ソフトウェアの検出**  
     - エンドポイント エージェントまたはネットワーク スキャンを使用して、承認されていないアプリケーションを見つけます。  
3. **メディアのサニタイズ**  
   - **廃棄前**: NIST 800-88r1 に従ってストレージ (HDD、SSD、USB) を消去または破壊します。  
   - **CD/DVD**: 物理的な細断または消磁。

#### 無形資産  
- **特許、商標、著作権、ブランドの評判**  
  - レジストリ（特許番号、有効期限など）を維持します。  
  - それぞれに上級管理職の「オーナー」を割り当てます。  
  - 必要に応じて財務諸表（GAAP）で報告します。

---
## リソース保護を適用する  
データを保持するメディアと資産をそのライフサイクル全体にわたって保護します。

### メディア管理  
- **メディア タイプ**: テープ、HDD/SSD、USB ドライブ、光学式、モバイル デバイス。  
- **在庫と追跡**  
  - リムーバブル メディアにタグを付けてスキャンします (バーコード/RFID)。  
  - 発行、保管の移転、返却を追跡します。  
- **ストレージコントロール**  
  - 機密メディアを保管するための安全な金庫または鍵付きのキャビネット。  
  - 環境制御（温度、湿度）。  
- **ライフサイクル コントロール**  
  - 平均故障時間 (MTTF) の前にメディアを廃棄します。  
  - メディアの古さとエラー率を集中的に追跡します。

### メディア保護技術  
- **論理制御**  
  - GPO またはエンドポイント管理を介して、許可されていない USB ポートを無効にします。  
  - 承認されたデバイスをホワイトリストに登録します (例: ハードウェア暗号化された IronKey)。  
- **物理的なコントロール**  
  - 安全な輸送（不正開封防止容器、保管チェーン）。  
  - 地理的に離れた安全な施設でのオフサイト バックアップ。  
- **暗号化**  
  - すべてのポータブル メディアとバックアップ メディアのフルディスク / ファイル レベルの暗号化。  
  - 顧客管理キー（ベンダー管理ではない）。

---
## クラウドでのマネージドサービス
| 要点 | わかりやすい英語での要約 |
|-----------|--------------------------|
| **クラウド = 「マネージド サービス」** | 組織は CSP からリソース (コンピューティング、ストレージ、アプリ) をレンタルするか、独自のオンプレミス クラウドをホストします。 |
| **制御と利便性のトレードオフ** | オフプレミスのクラウド → 直接的な制御が少ない = リスクが高い。オンプレミスのクラウド → 制御は増えるが利便性は低下する。 |
| **データ保護** | • **転送中**および**保存中**に暗号化します。<br> • *顧客* がキーを所有/保持する必要があります (DoD CC SRG)。<br> • 暗号消去 = 強力なデータ破壊制御。 |
| **DoD CC SRG (情報影響レベル 2 ～ 6)** | 米国政府による、Secret およびそれ以下のセキュリティ ベースラインを定義するガイド。暗号化と顧客管理キーを重視しています。 |

### クラウド サービス モデルによる責任の共有  

> **図 16-1** ➜ ベンダーと顧客の義務。

| モデル | CSP 所有 | 顧客所有 | CISSP の「落とし穴」 |
|-------|----------|---------------|-----------------|
| **SaaS** | **HW → アプリ コード** までのすべて | データの整合性、ユーザー構成、アクセス制御 | 例: Gmail。 |
| **PaaS** | HW、OS、**ランタイム** | デプロイされたアプリ + 一部のホスト構成 | 開発者はコードをビルド/保守します。 |
| **IaaS** | 物理インフラ (コンピューティング、ストレージ、ネットワーク) | **OS、パッチ、ミドルウェア、アプリ、データ** | VM をオンプレミス サーバーとして扱います。 |

#### クラウド *デプロイメント* モデル  
| モデル | 誰が使用できるか | 誰が通常メンテナンスを行うか | 注記 |
|-------|-------------|------------------------|-------|
| **パブリック** | 誰でも (マルチテナント) | CSP | SLA を使用して稼働時間/セキュリティを確保します。 |
| **プライベート** | 単一組織 | 組織自体または CSP | オンプレミスまたは専用オフプレミス |
| **コミュニティ** | 共通の使命を持つ 2 つ以上の組織 | 共有 / 共同 | 同様のポリシー / 規制 / コンプライアンス ドライバー。 |
| **ハイブリッド** | 2 つ以上のクラウドの混合 | 共有 | 安全なデータ/アプリの移植性テクノロジが必要です。 |

#### あらゆるものをサービスとして提供する (XaaS)  
- 「<span style="font-variant:small-caps;">____</span> をサービスとして提供する」という包括的な用語。  
- **Security as a Service (SECaaS)**、別名 **MSP / MSSP**: オフプレミス バックアップ、IAM、SIEM、IDS/IPS など。  
  - **利点:** 24時間365日の専門知識と柔軟性。  
  - **リスク:** ベンダー ロックイン、サードパーティの信頼、データ主権。

### スケーラビリティと弾力性  
| 用語 | 意味 | 試験のヒント |
|------|---------------|------------|
| **スケーラビリティ** | システムは**拡張可能** (CPU/RAM/帯域幅の追加)。多くの場合手動で行う必要があり、再起動が必要になる場合があります。| 「垂直（アップ）/水平（アウト）スケーリング」|
| **弾力性** | **自動拡張/縮小** オンデマンドでダウンタイムなしで実行できます。 | 実際の使用量に基づいて支払います。クラウドの主要な価値提案です。 |

#### サービス / クラウド統合 (iPaaS、SDDC)  
- 目標: オンプレミス + クラウド アプリを統合 → **データ サイロなし**。  
- 可視性とプロセス フローを改善します。多くの場合、*サービスとしての統合プラットフォーム* (iPaaS) を介して実装されます。  
- アーキテクトの仕事: 安全な API、データ分類、一貫した IAM を確保する。

### サーバーレスアーキテクチャ
| 側面 | サーバーレス / FaaS | PaaS との比較 |
|--------|------------------|--------------------|
| **開発者向け** | *関数* のみを記述してアップロードします | アプリ スタック全体を構築および管理します。 |
| **課金** | 呼び出しごとに支払います (実行され、その後停止します) | VM/コンテナは継続的に実行されます。 |
| **スケーリング** | 関数ごとに自動 | 実行時環境全体をスケーリングする必要があります。 |
| **セキュリティ義務** | コード ロジックとデータ。CSP はランタイムとインフラを保護します | 共有ホスト OS 構成は引き続き顧客のものです。 |
| **例** | AWS Lambda、Azure Functions、Google Cloud Functions | Google App Engine、AWS Elastic Beanstalk |

### クイックメモリ補助  

- **SaaS = 完成したソフトウェア**  
- **PaaS = プログラマー向けプラットフォーム**  
- **IaaS = 管理するインフラストラクチャ**  
- **弾力性 = ゴムバンドの自動伸縮**  
- **サーバーレス = 「関数のみ」 – 実行時に支払い**

### 試験チェックリスト  

- [ ] クラウド データを暗号化します。**顧客がキーを保持します**。  
- [ ] マップの職務: **SaaS (データ)、PaaS (アプリ)、IaaS (OS)**。  
- [ ] 4 つの **展開モデル** とその制御分割を理解する。  
- [ ] **SECaaS / MSSP** の利点とリスクを認識する。  
- [ ] **スケーラビリティ** (手動) と **弾力性** (自動) を区別します。  
- [ ] **サーバーレス/FaaS** のコストとセキュリティへの影響を思い出してください。

## 構成管理（CM）を実行する

### プロビジョニング
- **定義:** 新しいシステムに OS とアプリをインストールして構成します。
- **デフォルトを使用しないでください!** デフォルトのインストールでは多くの脆弱性が生じます。
- **強化手順:**
  1. **使用していないサービスを無効にする**  
     例：ファイルサーバー→使用していない場合はFTPをオフにする  
  2. **未使用の論理ポートを閉じる**  
     通常はサービスを無効にすることで行われます  
  3. **使用していないアプリケーションを削除する**  
     不要なバンドルアプリをアンインストールする  
  4. **デフォルトのパスワードを変更する**  
     攻撃者はベンダーのデフォルトを知っている  

### ベースライン設定
- **定義:** 「開始構成」 - システム ロールの安全な設定のリスト。
- **役割固有:**  
  - ファイルサーバーのベースライン≠デスクトップのベースライン  
- **柔軟性:** 管理者は、さまざまなバリエーション (ブランチ オフィスのファイル サーバーなど) に合わせてベースラインを調整します。

### ベースラインに画像を使用する
1. **構築と強化**  
   - 「ゴールド」マシンにOSとアプリをインストールする  
   - すべての安全な設定を適用し、徹底的にテストする  
2. **画像をキャプチャ**  
   - イメージングソフトウェアを使用して「ゴールド」マシンのスナップショットを作成する  
   - イメージサーバー（またはUSB/DVD）に保存  
3. **イメージを展開する**  
   - スナップショットを新しいシステムにプッシュする  
   - それぞれを確定します（ホスト名、IP、グループメンバーシップ）  

> **利点:**  
> - **一貫性:** 常に同一の安全な構成  
> - **スピード:** 数時間かかる展開を数分で完了  
> - **リカバリ:** 破損したマシンを迅速に再構築します  
>
> **警告:** 画像ファイルを保護してください。マルウェアに汚染された画像は感染を拡大します。

### 自動化
- **画像とスクリプトを組み合わせる:**  
  - 1つのベースイメージ + インストール後のタスクの自動化  
  - 例: PowerShell または Ansible 経由で部門固有のアプリをインストールする  
- **グループ ポリシー (Windows):**  
  - すべてのドメインマシンのレジストリとセキュリティ設定を一元管理  
  - OU ごとまたはロールごと（ファイル サーバー、デスクトップ、会計 PC）に適用  
- **レジストリの強化:**  
  - 攻撃者を阻止するために PowerShell をブロックまたは制限する (第 14 章を参照)  
  - フォレンジックの可視性を高めるために詳細なログ記録を有効にする  
  - グループポリシーを介して展開し、すべてのエンドポイントに適用します  

> **試験のヒント:**  
> - **プロビジョニング**、**ベースライン設定**、**イメージング**、および**自動化** の違いを理解します。  
> - プロビジョニングの下にある 4 つの強化手順を覚えておいてください。  
> - 3 ステップの画像ワークフローを視覚化します。  
> - GPO (または同等のもの) が大規模なレジストリ強化をどのように推進するかを説明できる。

---
## 変更を管理する

- **定義:** 正式なプロセスにより、システムは最初に導入されたときと同じように安全かつ安定した状態が維持されます。  
- **主な目標:** すべての変更を確認、承認、テスト、文書化することで、計画外の停止を防止します。  
- **CIA の影響:** 許可されていない変更は **可用性** に悪影響を及ぼしますが、CM がそれを保護します。  
- **現実世界の「落とし穴」:**  
  - ファイアウォール管理者が「謎の」ポートを閉じる → Web サーバーが DB にアクセスできなくなる → サイトが停止し、責任のなすり合いが始まる。  
- **トレードオフ:** ユーザビリティやパフォーマンスのためにセキュリティを弱める場合もありますが、リスクとメリットの分析を行った上で行う必要があります。

### 変更管理

1. **変更をリクエストする**  
   - ユーザー/IT がチケットまたは Web フォームを送信し、CM システムにログインします。  

2. **変更を確認する**  
   - 部門横断的な専門家 (ネットワーク、サーバー、セキュリティ、アプリ チーム) が影響と副作用を分析します。  
   - リスクの高い変更 → 変更諮問委員会 (CAB)。  

3. **承認または拒否**  
   - 決定が記録されました。  
   - 承認された場合: **ロールバック/バックアウト プラン** を作成します。  

4. **変更をテストする**  
   - 非本番環境/ラボ環境で、意図しない障害を検出します。  

5. **スケジュールと実装**  
   - 影響の少ない時間帯（オフピーク時）を選択します。  
   - ロールバック プランを準備して実行します。  

6. **変更を文書化する**  
   - CM レコードを更新します: 変更内容、変更理由、承認者、テスト結果、ロールバック手順。  
   - 監査、再構築、および他の場所での同じ変更のスケーリングに重要です。

> **緊急の変更** も、監査証跡を維持するために後で **文書化** する必要があります。

### バージョン管理

- **概要:** 各ソフトウェア/構成の反復に番号またはラベルを付ける (例: v1.0 → v1.1 → v2.0)。  
- **なぜ重要なのか:**  
  - 「どのバージョンがどこで実行されるか」を追跡します。  
  - 安全なロールバックと一貫したデプロイメントを可能にします。  
- **要点:**  
  - コード リポジトリ (Git、SVN) にとって不可欠です。  
  - 生産中に何かが壊れたときに、「私のボックスでは動作した」という状況を防ぎます。

### 設定ドキュメント

- **概要:** すべてのシステムの安全な構成、所有権、目的、および変更履歴の最新の記録。  
- **必ず含めてください:**  
  - **ベースライン設定** + すべての偏差/パッチ  
  - 責任者と日付  
  - 承認とテスト結果  
- **保管場所:**  
  - CMDB、セキュリティ保護された wiki、またはバージョン管理されたドキュメント (単一ポイントの紙のログは避けてください)。  
- **試験のヒント:** 適切に管理されたドキュメントは、災害復旧とフォレンジック監査を可能にし、あらゆる再構築の「レシピ」となります。

---

## パッチを管理し、脆弱性を減らす

セキュリティ = **パッチ管理** + **脆弱性管理**  
これらは連携して動作します。パッチは既知のバグを修正し、脆弱性スキャンはパッチが適用されていることを確認し、残っている問題を検出します。

### 管理するシステム

> **OS を搭載したすべてのデバイス** (サーバーとワークステーションだけではありません)。

- **ネットワーク機器:** ルーター、スイッチ、ファイアウォール、UTMアプライアンス  
- **IoT / 組み込み:** IPカメラ、プリンター、医療機器、スマート家電  
- **モバイル:** MDM経由のスマートフォンとタブレット  

**試験のヒント:** 有名な 2016 年の Mirai DDoS 攻撃では、パッチが適用されていない IoT デバイスが使用されました。すべての OS が重要です。

### パッチ管理

**パッチ = コード更新** バグや脆弱性を修正します (ホットフィックス/更新とも呼ばれます)。

**ライフサイクル：**
1. **評価:** このパッチは OS/アプリに適用されますか?  
2. **テスト:** 非本番システムで副作用をキャッチします (例: 再起動ループ)。  
3. **承認:** 変更管理に従い、ロールバック計画を文書化します。  
4. **展開:** ベンダー ツール (WSUS、SCCM、サードパーティ) を使用して自動化します。  
5. **検証:** スキャン/監査を行って、展開が成功したことを確認します。

**重要:** テストを省略しないでください。不適切なパッチによって本番環境が中断される可能性があります。

#### パッチ火曜日とエクスプロイト水曜日

- **Patch Tuesday:** Microsoft (およびその他) は、毎月第 2 火曜日にセキュリティ更新プログラムをリリースします。  
- **Exploit Wednesday:** 攻撃者はこれらのパッチをリバース エンジニアリングし、約 24 時間以内にエクスプロイトを武器化します。  

> **あまり長く待たないでください:** 多くの侵害は、「水曜日」だけでなく、数か月前に修正された脆弱性を悪用します。

### 脆弱性管理

> **目標:** 弱点を見つけ、優先順位を付けて軽減します。すべてを修正できるわけではないことを認識します。

- **検出:** 脆弱性スキャンを定期的に実行します。  
- **検証:** 実際の問題を確認します (誤検知を回避します)。  
- **修正または受け入れ:** パッチ/構成の変更を適用するか、残留リスクを正式に受け入れます。

**職務の分離:** チェックとバランスのためにパッチの展開とスキャン検証を分離します。

### 脆弱性スキャン

自動化ツールは、**既知の**欠陥（パッチの不足、構成の誤り、資格情報の弱さなど）を調査します。

- **認証されていないスキャン:** 外部の攻撃者をシミュレートします (資格情報なし)。  
- **認証スキャン:** 読み取り専用の資格情報を提供する → 可視性が高まり、誤検知が減少します。

> **警告:** 必ず書面による許可を得てください。無許可のスキャンは CFAA に違反する可能性があります。

### 共通脆弱性と露出

- **CVE:** 既知の脆弱性ごとの標準 ID (例: `CVE-2020-0601`)。  
- **保守管理:** MITRE (DHS/CISA の資金提供)。  
- **なぜ使うのですか?**  
  - ベンダーとツールはパッチとスキャンを CVE ID にマッピングします。  
  - レポートとパッチの優先順位付けを効率化します。  
