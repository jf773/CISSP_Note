# 第9章 セキュリティの脆弱性、脅威、対策

- [共有責任](#shared-responsibility)
- [データローカリゼーションとデータ主権](#data-localization-and-data-sovereignty)
- [セキュリティ アーキテクチャ、設計、ソリューション要素の脆弱性を評価および軽減する](#assess-and-mitigate-the-vulnerabilities-of-security-architectures-designs-and-solution-elements)
  - [ハードウェア](#hardware)
  - [ファームウェア](#firmware)
- [クライアントベースのシステム](#client-based-systems)
  - [モバイルコード](#mobile-code)
  - [ローカルキャッシュ](#local-caches)
- [サーバーベースシステム](#server-based-systems)
  - [大規模並列データシステム](#large-scale-parallel-data-systems)
  - [グリッドコンピューティング](#grid-computing)
  - [ピアツーピア](#peer-to-peer)
- [産業用制御システム](#industrial-control-systems)
- [分散システム](#distributed-systems)
- [高性能コンピューティング (HPC) システム](#high-performance-computing-hpc-systems)
- [リアルタイムオペレーティングシステム](#real-time-operating-systems)
- [モノのインターネット](#モノのインターネット)
- [エッジコンピューティングとフォグコンピューティング](#edge-and-fog-computing)
- [組み込みデバイスとサイバーフィジカルシステム](#embedded-devices--cyber-physical-systems)
  - [静的システム](#static-systems)
  - [サイバーフィジカルシステム](#cyber-physical-systems)
  - [組み込みシステムと静的システムのセキュリティ上の懸念](#security-concerns-of-embedded-and-static-systems)
- [マイクロサービス](#microservices)
- [インフラストラクチャ・アズ・コード](#infrastructure-as-code)
- [不変アーキテクチャ](#immutable-architecture)
- [仮想化システム](#virtualized-systems)
  - [仮想ソフトウェア](#virtual-software)
  - [仮想化ネットワーク](#virtualized-networking)
  - [すべてをソフトウェア定義](#software-defined-everything)
  - [仮想化セキュリティ管理](#virtualization-security-management)
- [コンテナ化](#containerization)
- [モバイルデバイス](#mobile-devices)
  - [モバイルデバイスのセキュリティ機能](#mobile-device-security-features)
  - [モバイルデバイス展開ポリシー](#mobile-device-deployment-policies)
- [必須セキュリティ保護メカニズム](#essential-security-protection-mechanisms)
  - [プロセス分離](#process-isolation)
  - [ハードウェアセグメンテーション](#hardware-segmentation)
  - [信頼のルート](#信頼のルート)
  - [システムセキュリティポリシー](#system-security-policy)
- [共通セキュリティアーキテクチャの欠陥と問題](#common-security-architecture-flaws-and-issues)
  - [秘密チャネル](#covert-channels)
  - [設計またはコーディングの欠陥に基づく攻撃](#attacks-based-on-design-or-coding-flaws)
  - [ルートキット](#rootkits)
  - [増分攻撃](#incremental-attacks)
- [要約](#summary)

「人魚」
マインドマップ
  root(("第9章: セキュリティの脆弱性、脅威、対策"))
    共有責任
    データのローカリゼーションとデータ主権
    セキュリティアーキテクチャ、設計、ソリューション要素の脆弱性を評価し、軽減する
      ハードウェア
      ファームウェア
    クライアントベースのシステム
      モバイルコード
      ローカルキャッシュ
    サーバーベースのシステム
      大規模並列データシステム
      グリッドコンピューティング
      ピアツーピア
    産業用制御システム
    分散システム
    高性能コンピューティング HPC システム
    リアルタイムオペレーティングシステム
    モノのインターネット
    エッジコンピューティングとフォグコンピューティング
    組み込みデバイスとサイバーフィジカルシステム
      静的システム
      サイバーフィジカルシステム
      組み込みシステムと静的システムのセキュリティ上の懸念
    マイクロサービス
    インフラストラクチャ・アズ・コード
    不変のアーキテクチャ
    仮想化システム
      仮想ソフトウェア
      仮想化ネットワーク
      すべてをソフトウェア定義
      仮想化セキュリティ管理
    コンテナ化
    モバイルデバイス
      モバイルデバイスのセキュリティ機能
      モバイルデバイス展開ポリシー
    必須のセキュリティ保護メカニズム
      プロセス分離
      ハードウェアセグメンテーション
      信頼のルート
      システムセキュリティポリシー
    一般的なセキュリティアーキテクチャの欠陥と問題
      秘密チャネル
      設計やコーディングの欠陥に基づく攻撃
      ルートキット
      増分攻撃
    まとめ
「」

## システムの種類とセキュリティ上の懸念

| **システム タイプ** | **説明** | **セキュリティ上の懸念事項 (CISSP ガイドより)** |
|------------------|-----------------|------------------------------------------|
| **クライアントベースのシステム** | アプリはクライアント OS/ハードウェア上でローカルに実行されます。 | マルウェア、モバイル コード、パッチ管理、ローカル キャッシュのリスク、物理アクセス。 |
| **サーバーベースのシステム** | 複数のクライアントのリソースを集中管理します。 | 権限昇格、DoS、集中ターゲット、グリッド/P2P の脆弱性。 |
| **産業用制御システム (ICS)** | SCADA/PLC などのリアルタイム OT システム。 | レガシー プロトコル、パッチ機能の低さ、リアルタイムの安全性要件。 |
| **分散システム** | 複数の独立したシステムがタスクを調整します。 | データの一貫性、認証、信頼関係、遅延の問題。 |
| **高性能コンピューティング (HPC)** | スーパーコンピューティングまたはクラスター化されたタスク。 | 共有リソースの漏洩、ジョブ分離の失敗、スケジュール攻撃。 |
| **モノのインターネット (IoT)** | センサーを備えた低電力の自律デバイス。 | デフォルトの資格情報、弱い暗号化、リモート アクセス、ベンダーの信頼性の問題。 |
| **エッジ コンピューティング** | 処理はデータ ソースの近く (デバイス上) で行われます。 | リソースの制限、ファームウェアの問題、集中管理の欠如、リアルタイムの攻撃ベクトル。 |
| **フォグ コンピューティング** | エッジとクラウド間のミドルウェア。 | トランジット データの露出、集中化された信頼リスク、ローカル処理の整合性。 |
| **組み込みシステム** | 専用機能デバイス (IoT センサーなど)。 | ハードコードされた認証情報、パッチ適用の難しさ、物理的な改ざん、弱い暗号。 |
| **サイバーフィジカルシステム** | 組み込み + 物理世界との相互作用 (例: スマートグリッド)。 | 安全性統合リスク、限定的な更新、リアルタイムの侵害影響。 |
| **マイクロサービス** | それぞれ個別の API を持つモジュール型サービス。 | サービス間の信頼、API の脆弱性、コンテナのセキュリティ管理。 |
| **Infrastructure as Code (IaC)** | インフラは Terraform/Ansible などのスクリプトによって管理されます。 | 誤った構成のリスク、ドリフト、ソース コードの改ざん、意図しない権限の変更。 |
| **仮想化システム** | ハイパーバイザーを介して 1 つのホスト上で複数の OS を実行します。 | VM のエスケープ、スプロール、スナップショットの改ざん、パッチ/バックアップの監視。 |
| **コンテナ化** | アプリレベルの仮想化 (Docker/K8s)。 | コンテナのブレイクアウト、イメージの改ざん、カーネルの露出、コンテナ間の漏洩。 |
| **サーバーレス アーキテクチャ** | コードはイベント トリガーで実行され、CSP がインフラを管理します。 | 可視性の制限、安全でないロジック、DoS、CSP の信頼、監査の困難。 |
| **モバイル デバイス** | バッテリー駆動のポータブル デバイス。 | 紛失/盗難、安全でないネットワーク、マルウェア、BYOD ポリシー違反、データ漏洩。 |

---
## 責任の共有

1. **みんなの役割** 👥  
  - CISOとセキュリティチームがコントロールを構築し維持する  
  - 従業員は日常業務においてセキュリティポリシーに従っています  
  - 監査人が違反を監視する

2. **ステークホルダーの説明責任** 📊  
  - 組織は投資家、顧客、パートナーの利益を保護する必要があります  
  - セキュリティに関する決定は評判と法令遵守を守る

3. **クラウド共有責任モデル☁️**  
  - 自分とクラウドプロバイダーが担当するセキュリティタスクを理解する  
  - 詳細は第16章を参照

4. **責任ある脆弱性開示🛠️**  
  - 新しい欠陥を発見したら、ベンダーまたは脅威情報ハブに報告してください  
  - 責任を持って詳細情報を共有することでユーザーを保護します

**自動インジケーター共有（AIS）🤖**  
  - DHSによるIOC（侵害指標）の「マシンスピード」共有の取り組み  
  - **観測可能** = 事実（例：悪意のあるファイルのハッシュ）  
  - **指標** = 観察可能なもの + 脅威仮説

**脅威交換の標準とプロトコル🚀**  
  - **STIX** = 構造化脅威情報表現（共通脅威言語）  
  - **TAXII** = 信頼できる自動情報交換（輸送）

**NCCICマネジメント🏢**  
  - 国立サイバーセキュリティ・通信統合センターが運営するAIS  
  - 詳細情報: https://us-cert.gov/ais

---

## データのローカリゼーションとデータ主権
- **データのローカリゼーション** 📍  
  - **定義**: 国境内でのデータの保存/処理  
  - **なぜ重要なのか**:  
    - プライバシーとセキュリティに関する現地の法律の遵守を確保  
    - 国境を越えたデータの流れを制限する可能性がある  
    - データセンターを構築する場所や地域のクラウド サービスを使用する場所に関する意思決定を推進します  
- **データ主権** ⚖️  
  - **定義**: データは、それが所在する国の法律の対象となります  
  - **影響**:  
    - 政府は管轄区域内で収集されたデータを管理します  
    - データ保護に関する現地の規制を遵守する必要がある  
    - データガバナンス、法令遵守、ベンダー契約に影響します  
- **2つを比較する**  
  | 側面 | データのローカリゼーション | データ主権 |
  |-------------|------------------------------------------|-----------------------------------------------|
  | 焦点 | 物理的な保管場所 | データに対する法的権限と制御 |
  | 範囲 | データが「どこに」存在するか | 誰が権利を持ち、データがどのように管理されるか |
  | ドライバー | データの場所に関する特定の規制 | より広範な法的/政治的/文化的考慮事項 |
  | 影響 | インフラストラクチャ コスト、レイテンシー、設計 | データ ガバナンス、サードパーティ契約 |

---
## セキュリティアーキテクチャ設計とソリューション要素の脆弱性を評価し、軽減する

> **概要:** コンピュータ アーキテクチャとは、論理レベルでシステムを設計し、階層化、抽象化、データの隠蔽、信頼できる回復、プロセスの分離、ハードウェアのセグメンテーションなどの制御を組み込むことです。  
> **なぜ重要なのか:** 複雑さが増す → 攻撃対象領域が拡大する → 信頼性が低下する。シンプルに！🛠️

### ハードウェア

- **定義:** 触れることができるコンピューターの実体部分 (CPU、メモリ チップ、ディスク、キーボード、モニター)。  
- **注:** ディスク/フラッシュ上のデータはハードウェアではなく、ソフトウェア/データ (ビット) です。

#### プロセッサ (CPU) ⚙️
- **役割:** すべての計算を実行または調整する「中枢」。  
- **命令セット:** 低レベルの操作が制限されており、速度を重視して設計されています。  
- **OS とコンパイラ:** 高水準コードを CPU 命令に変換します。

##### 実行タイプ 🚀

> ユーザーは「2つのことを同時にやりたい」 → さまざまなテクニック:

| 用語 | 意味 | 絵文字 |
|---------------------|---------------------------------------------------------------------------------|--------|
| **マルチタスク** | OS がシミュレート_ → 単一コアで複数のプロセスを処理、タイムスライス 🤹‍♂️ | 🤹‍♂️ |
| **マルチコア** | 複数の独立したコアを持つ CPU チップ → 真の並列処理 🧩 | 🧩 |
| **マルチプロセッシング** | 複数の CPU チップ/コアがスレッドを並列に実行します (固定 = アフィニティの場合もあります) 🤝 | 🤝 |
| **マルチプログラミング**| OS は 1 つの CPU で多数のジョブをバッチ処理します → それぞれが I/O を待機し、次に ⏳ | ⏳ | を実行します。
| **マルチスレッド** | 1 つのプロセス内の複数のスレッドがリソースを共有し、コンテキスト スイッチのオーバーヘッドが低くなります ⚡ | ⚡ |

##### 保護メカニズム 🔒

> 実行時には、OSとアプリが**ランタイム環境**を形成します。以下の制御を実施する必要があります。
> - OSの整合性✔️  
> - どのユーザーがどのデータにアクセスするか 👤  
> - 操作の承認/拒否 ✅  

##### プロテクションリング 🎯

- **概念:** 権限別に同心円状に並べられたコード/コンポーネント (内側 = 最高)。  
- **クラシックモデル:** リング0～3  
  - **リング 0:** カーネル（常にメモリ内）– フルアクセス 👑  
  - **リング 1:** OS サービスとドライバー ⚙️  
  - **リング2:** I/Oドライバーとユーティリティ 📂  
  - **リング3:** ユーザーアプリ 📱  
- **強制:** 下位リングのコードは上位リングのコードをプリエンプトします。上位リングは_システムコール_（仲介アクセス）を介して下位リングのコードを呼び出す必要があります。

##### リングとレベルの比較 🆚

- **類似性:**  
  - リング 0 ↔ 最上位層（最高権限）  
  - リング 3 ↔ 最下層 (最小権限)  
- **使用法:** 一部の OS では、リング 0 ～ 2 を「カーネル モード」に、リング 3 を「ユーザー モード」に集約します。

##### プロセスの状態 📋
> OSにおけるプロセスのライフサイクル:

1. **新規 → 準備完了**  
   - キューに入れられ、CPU を待機中 📝  
2. **準備完了 → 実行中**  
   - 完了、タイムスライスの終了、またはブロックされるまで実行されます ▶️  
3. **実行中→待機中**  
   - I/O のために一時停止し、I/O が完了すると準備完了状態に戻ります ⏸️  
4. **実行中 → 停止**  
   - 終了または強制終了（エラー/リソース障害）❌  
5. **スーパーバイザ（カーネルモード）**  
   - コードがユーザーモードよりも高い権限を必要とする場合（例：設定の変更）🔧  

🎓 重要なポイント:
- 脆弱性を減らすためにシンプルにしましょう 🔍
- 各実行タイプの並列処理モデルを理解する🤔
- 保護リングは権限の分離を強制します 🛡️
- プロセス状態はタスクの実行と待機方法を定義します⏳

＃＃＃＃ メモリ
##### 読み取り専用メモリ (ROM) 💾
- **定義:** 製造時に焼き付けられた不揮発性ストレージ。システムは **読み取り可能** ですが、 **書き込み不可** です。  
- **用途:**  
  - **ブートストラップコード** (例: POST診断) 🔧  
  - 変更してはならない**ファームウェア**✔️  
- **バリエーション:**  
  - **PROM:** ユーザーはデータを一度「書き込み」、その後は読み取り専用になります 🔥  
  - **EPROM (UVEPROM):** UV ライトで消去 → 再プログラム ☀️  
  - **EEPROM:** 電気的に消去/書き込み ⚡  
  - **フラッシュ:** ブロックレベルの消去/書き込み（例：SSD、サムドライブ）🔋  

##### ランダム アクセス メモリ (RAM) 🔄
- **定義:** 揮発性の読み取り/書き込みメモリ。電源を切るとデータが失われます ⚡❌  
- **重要なデータは RAM のみに保存しないでください。** 他の場所にバックアップしてください。💾

###### 実（メイン）メモリ 🏦
- **ダイナミック RAM (DRAM):** 安価; コンデンサベース → CPU は定期的にリフレッシュする必要がある 🔄  
- **スタティック RAM (SRAM):** フリップフロップベース。高速、リフレッシュなし、高価 💨  

###### キャッシュ RAM 🗄️
- **目的:** 繰り返しアクセスを高速化 → 小型で高速なメモリ層  
- **レベル:**  
  - **L1/L2:** オンコア、CPU コアごと 🧩  
  - **L3:** コア間で共有 🔗  
  - **L4:** オンボードマザーボード/GPU（レア）🎮  
- **周辺キャッシュ:** HDD、SSD キャッシュは電源を切る前に **フラッシュ** する必要があります 🔥  

##### ダイナミック RAM とスタティック RAM ⚔️
| 機能 | DRAM | SRAM |
| -------------- | ----------------------------- | ----------------------------- |
| テクノロジー | コンデンサ (リフレッシュが必要) | フリップフロップ (リフレッシュ不要) |
| 速度 | 低速 (リフレッシュのオーバーヘッド) | 高速 (リフレッシュなし) |
| コスト | 安い | 高い |
| ユースケース | メインメモリ | CPU レジスタ、キャッシュ |

##### レジスタ 📋
- **定義:** 小さなCPU上のストレージ（32/64ビットのレジスタ8～32個）  
- **用途:** ALU のオペランド/命令を保持 → 最高速度 🚀  

##### メモリアドレス指定 🗺️
| スキーム | 仕組み |
| ----------------- | -------------------------------------------------------------------------------------------------------------------- |
| **レジスタ** | CPU はレジスタ (例: “R1”) 内のデータに直接アクセスします |
| **即値** | 命令自体にオペランドが指定されています（例：「ADD 2」） |
| **直接** | 命令がアドレスを指定 → CPU がそこからデータを読み取ります |
| **間接** | 命令はアドレスを提供します → そのアドレスは別のアドレスを保持します → CPU は最終データを読み取ります |
| **Base+Offset** | CPU は命令からベース ポインター (レジスタ内) へのオフセットを追加 → データにアクセス |

> **ポインタと競合状態:**  
> - **ポインタ:** メモリアドレスを保持する変数 → 実際のデータを読み書きするには、_逆参照_ する必要があります 📍  
> - **競合状態:** 2 つのプロセスが同時にポインタにアクセス/変更 → null/破損したポインタを参照解除する可能性があり → クラッシュ 🏃‍♂️💥  

##### セカンダリメモリと仮想メモリ 💽
- **二次メモリ:** HDD、SSD、光学式、フラッシュ → **OS ページ** 必要に応じてデータをメインメモリに読み込みます 📂  
- **仮想メモリ:**  
  - ディスク上の**ページファイル/スワップファイル**はRAMアドレス空間を拡張します  
  - **ページング:** あまり使用されないページをディスクにスワップ → アクセス時に復元 ↔️  
  - **欠点:** I/O が遅い → 使いすぎると「スラッシング」が発生する 🐢💤  
  - **緩和策:** 物理 RAM の増設、ページファイル用の SSD/NVMe 🚀  

> 🎯 **重要なポイント:**  
> - **ROM バリアント** は不変性と柔軟性をトレードオフします 🔒⚡  
> - **RAM タイプ** コストと速度のバランス (DRAM vs. SRAM) 💰💨  
> - **レジスタ**と**キャッシュ**はCPUパフォーマンスにとって重要です🏎️  
> - **アドレッシングモード** により、CPU はメモリ内のデータを特定できます 🗺️  
> - **仮想メモリ** は OOM を回避しますが、乱用すると速度が低下する可能性があります 🐢  

#### データストレージデバイス 💾

##### プライマリ vs セカンダリ 🖥️ vs 📦
- **プライマリストレージ**  
  - アクティブなタスクのためにCPUが使用するRAM  
  - 高速で不安定な「ワーキングメモリ」  
- **セカンダリストレージ**  
  - 長期保存メディア: HDD、SSD、テープ、CD/DVD、フラッシュカード  
  - 不揮発性、電源を切っても持続

##### 揮発性 vs 不揮発性 🔌❌ vs 💾✅
- **揮発性** (RAM)  
  - 電源を切るとすべてのデータが失われます  
  - 例: DRAM、SRAM  
- **不揮発性** (ROM、磁気、光学、フラッシュ)  
  - 電源がなくてもデータを保持  
  - 例: HDD、SSD、USBスティック、ROM/EPROM

##### ランダム vs シーケンシャル 🎯 vs 🔄
- **ランダムアクセス**  
  - 任意のアドレスへの直接読み取り/書き込み  
  - 例: RAMチップ、ほとんどのHDD/SSD  
- **シーケンシャルアクセス**  
  - 先行データを読む必要があります  
  - 例: 磁気テープドライブ

##### メモリセキュリティの問題 🔒🧠
- **揮発性メモリのデータ漏洩**  
  - コールドブート攻撃: RAMをフリーズしてデータの劣化を遅らせる  
  - 攻撃者はメモリイメージ/クラッシュログをダンプしてキーを抽出します  
- **データ残留**  
  - RAMセルは電源オフ後も一時的に電荷を保持することがある  
  - すぐに削除しないと機密データが取得される可能性がある  
- **消毒が必要**  
  - 廃棄または再プロビジョニングする前にすべてのメモリを消去します  
  - 特殊なユーティリティまたは物理的な破壊

##### ストレージメディアのセキュリティ 🛡️📀
- **二次メディア上のデータ残存**  
  - 削除/再フォーマットされたファイルは回復できることが多い  
  - サニタイズ（上書き）を使用するか、メディアを破壊する  
- **SSD に関する特別な考慮事項**  
  - **予約ブロック** は、消耗したセル（不良セクタなど）を置き換えます。  
  - **ウェアレベリング** により書き込みを分散し、寿命を延ばします  
  - 従来のワイプでは隠れたブロックや不良ブロックを見逃す可能性がある  
- **盗難と機密性**  
  - 物理メディアの盗難 → データ漏洩リスク  
  - HDD/SSD/USBドライブの**フルディスク暗号化**  
  - 多くのデバイスがネイティブハードウェア暗号化をサポート  
- **リムーバブルメディアのリスク**  
  - 紛失や盗難に遭いやすい  
  - 輸送または保管の前に必ず暗号化してください

#### 放射セキュリティ  
多くの電子機器は意図せず電磁波や無線信号を放出します（放射）。  
敵対者によって傍受され、解読され、機密データが盗まれる可能性があります。🔍

- **日常的なリスク**  
  - Wi-Fi/Bluetooth/GPS以外：モニター、ケーブル、ドライブからデータが漏洩  
- **目標**  
  - サイドチャネルリークを理解してブロックする  

#### テンペスト/EMSEC 🛡️  
元々は、電子機器から電磁信号が漏れるのを防ぐための政府規格のセットです。  
現在はEMSEC（Emission Security）と呼ばれています。

- **目的**  
  - 機密情報を漏らすようなスプリアス放射を最小限に抑える  
- **範囲**  
  - 暗号機器、ネットワーク機器、AIS、通信機器  

#### ヴァン・エック放射線 ⚡  
Van Eck フリーキングとも呼ばれ、デバイスの電磁波漏洩を遠くから盗聴する行為。

- **攻撃**  
  - 画面イメージ、キーストローク、データをキャプチャして再構築する  
- **防御**
  - TEMPEST/EMSEC対策  

#### ファラデーケージ 🏰  
電磁信号の入出力を遮断する金属製の筐体（箱、部屋、建物）。

- **仕組み**  
  - 金属皮膜は電磁波吸収コンデンサとして機能する  
- **ユースケース**  
  - SCIF、安全な会議室  

#### ホワイトノイズ 🔊  
盗聴者のために実際の放射をかき消すマスキング信号を放送します。

- **種類**  
  - ランダムRFノイズ  
  - 一定または可変の妨害  
- **キーポイント**  
  - 許可されたユーザーを妨害しない  

#### コントロールゾーン 🚧  
ファラデーケージとホワイトノイズを組み合わせて特定のエリアを保護します。

- **範囲**  
  - 部屋、階、または建物全体  
- **利点**  
  - 局所的な電磁波封じ込め  

#### シールドとアンテナ管理 🛡️📶  
TEMPEST/EMSECを超える追加の電磁防御:

- **ケーブルシールド**  
  - STPケーブル、シールドコンジット、光ファイバーの交換  
- **アンテナ制御**  
  - 外部アンテナ、アンテナの配置を制限する  

#### 入力および出力デバイス ⌨️🖥️

##### モニター  
- **リスク**  
  - ビデオケーブルやモニターの電子機器に対するヴァン・エックの攻撃  
  - 肩越しの覗き見と隠しカメラ 🚶‍♂️📸  

##### プリンター  
- **リスク**  
  - 放置されたプリントアウト  
  - プリンタのローカルHDDに機密ジョブが無期限に保存される  
- **緩和策**  
  - プルプリント、自動削除、安全なリリースステーション  

##### キーボードとマウス  
- **リスク**  
  - 電磁波の漏洩や仕掛けられたバグがキー入力を傍受する  
  - 無線スニッフィングによる無線傍受  
- **緩和策**  
  - シールドケーブル、暗号化された無線プロトコルを使用する  

#### POTS 電話モデム ☎️  
固定電話の旧式のダイヤルアップ モデムは、監視されていないネットワーク バックドアを作成します。

- **リスク**  
  - ファイアウォールをバイパスし、不正な出口パスを作成する  
- **コントロール**  
  - ポリシーでモデムを無効化または禁止する  
  - 必要なモデムを追跡、保護、監視する  

### ファームウェア
- **それは何ですか**  
  ROM/EEPROM/フラッシュチップに保存されたソフトウェア（マイクロコード）  
- **要点**  
  - めったに更新されない（実際のROMでは決して更新されない）  
  - 基本的なデバイス機能（プリンター、モデム、IoT）を駆動します  

#### デバイスに組み込まれたミニ OS 📦
- 多くの周辺機器はファームウェアから小さなOSを実行します  
- **例**: 携帯電話、IoT機器、エッジ/フォグノード、産業用コントローラ  
- **利点**: メイン OS の複雑さを軽減します  

#### BIOS 💻
- マザーボードのEEPROM/フラッシュ上のレガシー低レベルファームウェア  
- **役割**  
  - ハードウェア初期化（CPU、RAM、ドライブ、ビデオ）  
  - メインOSのブートストラップローダー  
- **制限**  
  - キーボードのみのセットアップ  
  - 2.2 TB未満のブートドライブ  
  - 起動が遅い  

#### UEFI 🚀
- BIOSの最新の代替品  
- **改善**  
  - GUI + マウスサポート  
  - 高速起動、大容量ドライブのサポート  
  - OS 起動前の CPU に依存しないドライバーとネットワーク  
- **安全**  
  - セキュアブート  
  - メジャーブーツ  
  - 前方/後方互換性  

#### ファームウェアのフラッシュ 🔄
- **定義**: BIOS/UEFI/ファームウェアチップの内容を書き換える  
- **リスク**: マルウェアはルートキットやバックドアを挿入する可能性があります  
- **点滅**  
  - 悪意のあるファームウェア「アップデート」のインストール  
  - OSレベル以下に留まる  

#### セキュアブート（ブート構成証明）🛡️
- デジタル署名されたOS/ドライバーのみがロードされることを保証する  
- 事前に承認された証明書を使用して署名を検証します  
- ブートレベルのマルウェア（ルートキット、隠れたローダー）から**防御**します  
- **制限**: 高度な攻撃は一部のハードウェアでこれを回避できる可能性があります  

#### メジャーブート 📊
- すべてのブートコンポーネントをハッシュし、TPMに記録します  
- **目的**: ブート後の整合性検証  
- **動作**: ブートアクションの「ビデオ」を記録しますが、ブロックしません  
- **ユースケース**: 事後に侵害されたコンポーネントを監査する  

## クライアントベースのシステム  

- **定義**: サーバーだけでなく、エンドユーザーのデバイスやプロセスを標的とした攻撃  
- **例**:  
  - 有害なアプレットやスクリプトを配信する悪質なウェブサイト  
  - HTTPだけでなく、あらゆるプロトコルがクライアント側の脅威を運ぶ可能性がある  
- **リスク**:  
  - システムの侵害、データの盗難、破損 🔓  
  - ローカルキャッシュポイズニング（例：DNS、ARP、ブラウザキャッシュ）  

### モバイルコード
- **概要**: サーバーからクライアントに送信される自己完結型のコードスニペット（アプレット、スクリプト）  
- **利点**：  
  - 処理をユーザーのデバイスにオフロードします⚙️  
  - インタラクティブな応答が高速化 🚀  
  - 機密性の高い入力をローカルに保存します（正しくコーディングされている場合）🔒  
- **種類と歴史**:  
  - Javaアプレット（今では珍しい）☕  
  - ActiveX コントロール (レガシー、IE のみ)  
  - JavaScript（広く普及、HTML に埋め込まれる）💻  
- **セキュリティ上の懸念**:  
  - 信頼できないコードを実行する → トロイの木馬、バックドア、ランサムウェア ⚠️  
  - アプレット/スクリプトはデータを密かに抜き出すことができる  
  - JS サンドボックス/同一オリジンポリシーバイパス (XSS、CSRF)  
- **防御**:  
  - ブラウザとJSエンジンを最新の状態に保つ🔄  
  - コンテンツセキュリティポリシー（CSP）を適用する 🛡️  
  - すべてのユーザー入力を検証およびサニタイズする（インジェクションを防ぐ）  
  - Webアプリケーションファイアウォール（WAF）/ NGFWを使用する  
  - ブラウザのアドオン/拡張機能を制限または監査する  

### ローカルキャッシュ
- **種類**: DNSキャッシュ、ARPキャッシュ、ブラウザの一時インターネットファイル  
- **脅威**:  
  - スプリットレスポンス攻撃はキャッシュエントリを汚染する 🐟  
  - DOMベースのXSSは悪意のあるファイルを挿入する可能性があります  
  - キャッシュされたマルウェアは有効なページの読み込み時に実行される  
- **軽減策**:  
  - キャッシュの保持期間を短縮する⏱️  
  - キャッシュサイズを最小化する 📉  
  - コンテンツのプリロードを無効にする  
  - ブラウザ終了時にCookieとキャッシュを自動消去  
  - 自動キャッシュクリーニングツールをスケジュールする  

## サーバーベースのシステム  
- **データフロー制御** 🔄  
  - プロセス/デバイス/ネットワーク間のデータの移動を管理します  
  - 低レイテンシ、信頼性の高いスループットを保証します（ハッシュ🛡️、暗号化🔐）  
  - トラフィックを抑制またはバッファリングすることで過負荷とDoSを防ぎます  
- **ロードバランサー** ⚖️  
  - 複数のサーバーまたはリンクにネットワーク負荷を分散します  
  - 目標:  
    - ✔️ リソースの使用を最適化  
    - ⏱️ 応答時間を最小限に抑える  
    - 📶 スループットを最大化する  
    - 🚫 過負荷/ボトルネックを回避する  
  - 方法: ランダム選択、ラウンドロビン、監視された利用率、重み付けされた好み  
- **DoS攻撃** 🚫📶  
  - サーバーをフラッドさせてデータフローを妨害する  
  - 緩和策: トラフィックシェーピング、レート制限、スクラビングセンター、異常検出  

### 大規模並列データシステム
- **並列処理**  
  - 大きなタスクをサブタスクに分割し、同時に実行します  
  - マルチコアCPU、クラスター、仮想ノードを使用  
  - 懸念事項: パフォーマンス、パワー、信頼性 ⚡🔋✅  

#### 対称型マルチプロセッシング（SMP）🤝
- 1つのOSで複数の同一CPU  
- 共有メモリとバス  
- 多数のプロセッサが同時に単一のタスクを処理するのに最適  

#### 非対称マルチプロセッシング（AMP）🏷️
- CPUには個別のOSまたはタスクセットがある  
- それぞれ専用のメモリとバスを備えています  
- 「アフィニティ」はタスクを特定のCPUに固定することができます  

#### 大規模並列処理 (MPP) 🚀
- 1つのシステムとして機能する多数のAMPノードのネットワーク  
- 数百から数千（数百万！）のコア  
- マスターノードがジョブを分割 → ワーカーが処理 → 結果が再構成  
- 非常に大規模で計算集約的な問題に適しています  

### グリッドコンピューティング
- **定義**: 緩く接続されたボランティアノードはアイドルCPUサイクルを共有します  
- **ユースケース**: SETI@home、タンパク質折り畳み、気候モデル、金融シミュレーション  
- **リスク**:  
  - 🔓 作業パケット内のデータはすべての参加者に公開されます  
  - ⏳ 予測不可能な可用性：結果の遅延/欠落/破損  
  - ⚠️ 中央コーディネータの侵害 → グリッド全体のリスク  

＃＃＃ ピアツーピア
- **定義**: 平等な立場でのリソース/サービスの分散的な共有  
- **例**: BitTorrent、VoIPアプリ、ストリーミングサービス  
- **セキュリティ上の懸念**:  
  - 📂 著作権侵害と著作権の問題  
  - 👂 共有コンテンツの盗聴  
  - 🔄中央管理なし → マルウェアの配布、帯域幅の浪費  

**📝 CISSP のヒント**  
> - 各並列モデルのアーキテクチャとユースケースを理解する  
> - 負荷分散技術とDoS防御について理解する  
> - グリッドとP2Pはデータを公開するため、機密性の高いワークロードには使用しないでください。  


## 産業用制御システム

- **ICSとは何ですか?**  
  産業プロセス (製造、電力、水、石油など) を自動化および制御する運用技術 (OT) デバイスの一種。  

- **ICSの種類:**  
  - **PLC (プログラマブル ロジック コントローラー)** 💻➡️🤖  
    - 1 つのデバイス (組立ライン、スタジアムの照明など) を制御する専用デジタル コンピュータ  
  - **DCS（分散制御システム）** 🌐🏢  
    - 分散コントローラと中央HMIを介して大規模なプロセスプラントを制御  
    - アナログ（フロー制御）またはデジタル（電圧）が可能  
  - **SCADA（監視制御およびデータ収集）** 📡🕹️  
    - 多くの場合、ITにネットワーク化された広域プロセスを監視および制御します  
    - イベント駆動型、オペレータ向けHMI  
    - レガシー = ボタン/ノブ、モダン = 豊富な GUI とリモート ソフトウェア  

- **PLC vs DCS vs SCADA:**  
  - PLC: 単一変圧器  
  - DCS: 単一発電所（状態駆動型、限定規模）  
  - SCADA: 電力網全体（イベント駆動型、広範囲の地理的範囲）  

- **主要プロトコル – Modbus** 🔌📶  
  - 1979年以来のPLC↔SCADA通信の事実上のオープンスタンダード  
  - ベンダー間の相互運用性  

- **セキュリティ体制:**  
  - 歴史的にセキュリティが最低限 → 高い脆弱性 (例: Stuxnet) 🔓🐛  
  - 強化制御:  
    - ネットワークの分離とセグメンテーション  
    - 物理的および論理的なアクセス制限 🔒  
    - デフォルトの認証情報を変更し、コードを制限する  
    - 包括的なログ記録/監査 📋  
  - 主な OT 目標: リアルタイム制御信号の **可用性** ⏱️✅  

- **標準とガイダンス:**  
  - ISA99 / IEC 62443 シリーズ 📜  
  - NIST SP 800-82 🏛️  
  - 重要インフラ保護のためのNERC、ERNCIP🌐  

## 分散システム

- **定義:** 複数のコンピュータが1つの論理システムとして連携して動作する  
- **利点:** 回復力、信頼性、パフォーマンス、スケーラビリティ 🚀  
- **アーキテクチャ:**  
  - クライアントサーバー、3層、多層、ピアツーピア  
  - 主な用途: DNS、SSO、SDN、マイクロサービス、MMORPG 🎮  

- **インターフェース定義言語 (IDL):**  
  - 言語間および場所間の呼び出しを標準化します (RPC、CORBA、DCOM) 🔄  

- **セキュリティリスク:**  
  - 攻撃面の拡大 → 横方向の移動とピボット  
  - 不正アクセス、なりすまし、DoS、盗聴 🔓🕵️‍♂️  

- **緩和策:**  
  - 保存中、転送中、処理中のデータを暗号化します🔐  
  - 強力なMFAとパッチの一貫性を強制する  
  - 均質なコンポーネントセットと明確なデータ主権ポリシー 🌍  

## 高性能コンピューティング (HPC) システム

- **目的:** リアルタイム/準リアルタイムでの大規模データセットの超高速処理  
- **コンポーネント:**  
  - コンピューティングノード、高速ネットワーク、大規模ストレージ 🔗  
- **ボトルネックリスク:**  
  - 遅いコンポーネントは遅延や無害な DoS (リソース枯渇) を引き起こします⚠️  

## リアルタイムオペレーティングシステム

- **定義:** タスク実行の遅延を最小限に抑えるように設計されたOS  
- **モード:**  
  - ハードリアルタイム: 遅延は許容されない (例: 自動車の安全性)  
  - ソフトリアルタイム: 小さな遅延は許容可能 (例: オーディオ/ビデオ同期)  
- **スケジュール:**  
  - イベント駆動型（優先度ベース）  
  - タイムスライス（クロック割り込み）  
- **セキュリティ上の課題:**  
  - 単一目的 → 組み込みセキュリティが制限されている  
  - 独自のコード → 隠れたバグ 🐛  
- **強化:**  
  - ネットワーク/デバイスの分離  
  - 厳格なコミュニケーション監視 👀  

## モノのインターネット
- **IoTとは何ですか?**  
  自動化、リモート コントロール、AI/ML 処理などの機能を提供するスタンドアロンの「スマート」デバイス (サーモスタット、カメラ、アシスタント、フィットネス トラッカーなど) のネットワーク。大規模なマシンに組み込まれている組み込みシステムとは異なります。  

- **スマートデバイスと組み込みシステム**  
  - **IoT デバイス:** 独立したハードウェア、クラウドまたは LAN に接続 (例: スマート サーモスタット)  
  - **組み込みシステム:** デバイスのシャーシに統合されたコントローラ（例：車のECU）  

- **一般的な IoT の例** 🎛️  
  - スマートフォン、タブレット、ホームアシスタント  
  - VR/ARヘッドセット、スポーツカメラ、音楽プレーヤー  
  - フィットネスバンド、スマート家電  

- **産業用 IoT (IIoT)** 🏭☁️  
  - クラウドベースのデータ収集、分析、自動化によるICS/DCSの進化  
  - 工場、エネルギーグリッド、サプライチェーンにおけるエッジコンピューティングとフォグコンピューティングを実現  

- **主なリスクと脅威** ⚠️  
  - **弱いデフォルト:** デフォルトの認証情報と設定はほとんど変更されない  
  - **暗号化の欠如:** データは平文で送信されることが多い  
  - **ネットワークピボット:** 侵害された IoT → 他の LAN デバイスを攻撃  
  - **ベンダーの信頼:** メンテナンスが不十分なファームウェアとパッチのないデバイス  

- **セキュリティコントロール** 🔒  
  - **ネットワークセグメンテーション:** IoT VLANの「3ルータ」分離（ギブソンの3ルータ設計）  
  - **アクセス制限:** IoTエンドポイントの物理ACLと論理ACL  
  - **強力な認証:** デフォルトのパスワードを変更し、可能な場合はMFAを使用します  
  - **パッチ適用とアップデート:** ファームウェア/ソフトウェアを最新の状態に保つ  
  - **監視とログ記録:** すべてのIoTアクティビティを追跡し、異常を警告します  
  - **ファイアウォールとフィルタリング:** 受信/送信IoTトラフィックを制限する  

- **ウェアラブル** ⌚👟  
  - スマートウォッチ、健康トラッカー - 身に着けるIoT  
  - **プライバシーに関する懸念:** どのようなデータが収集されますか？どこに保存されますか？暗号化されていますか？削除できますか？  

- **ビジネスユースケース** 🏢  
  - 環境制御（HVAC、照明）  
  - アクセス制御と資産追跡  
  - 在庫センサーと自動再発注  
  - **IoT 向け NIST サイバーセキュリティ:** ガイダンスは nist.gov/itl/applied-cybersecurity/nist-cybersecurity-iot-program をご覧ください  

- **センサー** 🌡️  
  - 温度、湿度、動き、流れ、光、粒子を測定  
  - 自動化のために ICS/DCS/SCADA にデータを送信します (例: 温度が上昇すると AC がオンになります)  

## エッジコンピューティングとフォグコンピューティング
- **エッジ コンピューティングとは何ですか?**  
  データソース（デバイス）**またはその近く**でデータを処理することで、レイテンシと帯域幅の使用を最小限に抑えます。各デバイスは自ら「考え」ます。  

- **フォグ コンピューティングとは何ですか?**  
  分散したセンサーやIoTデバイスから収集されたデータを**LAN上**で集中処理します。「フォグ」ハブがクラウドに送られる前にデータを集約・分析します。  

- **コンピューティングの進化** 💻  
  1. メインフレームとシンクライアント  
  2. エンドポイント上のクライアント/サーバー  
  3. 仮想化 → クラウドコンピューティング  
  4. **エッジコンピューティング** ← ユーザー/デバイスに可能な限り近い  
  5. **フォグコンピューティング** ← LANレベルの中央ハブ  

- **ユースケース** 🚗🎥  
  - **エッジ:** 自律走行車、ローカル CDN キャッシュ、スマートカメラ、VR/AR レンダリング  
  - **Fog:** IIoTハブ、産業分析、ビル管理システム  

- **セキュリティに関する考慮事項** 🔐  
  - エッジデバイスにはセキュリティが組み込まれていないことが多い → 強力な認証と暗号化を強制する  
  - フォグノードが高価値ターゲットになる → OSを強化し、トラフィックを監視する  
  - エッジ/フォグネットワークを分離し、ゼロトラストセグメンテーションを適用する  
  - すべてのエッジ/フォグコンポーネントの定期的な更新とパッチの適用を確実にする  

## 組み込みデバイスとサイバーフィジカルシステム
**組み込みデバイス 🖥️⚙️**
- **定義:** 自動化、リモート制御、または監視機能を追加するために、大規模な機械/電気システムに組み込まれたコンピューティング モジュール。  
- **一般的なコンポーネント:** CPU、RAM、I/O ポート、不揮発性ストレージ (フラッシュ/ROM)。  
- **使用例:** 産業機械、スマート家電、医療機器。  

**マイクロコントローラ 🧩📟**
- **概要:** チップ上の小型コンピューター (CPU + RAM + I/O + ストレージ)。  
- **例:** Raspberry Pi、Arduino、FPGA ボード。  
- **SoC との違い:** 複雑さが少なく、多くの場合単一目的です。SoC は多くのコア/周辺機器を統合します。  

### 静的システム
- **定義:** 「非永続的」な環境は、再起動時に既知の状態にリセットされます。  
- **例:** 空港のキオスク、ATM、ホテルの宿泊客用 PC。  
- **実装：**  
  - ローカルVMスナップショット  
  - セッションロールバック機能付きVDI  
- **目標:** 不正な構成変更とマルウェアの永続化をブロックします。  

### サイバーフィジカルシステム
- **定義:** 物理世界に**作用**したり、**感知**したりするコンピューティング駆動型デバイス。  
- **ロボット対センサー:**  
  - **ロボット:** 動きを引き起こします (例: 外科用ロボット)。  
  - **センサー:** 状態 (温度、動き、流れ) を測定します。  
- **使用例:** 義肢、衝突回避、SCADA、スマートグリッド。  

### 組み込みシステムと静的システムのセキュリティ上の懸念
1. **限られたリソース:**  
   - 低消費電力CPUとバッテリー → 強力なセキュリティを実行できない  
2. **パッチチャレンジ:**  
   - アップデートが少ない/全くない → 既知の脆弱性が残る  
3. **弱いデフォルト:**  
   - ハードコードされた認証情報、事前共有キー → 簡単に侵入可能  
4. **ネットワーク制限:**  
   - 単一プロトコル（Zigbee、BLE、Wi-Fi v1）→ACLの適用が困難  
5. **コスト主導設計:**  
   - 価格を抑えるためにセキュリティが省略されることが多い  
6. **身体的危害のリスク:**  
   - 侵害は現実世界に損害を与える可能性がある  

**緩和策:**  
- **ネットワークセグメンテーション:** 独自のVLANまたはエアギャップで分離  
- **ファイアウォールとフィルタリング:** 内部セグメンテーションファイアウォール (ISFW)  
- **厳格なアップデートポリシー:** 手動でテストされたファームウェアパッチのみ  
- **監視とログ記録:** デバイスがログを記録できない場合は外部コレクター  

## マイクロサービス
### マイクロサービスアーキテクチャ
#### ✅ コンセプト
- **マイクロサービス** = 小さく、疎結合され、独立して展開可能なサービスの集合。
- 各サービスは**単一のビジネス機能**を表し、**独自のデータベース**を持ち、**明確に定義された API** を介して通信します。
- **サービス指向アーキテクチャ (SOA)** から進化しましたが、より細分性と自律性が向上しました。

#### 📚 主な機能
- モジュール化 🧱
- 独立した展開 🔄
- 高速でアジャイルな開発サイクル ⚡
- スケーラブルで保守性の高いコードベース 🛠️

#### 🔐 セキュリティに関する考慮事項
- **認証と承認**: 各サービスに対する安全なアクセス制御 (例: OAuth、JWT) 🛡️
- **データ暗号化**: 転送には TLS、保存には AES を使用します🔐
- **API セキュリティ**: 入力検証、レート制限、ゲートウェイの強制 📲
- **監視とログ記録**: 動作を追跡し、異常を検出し、イベントをログに記録します📈
- **コンテナのセキュリティ**: コンテナを強化し、安全なベースイメージを使用し、定期的にスキャンする 🐳

#### 📌 CISSP 試験のヒント
- マイクロサービスは分散型の性質により**攻撃対象領域**を拡大します。
- **API ゲートウェイ** は制御を集中化し、セキュリティとトラフィック シェーピングを強化します。
- **ゼロ トラスト** の原則を使用して、サービスを分離して保護します。

## インフラストラクチャ・アズ・コード
### ✅ コンセプト
- **ハードウェア構成** と **インフラストラクチャ** を **バージョン管理されたソフトウェア** として扱います。
- **DevSecOps** の原則に準拠しています。
- 機械可読な設定ファイル（YAML、JSON など）で定義されます 📝

### 🧠 メリット
- 繰り返し可能、スケーラブル、監査可能なデプロイメント 🔁
- 導入前テストとロールバックのサポート✅
- 分散環境全体で簡単に自動化できます🤖

### 🔐 セキュリティに関する考慮事項
- 定義を**安全なバージョン管理**（例：Git）に保存する🗂️
- デプロイメントには**レビューと承認のパイプライン**を使用する 🔍
- テンプレートを強化し、IaC ファイルの脆弱性をスキャンします 🚫

## 不変アーキテクチャ

### ✅ コンセプト
- 展開後はサーバーまたはサービスは**変更されません**。
- 変更 = 古いものを破棄 + 新しいものを展開 (「フェニックス サーバー」🔥🕊️)
- 手動パッチ適用や設定のずれはありません 🎯

### 🧠 メリット
- 予測可能で一貫性のあるデプロイメント 📦
- 人的エラーと途中で発生するバグを削減します🧹
- **継続的デリバリーおよび IaC** モデルに準拠

### 🐄 ペットと牛のアナロジー
- **ペット**: 手動で管理される、ユニークな、世話の行き届いたサーバー。
- **Cattle**: 自動化によって管理される使い捨て、交換可能なシステム。

### 🌐 ソフトウェア定義ネットワーク (SDN)

#### ✅ コンセプト
- ネットワーク機能 (ルーティング、スイッチング、ACL) は **仮想化** され、ソフトウェアを介して集中管理されます 🎛️
- **コントロール プレーン** と **データ プレーン** の分離 🧠➡️🚚
- IaC および DCE と統合された **仮想化インフラストラクチャ** の一部。

#### 📌 ユースケース
- クラウド自動化☁️
- トラフィックセグメンテーションとQoS 🎯
- 安全で隔離された環境の迅速な展開 🔐

#### 🔐 セキュリティに関する考慮事項
- 中央コントローラは **保護** される必要があります (アクセス、整合性、可用性)。
- SDN は、ネットワーク全体で **セキュリティ ポリシーを動的に適用** できます。
- 可視性と制御により、ネットワークの動作を**きめ細かく監視**できます👀

### 試験の観点

| コンセプト | CISSP フォーカス |
|--------------------------|--------------|
| マイクロサービス | モジュール型セキュリティの適用、API セキュリティ、コンテナ セキュリティ |
| Infrastructure as Code | 構成の整合性、自動化、DevSecOps の調整 |
| 不変アーキテクチャ | 一貫性、ロールバックの安全性、人的エラーの削減 |
| ソフトウェア定義ネットワーク | ネットワーク セグメンテーション、動的なポリシー適用 |

## 仮想化システム
**🎯 コンセプトの概要**
仮想化により、単一の物理マシン上で複数のOSを実行できます。これはコスト削減、柔軟性、テスト、そしてスケーラビリティの向上に活用されます。ハイパーバイザーはこれらの仮想環境を管理します。

**🧩 主要コンポーネント**
1. ハイパーバイザー（仮想マシンモニター - VMM）⚙️
- **タイプ I (ベアメタル)**: ハードウェアに直接インストールされ、運用サーバーで使用されます。
- **タイプ II (ホスト)**: OS 上のプログラムとして実行され、デスクトップ/テストに使用されます。

2. ホスト OS とゲスト OS 🧑‍💻
- **ホスト OS**: VM が実行される基本システム。
- **ゲスト OS**: VM 内の仮想オペレーティング システム。

**🌐 仮想化のメリット**
- ハードウェアコストの削減 💰
- スケーラビリティと弾力性の向上 📈
- より高速なリカバリとバックアップ 🔄
- テスト用の分離された環境 🧪
- レガシーシステムの継続的なサポート 🕰️

**📈 弾力性 vs. スケーラビリティ**

| 概念 | 定義 |
|---------------|-------------|
| **弾力性** 🔄 | リアルタイムの需要 (短期) に基づいてリソースを自動調整します。 |
| **スケーラビリティ** 📊 | 時間の経過とともに (長期的に) ユーザー/タスクの増加に対応できる容量を増やします。 |

**🔒 仮想化のセキュリティ上の利点**
- VM 間の分離 ➡️ 横方向の移動を防止します。
- 素早い復元のためのスナップショット💾。
- マルウェア分析のためのサンドボックス化 🧫

### 仮想ソフトウェア
- カプセル化されたアプリはホスト OS を変更せずに実行されます。
- 例: Wine を使用すると Linux 上で Windows アプリを実行できます 🍷🐧
- USB またはクラウド経由でポータブル アプリを有効にします。

### 仮想化ネットワーク
- ハードウェアとソフトウェアを統合された仮想ネットワークに組み合わせます。
- 動的なセグメンテーション、トラフィックシェーピング、より優れた制御が可能になります🎛️
- VLAN、仮想SAN、分離ネットワークなどの機能をサポート🔒

### すべてをソフトウェア定義
- ハードウェアを置き換える広範な仮想化のトレンド:
  - VDI（仮想デスクトップインフラストラクチャ）
  - VMI（仮想モバイルインフラストラクチャ）
  - SDS、SDN、SDV、SDDC など
- セキュリティと可視性のための集中管理🔍

#### 🖥️ シンクライアント
- 集中サーバーにアクセスする低機能デバイス。
- コストを節約し、ローカルでの侵害のリスクを軽減します💡

#### 🔭 ソフトウェア定義の可視性 (SDV)
- リアルタイムの自動ネットワーク監視。
- パケットレベルでの脅威対応の意思決定 🧠🔐

### 仮想化セキュリティ管理

#### ⚠️ 主な脅威
- **VM の拡散**: 管理されていない VM が多すぎると混乱が生じます! 🧨
- **シャドーIT**: 承認されていないシステム = リスク🚫
- **VM エスケープ**: ゲスト OS が分離を侵害する (例: VENOM CVE-2015-3456) 🚷

#### ✅ セキュリティのベストプラクティス
- ハイパーバイザーとゲストにパッチを適用しておく 🛠️
- 機密性の高いVMには分離されたネットワークを使用する 🔐
- VM イメージ ライブラリを実装する 📚
- アクティビティを監視し、頻繁にバックアップしてください 🕵️‍♂️
- 定期的にペンテストと脆弱性スキャンを実行する 🧪

### 🌍 試験の最終ノート
- タイプ I とタイプ II のハイパーバイザーの違いを理解する。
- 弾力性/スケーラビリティが仮想化とどのように関連しているかを理解する。
- VM の拡散やエスケープなどのリスクに注意してください。
- SDx および VDI/VMI はテスト済みの最新テクノロジーです。
- パッチ適用、バックアップ、セグメンテーション、監視などのセキュリティ制御が重要です。

## コンテナ化

### 🎯 コンセプトの概要
コンテナ化は仮想化の進化形であり、完全なゲストOSを必要とせずに、アプリケーションとその依存関係を**分離された環境**にパッケージ化します。従来のハイパーバイザーベースの仮想化よりも効率的です。

### 🆚 コンテナと仮想マシン

| 機能 | 仮想マシン 🖥️ | コンテナー 📦 |
|-------------------------|---------------------|
| OS 要件 | 完全なゲスト OS | ホスト OS カーネルを共有 |
| 起動速度 | 遅い ⏳ | 速い ⚡ |
| リソース効率 | 低 (OS の重複) | 高 (軽量) |
| 分離 | より強力 | 軽量 |
| 密度 (アプリ/サーバー) | 低い | 高い (10～100 倍) 📈 |

### 🧱 アーキテクチャ

- **コンテナエンジン** 🧰  
  - ハイパーバイザーの必要性を排除します。
  - 一般的な OS ライブラリとバイナリを提供します。
  - 複数のコンテナ (例: Docker Engine、containerd) を管理します。

- **コンテナ** 🧪  
  - アプリケーションと必要な依存関係を保持する自己完結型のユニット。
  - ホスト OS とコンテナ エンジン上で実行されます。

- **アプリケーションセル** 🧬  
  - コンテナの別名。
  - OS 間でのソフトウェアの移植性を可能にします。

### 🔀 主な特徴

- **ハイパーバイザーは不要** ❌🖥️
- **高い移植性** 環境間での互換性あり 🚀
- **リソースの効率的な使用** → CPU / RAM 使用量の削減 💡
- **迅速な導入** とスケーリング ⚙️⚡

### 🔐 セキュリティと分離

- コンテナ間の分離は強制されますが、次のようになります。
  - **ハイパーバイザーVMほど強力ではありません** 🧩
  - **コンテナ間でカーネルを共有** 🧠 → カーネルの脆弱性がすべてのコンテナに影響を及ぼす可能性があります

- **カスタムインタラクションコントロール**:
  - コンテナがどのように相互作用するか、または分離したままにするかを定義する 🔄

### ⚙️ コンテナテクノロジー

- **Docker** 🐳: コンテナ ランタイムの業界標準。
- **Kubernetes (K8s)** 🕸️: コンテナのクラスターを管理するためのオーケストレーション プラットフォーム。
- その他には、Podman、LXC、OpenShift などがあります。

### 💡 CISSP 試験のポイント

- **VM とコンテナの違い** を理解する
- **コンテナ密度の利点**を理解する
- **Docker と Kubernetes** に精通していること
- **セキュリティのトレードオフ**を認識する（共有カーネル、監視/分離の必要性）
- **効率性、展開速度、移植性**に関する質問が予想されます

## モバイルデバイス

### 📲 モバイルデバイスの概要
- **定義**: スマートフォン、タブレット、ラップトップ、スマートウォッチ、フィットネストラッカーなど、常時電源コードなしで動作するデバイス。
- **セキュリティ リスク**: モビリティ、簡素化された OS、ユーザーによる制御により、これらのデバイスは、データ漏洩、マルウェア、内部脅威に対して**高いリスク** を伴います。

### 🤖 Android と 🍏 iOS

#### 🤖 アンドロイド
- Google が所有する **オープンソース** Linux ベースの OS。
- **高度なカスタマイズ** の可能性 (不明なソースからのアプリ、代替 OS バージョン)。
- **セキュリティリスク**: 悪意のあるアプリ、安全でない送信。
- **SEAndroid**: Security-Enhanced Linux (SELinux) を MAC、サンドボックス、権限の強制と統合します。

#### 🍏 iOS
- iPhone、iPad で使用される **Apple のモバイル OS**。
- **クローズドエコシステム**、アプリはApp Storeからのみ入手可能（ジェイルブレイクしていない場合）。
- **静的 OS** 特性ですが、ユーザーによるカスタマイズは制限されています。

### モバイルデバイスのセキュリティ機能

#### 📱 モバイルデバイス管理
- **MDM**: モバイル デバイスをリモートで管理および監視します (アプリ、設定をプッシュし、ポリシーを適用します)。
- **UEM (統合エンドポイント管理)**: PC、モバイル、IoT などを 1 つのプラットフォームで管理します。

#### 🔓 デバイス認証
- **方法**: PIN、パスワード、生体認証 (顔、虹彩、指紋)、NFC、RFID。
- **ベスト プラクティス**: 効果的な保護のために暗号化と組み合わせます。

#### 🔑 完全なデバイス暗号化 (FDE)
- デバイスがロックされているときに**データを保護します**。
- 紛失または盗難にあったデバイスを保護するために**必須**です。

#### 🔐 コンテキスト認識認証
- ユーザーの場所、デバイス、ネットワークなどに基づいて**認証**レベルを調整します。

#### 📡 通信保護
- 安全な通信のために、**暗号化された VoIP** や **Signal などのアプリ** を使用します。

#### 🧹 リモートワイピング
- デバイスを紛失/盗難された場合、**リモートでデータを消去**します。
- データの回復を防ぐには、**暗号化** を使用すると最適に機能します。

#### 🔒 画面ロックとロックアウト

##### 🔐 画面ロック
- **安全なオプション**: PIN、パスワード、生体認証。
- **自動ロック設定**: 無人デバイスにとって重要です。

##### 🔐 デバイスのロックアウト
- ログインが複数回失敗するとトリガーされます (例: 10 回の試行 = ワイプ)。
- ブルートフォース攻撃を防止します。

##### 🛰 GPS と位置情報サービス
- **GPS、WiFi三角測量、Bluetooth、センサー** が追跡に使用されます。
- **ジオタグ**: メディアに位置情報を埋め込みます。
- **ジオフェンシング**: 位置情報に基づくルールを定義します (例: 安全なエリアではカメラを無効にする)。

#### 📁 コンテンツとアプリの制御

##### 📂 コンテンツ管理（MCM）
- デバイスの仕様とポリシーに基づいて、企業コンテンツへの**アクセスを制御**します。

##### 📱 アプリケーション制御
- **許可リスト**: 承認されたアプリのみを許可します (デフォルトでは拒否)。
- **MAM (モバイル アプリ管理)**: デバイスを完全に制御せずにアプリを管理します。

#### 🔔 プッシュ通知
- **プッシュベースのアラート** は便利ですが、ソーシャルエンジニアリングやマルウェアの配信に**悪用**される可能性があります。

#### 🛍 サードパーティのアプリストア
- **公式ストアよりもリスクが高い**。
- **MDM ポリシーによって無効にされることが多い**。

#### 💽 ストレージのセグメンテーション
- ユーザーデータと企業データを**別々に保存**します。
- **会社のデータのみのリモートワイプ**を有効にします。

#### 🧾 資産追跡
- デバイスの存在、**アプリの使用状況**、**データ アクセス**、コンプライアンスを追跡します。
- **パッシブ/アクティブ** モニタリングが利用可能です。

#### 🔌 リムーバブルストレージ
- **microSD、USB OTG、Bluetooth/WiFi ストレージ** が含まれています。
- リスクがあると見なされる場合は、MDM 経由で無効にすることができます。

#### ⚙️ 使用していない機能を無効にする
- **強化** 不要なアプリ/機能を無効にして攻撃対象領域を減らします。

#### ⚠️ ルート化または脱獄
- 完全な権限を付与し、不正アクセスやマルウェアを可能にします。
- **保証を無効にし**、更新をブロックし、企業環境では**禁止する必要があります**。

##### 💀 ブリッキング
- **ファームウェア エラーまたは改ざんによりデバイスが機能しなくなりました**。
- 最近のデバイスには**リカバリ ROM**が搭載されていることがよくあります。

#### 📥 サイドローディング
- **アプリを手動でインストール**、アプリストアをバイパスします。
- 多くの場合、**MDM/UEM によって禁止されています**。

#### 🧩 カスタムファームウェア
- デフォルトの OS を置き換えます。
- **危険**: セキュリティ機能が削除されたり、バックドアが導入されたりする可能性があります。

#### 🔓 キャリアロック解除
- **通信事業者の切り替え** が可能になります。
- ルート化とは異なり、**セキュリティ上のリスクはありません**。

#### 📡ファームウェアのOTA（無線）アップデート
- **脆弱性の修正**に重要です。
- **MDM/UEM の互換性が損なわれないように**、更新をテストします。

#### 🔐 資格情報管理
- **ログイン資格情報を安全に保存**するためのツール。
- **パスワード ボールト**、マスター パスワード、自動ログイン機能が含まれます。

#### 💬 テキストメッセージのリスク
- **SMS、MMS、RCS** は **フィッシング (スミッシング)** に使用される可能性があります。
- **SMS 2FA** は何もしないよりはましですが、他の方法よりも安全性は低くなります。

> ✅ **CISSP ヒント**: **モバイルリスクへの対策**、**MDM/UEM/MAM** の違い、**アプリの安全な利用**、**デバイスの強化** を理解することに重点を置きましょう。BYOD、デバイスの紛失/盗難、モバイルポリシーの適用に関するシナリオ質問に備えてください。

### モバイルデバイスの展開ポリシー

#### 1. 📃 ポリシーの目的
組織は、**個人所有および企業所有のモバイルデバイス**を安全に管理するために、明確な導入ポリシーを定義する必要があります。ポリシーでは、ユーザーに以下の点について教育する必要があります。
- ✅ メリットとリスク
- 🔐 セキュリティの期待
- ⚠️ プライバシーのトレードオフ
- 📜 法的影響

#### 2. 🔄 デプロイメントモデル

##### ✋ 個人所有デバイスの持ち込み (BYOD)
- 従業員は仕事に個人のデバイスを使用します。
- ❌ 高リスク: セキュリティ体制の大きなばらつき、マルウェアのリスク、制御の欠如。
- ⚠️ 従業員の個人情報と会社のデータが混在しています。
- 🚫 多くの場合、最も安全性の低いモデルです。

##### 🤳 自分のデバイスを選択する (CYOD)
- ユーザーは事前に承認されたデバイス リストから選択します。
- ✅ デバイスのセキュリティをより適切に制御します。
- ❓ コスト、払い戻し、サポートされていないデバイスなどの問題を提起します。
- ⚠️ 依然として個人データと仕事データが混在しています。

##### 💼 企業所有、個人支援（COPE）
- 組織がデバイスを購入し、従業員が個人的に使用できます。
- ✅ 制御されたハードウェアの選択、管理されたセキュリティ。
- ⚠️ 個人データの漏洩やマルウェアの侵入のリスクは依然として残ります。

##### 🛑 企業所有のモバイル戦略 (COMS/COBO)
- 会社所有およびビジネス専用のデバイス。
- 🔐 最も安全で、懸念事項の分離に最適です。
- 📵 個人使用は禁止。従業員は 2 台のデバイスを持ち歩くことができます。

##### 🛡️ モバイルデバイス展開ポリシーの詳細

###### 📦 データの所有権
- ビジネスデータと個人データの所有者を明確にします。
- MDM/UEM を介して **セグメンテーション** を実装します。
- 📤 バックアップ戦略を定義する必要があります。

###### 🛠️ 所有権をサポートする
- 修理、交換、サポートの責任を定義します。

###### 🔄 パッチとアップデートの管理
- 以下の明確なルール:
  - OSとアプリのパッチ適用
  - アップデート方法（OTA/Wi-Fi）
  - ロールアウト前のアップデートテスト

###### 🔍 フォレンジック
- 📱 捜査によりデバイスが押収される場合があります。
- 従業員に期待値を設定することが必要です。
- 法的アクセスは管轄規則に従う必要があります。

###### 🕵️ プライバシー
- **従業員のプライバシーの境界**を定義します。
- 労働者は監視が行われる可能性があることを認識する必要があります。

###### 🏗️ アーキテクチャ/インフラストラクチャに関する考慮事項
- エンドポイントの増加 → さらに：
  - 🧩 IP
  - 🛡️ IDS/IPS アクティビティ
  - 📶 無線の混雑
  - 🔄帯域幅の需要

###### ⚖️ 法的な懸念
- データ保護、責任、規制を評価します。

###### ✅ 利用規約
- **生産性への重点**を強化します。
- 個人用デバイスの誤用や注意散漫を避けてください。

###### 📸 オンボードカメラ/ビデオ
- 安全なエリアでは制限/無効にします。
- **ジオフェンシング** を使用してオンプレミスを自動的に無効にします。

###### 🎤 マイク
- 機密性の高い環境では危険です。
- 必要に応じて MDM/UEM 経由で無効にします。

###### 🔥 テザリング/ホットスポット
- 🚫 組織のセキュリティを回避する可能性があります。
- 企業敷地内ではブロックします。

###### 💳非接触決済
- 以下の場合にのみ使用してください:
  - 🔐 認証
  - 🛑 アプリの起動要件
- 金融システムにリンクされていない場合、企業のリスクは最小限に抑えられます。

###### 🧬 SIM のクローン作成
- SIM = ユーザー ID。
- クローンのリスク ➡️ 通信事業者の悪用、なりすまし。
- 🔒 SIMロックと安全なストレージを有効にします。

#### 🧠 CISSP の重要なポイント
- 📌 すべての展開モデルにはトレードオフがあります。組織のリスク許容度に合ったモデルを選択してください。
- 🛡️ BYOD = 厳しく制御されない限り、最もリスクが高い。
- 📚 ポリシーには、パッチ適用から法的責任まですべてが含まれる必要があります。
- 🤖 **セキュリティの適用**、**セグメンテーション**、および**リモート コントロール** には MDM/UEM を使用します。

## 必須のセキュリティ保護メカニズム

> 「サードパーティのソフトウェアを決して信頼しない」— 安全な OS 設計の基礎です。

### プロセスの分離
- 各プロセスは個別のメモリ空間を取得します。
- あるプロセスが別のプロセスのメモリに干渉したりアクセスしたりするのを防ぎます。
- 不正アクセスを防止し、プロセスの整合性を確保します。
- 🧠 仮想マシンまたは低権限の仮想アドレス空間を介して実装されます。

📝 **主な利点**: システムの安定性と機密性。

### ハードウェアのセグメンテーション
- プロセス分離に似ていますが、物理ハードウェアによって強制されます。
- 🛑 希少かつ高価で、通常は軍事または国家安全保障システムに使用されます。

### 信頼のルート
- 安全なシステムの基盤。
- 🔐 ブートとキー管理のための「信頼チェーン」を開始します。
- 信頼できるハードウェア コンポーネントを使用します。
  - TPM（トラステッド プラットフォーム モジュール）
  - HSM（ハードウェア セキュリティ モジュール）
- 機密操作を分離することでシステムの改ざんを防止します。

### システムセキュリティポリシー
- セキュリティを考慮したシステム設計と開発を導く青写真。
- カバー：
  - ハードウェア
  - ファームウェア
  - ソフトウェア
  - 人間との交流
- 🛡️ 多層セキュリティ ポリシーにより、高セキュリティ レベルから低セキュリティ レベルへの情報の流れを防止します。

📌 **重要**: 開発の早い段階で適用しないと、ポリシーが失敗します。

## 一般的なセキュリティアーキテクチャの欠陥と問題

### 隠れチャネル
- 通常の通信チャネル外で使用されるデータ パス。
- 🚫 通常のセキュリティ制御をバイパスします。

＃＃＃＃ 種類：
- ⏱️ 隠蔽タイミングチャネル
  - システムのパフォーマンスまたは応答時間を操作します。
- 📦 秘密のストレージチャンネル
  - 隠し/追跡されていないメモリ (例: スラック領域、未割り当て領域) に書き込みます。

🧩 **防御**: 強力な監査、動作分析、ヒューリスティック。

### 設計またはコーディングの欠陥に基づく攻撃
- プログラミングが不十分であったり、テストが不完全な場合、セキュリティ上のギャップが生じます。
- ⚠️ バックドアやメンテナンスフックが本番環境のコードに残る可能性があります。
- 一般的な例: SQLi、XSS、バッファ オーバーフロー。

✅ **軽減策**:
- 最初から安全な設計
- ソースコード解析ツール
- コードレビュー（第15章参照）

### ルートキット
- OS コンポーネントに隠れるマルウェア。
- 置き換え可能:
  - カーネル
  - ドライバー
  - 図書館
- 👻 タスク マネージャーやファイル ブラウザーには表示されません。

🧯 **対応**: システム全体を消去し、信頼できるバックアップから再インストールします!

🛡️ **検出**: ファイル ハッシュの変更、HIDS、動作の異常。

### 増分攻撃

#### 🧪 データ改ざん
- データに対する小さな変更 (多くの場合、内部者ベース)。
- 🧮 チェックサム、FIM、または暗号化によって防止します。

#### 🥪 サラミアタック
- 金融システム内の小さな値（例：ペニー）を切り捨てる。
- 🛡️ 予防するには:
  - SoD（職務分離）
  - 取引監視
  - セキュアコード制御

🎥 ポップカルチャーの参考資料: *オフィス・スペース*、*スーパーマン3*
