# 第7章: PKIと暗号化アプリケーション

- [非対称暗号](#asymmetric-cryptography)
  - [公開鍵と秘密鍵](#public-and-private-keys)
  - [RSA](#rsa)
  - [エルガマル](#elgamal)
  - [楕円曲線暗号](#elliptic-curve-cryptography)
  - [Diffie-Hellman鍵交換](#diffie-hellman-key-exchange)
  - [量子暗号](#quantum-cryptography)
- [ハッシュ関数](#hash-functions)
  - [SHAファミリー](#sha-family)
  - [MD5](#md5)
  - [RIPEMD](#ripemd)
  - [ハッシュ関数の値の長さの比較](#ハッシュ関数の値の長さの比較)
- [デジタル署名](#digital-signatures)
  - [HMAC](#hmac)
  - [デジタル署名標準](#digital-signature-standard)
- [公開鍵インフラストラクチャ](#public-key-infrastructure)
  - [証明書](#certificates)
  - [証明機関](#certificate-authorities)
  - [証明書のライフサイクル](#certificate-life-cycle)
  - [証明書のフォーマット](#certificate-formats)
- [非対称鍵管理](#asymmetric-key-management)
- [ハイブリッド暗号化](#hybrid-cryptography)
- [応用暗号](#applied-cryptography)
  - [ポータブルデバイス](#portable-devices)
  - [メールアドレス](#email)
  - [Web アプリケーション](#web-applications)
  - [ステガノグラフィとウォーターマーク](#steganography-and-watermarking)
  - [ネットワーキング](#networking)
  - [新興アプリケーション](#emerging-applications)
- [暗号攻撃](#cryptographic-attacks)
- [要約](#summary)

## 非対称暗号  

現代の情報セキュリティは、対称暗号を悩ませる鍵配布問題を解決するために、**公開鍵（非対称）アルゴリズム**に依存しています。非対称方式では、すべてのエンティティが**鍵ペア**を所有します。1つは💡を共有するための鍵（*公開*鍵）で、もう1つは🔒を保護するための鍵（*秘密*鍵）です。

### 公開鍵と秘密鍵  

| プロパティ | 公開鍵 | 秘密鍵 |
|----------|-------------|--------------|
| 可視性 | 自由に配布可能 (証明書、キー サーバー、QR コード) | 秘密に保持される (多くの場合、HSM、TPM、またはスマート カード内に保存) |
| 主な用途 | 機密性のために**暗号化**、署名を**検証** | 受信データを**復号化**、送信データを**署名** |
| セキュリティ上の懸念 | 真正性 (本当にアリスのものか?) | 機密性 (絶対に漏洩してはならない) |

*🧠 試験のヒント:*  
* 「受信者の ***公開*** 鍵で暗号化」 → 受信者のみが復号化できます。  
* 「送信者の***秘密***鍵で署名する」→誰でも送信者の公開鍵で真正性と否認不可性を検証できます。

### RSA  

* **セキュリティ原理:** 大きな複合因数分解の困難さ \(n = p \times q\)。  
* **キー生成手順（簡略化）:**  
  1. ランダムに2つの約2048ビットの素数\(p, q\)を選択します。  
  2. \(n = p \times q\)と\(\phi(n) = (p-1)(q-1)\)を計算します。  
  3. 公開指数\(e\)を選択します。ただし\(1 < e < \phi(n)\)かつ\(\gcd(e,\phi(n)) = 1\)（65537が一般的です）  
  4. \(e \times d \equiv 1 \;(\mathrm{mod}\;\phi(n))\)となる秘密指数\(d\)を求めます。  
* **操作:**  
  * 暗号化: \(C = P^{e} \bmod n\)  
  * 復号化 / 署名生成: \(P = C^{d} \bmod n\)  
* **強度ガイドライン（NIST SP 800-57）:**  
  * 2048 ビット RSA ≈ 112 ビットの対称強度 (約 2030 まで有効)。  
  * 3072 ビット RSA ≈ 128 ビットの対称強度 (2030 年以降も有効)。

**長所:** 成熟しており、幅広くサポートされています (TLS、SSH、PGP、S/MIME)。  
**短所:** 遅く、キー/暗号文が大きい。**量子**因数分解に対して脆弱 (Shor)。

### エルガマル  

* Diffie-Hellman 数学の拡張。有限体の **離散対数問題 (DLP)** に依存します。  
* 2 部構成の暗号文を生成 → **メッセージ サイズが 2 倍になります** ⚠️。

* **利点:** 従来の RSA 特許が存在せず、セマンティック セキュリティが提供され、一時的に使用される場合の **前方秘匿性** がサポートされます。  
* **使用例:** PGP (キー転送用)、かつては RSA ライセンスが重要だった暗号化ライブラリ。

### 楕円曲線暗号

* 楕円曲線離散対数問題 (ECDLP) によるセキュリティ — 整数 DLP や因数分解よりも難しいと考えられています。  
* **小さなキー、同じ強度:**  
  | 対称強度 | RSA/DH キー | ECC キー |
  |--------------------|------------|----------|
  | 112 ビット | 2048 ビット | 224 ビット |
  | 128 ビット | 3072 ビット | 256 ビット |
* 一般的な曲線: **P-256** (`secp256r1`)、**P-384**、**Curve25519**。  
* 主なプロトコル: **ECDSA** (署名)、**ECDH/ECDHE** (鍵交換)。  
* CPU とバッテリーの需要が低いため、モバイル/IoT に最適です🔋。

### ディフィー・ヘルマン鍵交換  

* 目標: キー自体を送信せずに、オープン チャネルを介して共有対称キーに同意する。  
* **クラシックDH数学:**  
  1. 公開パラメータ: 素数 \(p\) と生成子 \(g\)。  
  2. アリスは秘密\(a\)を選び、\(A = g^{a} \bmod p\)を送信します。  
  3. ボブは秘密\(b\)を選択し、\(B = g^{b} \bmod p\)を送信します。  
  4. 両方とも\(K = (other^{secret}) \bmod p\)を計算します。  
* **バリエーション:**  
  * **DHE** (一時的) → 前方秘匿性。  
  * **ECDHE** → 速度とキーの短縮のために ECC を使用します。  
* **暗号化アルゴリズムそのものではなく**、**鍵合意**メカニズムのみです。

### 量子暗号  

* **量子コンピューティングの脅威:** ショアのアルゴリズムは、RSA、DH、ECC を多項式時間で解読できる可能性があります ⏱️。  
* **量子鍵配布 (QKD):** 光子の偏光を使用します。盗聴により量子状態が崩壊し、すぐに検出可能になります。  
* **量子耐性暗号 (PQC):** NIST 標準化に基づく格子ベース (CRYSTALS-Kyber)、ハッシュベース (SPHINCS+)、多変量、コードベースの方式。  
* **CISSPの持ち帰り:**  
  * 暗号資産をインベントリ化し、分類します。  
  * **暗号の俊敏性**（アルゴリズム/キーをすばやく交換する機能）を計画します。  
  * 長期にわたる機密データ (▶ 10 年) については、すでに PQC の準備を検討する必要があります。

## ハッシュ関数  

**ハッシュ関数**は、任意の長さの入力を、データを一意に表現する固定長の**メッセージダイジェスト**に変換します。このダイジェストは、データを反転（一方向）することはできません。実際には、ダイジェストはメッセージに付加されたり、署名されたりすることで、**整合性**と**発信元**を証明します。

### ハッシュが重要な理由
1. **整合性チェック** – 受信者はメッセージを再ハッシュし、ダイジェストが一致するとメッセージは変更されません。  
2. **デジタル署名** – 送信者は大きなデータに直接署名する代わりに、コンパクトなダイジェストに署名します。  

> **サイズに関する注意:** 最近のダイジェストのほとんどは 128 ビット以上です。ダイジェストが長いほど、衝突のリスクは低くなります。

### 暗号ハッシュの 5 つの要件 (RSA セキュリティ)  
1. **任意の長さの入力** が処理されます。  
2. **固定長出力** が生成されます。  
3. **効率** – 計算が速い。  
4. **一方向** – ハッシュから入力を導出することは不可能です。  
5. **衝突耐性** – 同じハッシュを持つ 2 つの入力を見つけることは不可能です。

### SHAファミリー  

| バリアント | ダイジェスト (ビット) | ブロック (ビット) | ステータス (2025) | 注記 |
|---------|---------------|---------------|---------------|-------|
| **SHA-1** | 160 | 512 | ❌ 非推奨 | 衝突（「SHAttered」、2017）。 |
| **SHA-256** | 256 | 512 | ✅ 安全 | SHA-2 ファミリー。 |
| **SHA-224** | 224 | 512 | ✅ 安全 | 切り捨てられた SHA-256。 |
| **SHA-512** | 512 | 1024 | ✅ 安全 | SHA-2 ファミリー。 |
| **SHA-384** | 384 | 1024 | ✅ 安全 | 切り捨てられた SHA-512。 |
| **SHA-3** (224-512) | 224-512 | スポンジ | ✅ 安全 | Keccak アルゴリズム。ソフトウェアでは遅いですが、SHA-2 の代替として使用できます。 |

*ダイジェスト サイズを記憶する* — CISSP でよく聞かれる質問です。

### MD5  

* **MD2** (1989) → **MD4** (1990) → **MD5** (1992) へと進化しました。  
* 512 ビットのブロックを 4 ラウンド処理し、**128 ビット** のダイジェストを出力します。  
* **破損:** 実際の衝突 (Lenstra、2005) により、偽造証明書が可能になります。  
* セキュリティ以外の用途（ファイルの重複排除など）にのみ許容され、署名や証明書には使用できません。

### RIPEMD  

| バリアント | ダイジェスト | セキュリティ |
|---------|--------|----------|
| RIPEMD | 128 b | 安全でない |
| RIPEMD-128 | 128 b | 安全でない |
| **RIPEMD-160** | 160 b | ✅ 安全 (ビットコイン、オープンソース) |
| RIPEMD-256 | 256 b | 128 b と同じセキュリティ (安全でない) |
| RIPEMD-320 | 320 b | 160 b と同じセキュリティ (セキュア) |

> 🤔 **奇妙な事実:** ダイジェスト (RIPEMD-256) を長くしても、必ずしもセキュリティが向上するわけではありません。

### ハッシュ関数の値の長さの比較  

| ハッシュ関数 | ダイジェスト長 (ビット) |
|---------------|----------------------|
|ハヴァル | 128 / 160 / 192 / 224 / 256 |
| **HMAC** | 変数 (基礎となるハッシュによって異なります) |
| MD5 | 128 |
| SHA-1 | 160 |
| SHA2-224 / SHA3-224 | 224 |
| SHA2-256 / SHA3-256 | 256 |
| SHA2-384 / SHA3-384 | 384 |
| SHA2-512 / SHA3-512 | 512 |
| RIPEMD-128 | 128 |
| RIPEMD-160 | 160 |
| RIPEMD-256 | 256 (セキュリティ ≈ 128) |
| RIPEMD-320 | 320 (セキュリティ ≈ 160) |

### CISSP のクイック テイクアウト 📌  
* 新しい展開では **SHA-256** 以上の強度を選択してください。  
* MD5 と SHA-1 は、証明書、署名、整合性の保証には**不適切**です。  
* ダイジェストのサイズと非推奨のバリアントについて理解します。  
* 5 つのハッシュ要件と、整合性チェックとデジタル署名におけるダイジェストの 2 つの役割を覚えておいてください。

## デジタル署名  

デジタル署名は、**ハッシュ** と **公開鍵暗号化** を組み合わせて、CISSP の重要な 3 つの目標を達成します。  

| 暗号化の目的 | デジタル署名がそれを実現する方法 |
|-------------|----------------------------------------|
| **整合性** 🛡️ | 受信者はメッセージを再ハッシュし、署名されたダイジェストと比較します。 |
| **認証** 🔑 | **送信者の秘密鍵** のみが署名を生成でき、送信者の公開鍵を使用して誰でもそれを検証できます。 |
| **否認不可** 📜 | 送信者は、自分の秘密鍵のみが生成できる署名を作成したことを信頼性をもって否定できません。 |

**コアワークフロー（アリス➔ボブ）:**  
1. アリスは平文をハッシュ（例：SHA-512）してダイジェストを生成します。  
2. アリスはそのダイジェストを**自分の秘密鍵**で暗号化し、デジタル署名します。  
3. ボブはプレーンテキストに署名を追加します (または機密性を保つために、ボブの公開鍵を使用してバンドル全体を暗号化します)。  
4. ボブは**アリスの公開鍵**を使って署名を復号し、受信した平文をハッシュ化し、ダイジェストを比較します。一致⇒本物、無傷。

> ℹ️ **キー選択チートシート**  
> * 機密データを暗号化しますか? **受信者の公開鍵**  
> * あなたに送信された機密データを復号しますか？**あなたの秘密鍵**  
> * データに署名しますか? **秘密鍵**  
> * 署名を検証しますか? **送信者の公開鍵**

### HMAC  

ハッシュベースのメッセージ認証コードは、標準ハッシュ (MD5、SHA-2、SHA-3 など) と共有秘密キーを組み合わせた対称的な代替手段です。

| 機能 | HMAC | 完全なデジタル署名 (RSA / ECDSA / EdDSA) |
|---------|------|----------------------------------------------|
| 誠実さ | ✅ | ✅ |
| 認証 | ✅ (キーを知っている人) | ✅ |
| 否認不可 | ❌ (共有キー) | ✅ |
| 使用されるキー | 1 つの共有秘密 | 公開 / 秘密のペア |
| パフォーマンス | 非常に高速 ⚡ | 低速 (非対称計算) |

*使用例:* VPN トンネル、TLS レコード MAC、API トークンなど、双方がすでに秘密を共有しており、否認防止が **必要ありません**。

### デジタル署名標準  

NIST **FIPS 186-5** (別名 DSS) は、米国承認の署名アルゴリズムをリストし、新しい連邦システムに SHA-3** ハッシュ関数を義務付けています。

| アルゴリズム | キー タイプ | 強度に関する注記 | 標準的なキー サイズ | ハイライト |
|-----------|----------|----------------|------------------|------------|
| **RSA** (RFC 8017) | 整数因数分解 | 成熟、普及 | ≥ 2048 ビット | シンプルな検証、大きなキー |
| **ECDSA** (FIPS 186-5) | 楕円曲線 | 小さなキーで同等の強度 | 256 ビット (P-256) | IoT / モバイルに最適 |
| **EdDSA** (RFC 8032) | エドワーズ曲線 | 決定論的、サイドチャネル耐性 | Ed25519 / Ed448 | 非常に高速な検証 |

*試験のヒント:*  
* DSS は SHA-1 を使用した DSA を承認しなくなり、SHA-3 のみ承認します。  
* ECDSA と EdDSA は本質的に否認不可をサポートします。  
* 速度と小さなキーが重要な場合は、RSA よりも **ECDSA** または **EdDSA** を指すテストの回答が予想されます。

## 公開鍵インフラストラクチャ  

**PKI** は、**デジタル証明書** を介して検証された ID を公開キーにリンクする信頼の階層です。  
結果: 事前に秘密を共有する代わりに、証明書チェーンを信頼することで、見知らぬ人が安全な (ハイブリッド) 通信をブートストラップできるようになります。

### 証明書  

* **規格:** ITU-T **X.509**。  
* **主要なフィールド (覚えておいてください!):** バージョン、**シリアル番号**、署名アルゴリズム、**発行者**、**有効期間**、**サブジェクト**、**サブジェクト公開キー情報**、拡張子。  
* **ワイルドカード** 証明書 (`*.example.org`) は 1 つのサブドメイン レベルのみをカバーします。  
* 使用例: サーバー TLS、電子メール、コード署名、デバイス認証。  

| 証明書の種類 | 本人確認 | 一般的な使用方法 | 例 |
|------------------|------------------|------------|----------|
| **ドメイン検証 (DV)** | ドメインの制御を証明 | 基本的な HTTPS | letsencrypt.org |
| **組織認証 (OV)** | 法人であることを確認します | エンタープライズ アプリ | digicert.com |
| **拡張検証 (EV)** | 厳格な法的チェックと運用チェック | 信頼性の高いサイト (銀行) | グリーン バー (レガシー) |

### 証明機関  

* **ルートCA** (オフライン) → **中間CA** (オンライン) → **エンドエンティティ証明書**。この連鎖により、ルートの秘密鍵は電源オフの状態を維持できます💡。  
* **登録機関 (RA):** CA に代わって ID チェックを実行します。  
* 信頼モデル: ブラウザにはルート ストアが付属しており、そのチェーンで署名されたものはすべて暗黙的に信頼されます。  
* 組織は、イントラネット証明書 (内部でのみ信頼される自己署名ルート) に対して **内部 CA** を実行できます。  

> **リスクに関する注意:** 1 つの不注意な CA が信頼チェーンに悪影響を及ぼす可能性があります (例: Symantec 2017 ➔ DigiCert に売却)。

### 証明書のライフサイクル  

| フェーズ | 主なアクティビティ | CISSP の重点 |
|-------|----------------|--------------|
| **登録** | 本人確認 ➔ **CSR** の提出 ➔ CA が証明書を発行および署名 | DV と EV の要件 |
| **操作 / 使用** | 証明書をインストールします。ピアはチェーンを検証し、失効を確認します | PIN 証明書 (HPKP は非推奨) |
| **更新** | 有効期限前に新しい証明書を取得します。キーを再利用するか、新しいキーを生成することができます | 自動化を計画します |
| **失効** | CA は有効期限が切れる前に証明書を無効としてマークします (侵害、名前の変更など) | CRL、OCSP、ステープリング |
| **有効期限と破棄** | 証明書は自然に期限切れになり、キーは安全に破棄またはアーカイブされます | キー破棄ポリシーを適用します |

#### 失効メカニズム  

| 方法 | 仕組み | レイテンシー | 負荷 | 注意事項 |
|--------|--------------|---------|------|-------|
| **CRL** | クライアントは CA 署名済みの失効シリアル番号のリストをダウンロードします | 高 (リスト更新) | 低 CA 負荷 | 定期的なポーリング |
| **OCSP** | クライアントが CA の OCSP レスポンダにリアルタイムのステータスを照会します | 低 | 高 CA 負荷 | 応答: 良好 / 失効 / 不明 |
| **OCSP ステープル** | サーバーは署名された OCSP 応答をキャッシュします ⏲️ (例: 24 時間)、TLS ハンドシェイクに「ステープル」します | 非常に低い | CA 負荷が最小限 | 最新の TLS デフォルト |

### 証明書の形式  

| フォーマット | エンコーディング | ファイル拡張子 | 内容 | 一般的なプラットフォーム |
|--------|-----------|-----------|----------|------------------|
| **DER** | バイナリ ASN.1 | `.der`、`.crt`、`.cer` | 単一証明書 | Java、アプライアンス |
| **PEM** | Base64 (ASCII) | `.pem`、`.crt` | 証明書、チェーン、またはキー | Unix/Linux、OpenSSL |
| **PFX / PKCS #12** | バイナリ コンテナー (パスワード保護) | `.pfx`、`.p12` | 証明書 **+** 秘密キー | Windows インポート/エクスポート |
| **P7B / PKCS #7** | Base64 (ASCII) | `.p7b` | 証明書またはチェーン (秘密キーなし) | Windows/IIS |

*注意:* `.crt` は PEM **または** DER である可能性があります。ファイルを検査してください (BEGIN/END == PEM)。🔍

## 非対称鍵管理  

優れた暗号資産は単なる計算ではなく、**鍵の衛生管理**も重要です。以下のベストプラクティスの柱に従ってください。

| 制御 | なぜ重要なのか | CISSP のヒント |
|---------|----------------|----------------|
| **アルゴリズムの選択** | 公開され、査読済みのアルゴリズムのみ (RSA、ECDSA、EdDSA)。「ブラックボックス」≡ 🚩。| 隠蔽によるセキュリティ ≠ セキュリティ。|
| **キーの長さとランダム性** | 長いキーは強力ですが、速度が遅くなります。FIPS / NIST テーブルを使用し、**真のランダム** または NIST 認定の DRBG からキーを導出します。| 攻撃を助長するパターンバイアスを避けます。|
| **秘密キーの秘密性** | 露出 ➔ 回復不可能な侵害およびなりすまし。 | HSM、TPM、スマート カードに保存し、決して共有しないでください。 |
| **ローテーション/廃止** | 検出されない侵害の期間を制限します。 | ポリシーを適用します (例: 1～3 年) ⏳。 |
| **バックアップ/エスクロー** | キーを紛失するとアクセスできなくなります。 | 知識の分割 + 二重制御; エスクロー ストレージを暗号化します。 |
| **ハードウェア セキュリティ モジュール (HSM)** | キーを漏らすことなく生成、保存、使用する、改ざん防止チップ。 | ハードウェア アクセラレーションと監査ログを追加します。 |

## ハイブリッド暗号化  

対称の**スピード**と非対称の**スケーラブルなキー交換**を組み合わせます。

1. 当事者は公開鍵方式（ECDHE など）をネゴシエートします。  
2. それを一度使用して、ランダムな**一時的な対称キー**について合意します。  
3. すべてのバルクデータは高速対称暗号化 (AES、ChaCha20) の下で送信されます。  
4. セッション終了 → キーは破棄されます🗑️ (完全な前方秘匿性)。

**TLS 1.3** は教科書的な例です。

| ステップ | ハンドシェイクアクション (簡略化) |
|------|---------------------------------|
| 1️⃣ | ClientHello → サポートされている暗号スイートを一覧表示します |
| 2️⃣ | ServerHello + cert → スイートを選択し、公開鍵を送信します |
| 3️⃣ | 両方とも ECDHE 経由で共有秘密を計算します |
| 4️⃣ | セッションキーを導出し、対称暗号化に切り替える |

## 応用暗号  

### ポータブルデバイス

* **フルディスク/ファイル暗号化:** BitLocker、FileVault、VeraCrypt。  
* **TPM チップ** はキーを保護し、ブート測定に結び付けます。  
* モバイル OS (iOS、Android) はハードウェア バックアップの AES-XTS または ChaCha20 を提供します。キーのロックを解除するにはパスコード/PIN が必要です。  
* 評価: RAM 内のキー保護、FDE と FBE、リモート ワイプのサポート。

### メール

| ニーズ | テクニック | ツール/標準 |
|------|-----------|-----------------|
| 機密性 | メッセージの暗号化 | PGP、S/MIME |
| 整合性と認証 | ハッシュ + 署名 | PGP 署名、S/MIME |
| 否認防止 | デジタル署名 | PGP、S/MIME |
| 上記のすべて | 暗号化 **および** 署名 | PGP (OpenPGP) または S/MIME |

* **PGP / OpenPGP** – 信頼のウェブ、ハイブリッド暗号化。  
* **S/MIME** – X.509 PKI、RSA/ECDH キー、Outlook、Apple Mail、Gmail Enterprise+ に組み込まれています。  
* 送信者は、暗号化、署名、またはその両方（コストと必要性）を選択します。

### ウェブアプリケーション

* **トランスポート層セキュリティ (TLS)** が SSL に代わりました。  
* **セキュア バージョン:** 1.2 (最小) および 1.3 (推奨)。  
* TLS 1.3 のデフォルト: キー交換に ECDHE、AES-GCM または ChaCha20-Poly1305 バルク暗号、MAC に SHA-256/384。  
* **POODLE** およびその他の攻撃により、SSL 3.0 フォールバックが停止しました。  
* **暗号スイート表記:** `TLS_AES_256_GCM_SHA384` (バルク暗号 + MAC)。  
* **証明書ピンニング / HSTS** 不正な CA から防御し、ダウングレードします。

### ステガノグラフィーと透かし

| コンセプト | 仕組み | ユースケース | リスク |
|---------|--------------|-----------|-------|
| **ステガノグラフィー** | 画像/音声/動画の LSB またはテキスト内にデータを隠します (隠蔽暗号)。 | 秘密チャネル、スパイ活動。 | 視覚的に検出するのは困難ですが、スキャンするためのツールが存在します。 |
| **透かし** | 所有者/シリアル情報を目に見えない形で埋め込みます。 | IP 保護、リーク トレース。 | フォーマットの変更に耐える必要があります。 |

### ネットワーク

#### リンクとエンドツーエンドの暗号化  

| 機能 | **リンク暗号化** | **エンドツーエンド暗号化** |
|---------|--------------------|---------------------------|
| OSI 層 | 1～2 | 4～7 |
| ヘッダーを暗号化しますか? | はい → すべてのホップで復号化/再暗号化します | いいえ (ペイロードのみ) |
| 例 | IPSec **トンネル** モード | TLS、SSH |

#### プロトコルのハイライト  

* **SSH-2** – Diffie-Hellman / Ed25519 キー、SFTP、チャネル多重化 (= 単一の SSH 接続を介して複数のセッションを実行)。  
* **IPSec**  
  * コンポーネント: **AH** (整合性、認証) + **ESP** (機密性、整合性)。  
  * モード: **トランスポート** (ペイロードのみ) vs **トンネル** (パケット全体)。  
  * **セキュリティ アソシエーション (SA)** = 一方向チャネル。デュプレックス接続ごとに 2 つの SA。

### 新興アプリケーション

| エリア | 暗号の役割 | 重要なポイント |
|------|--------------|-------------|
| **ブロックチェーン** | 分散型、不変の台帳 | ECDSA/EdDSA 署名、PoW/PoS コンセンサス |
| **軽量暗号化** | 電力制約のあるデバイスまたは低レイテンシのデバイス | カスタム ASIC/FPGA、NIST「LW-C」プロジェクト (例: Ascon)。 |
| **準同型暗号化** | 暗号文を復号化せずに計算します | プライバシー保護の分析を可能にしますが、CPU に負荷がかかります。 |

## 暗号攻撃  

以下は、CISSP が認識を求めている攻撃パターン、攻撃者が悪用する弱点、および従来の対抗手段です。

| 攻撃タイプ | ターゲット/原則 | 試験対応の対策 |
|-------------|-------------------|---------------------------|
| **ブルート フォース** | すべてのキーを試します🙈 | 長いランダム キーを使用します; ロックアウト/遅延メカニズム |
| **レインボー テーブル** | 事前計算済みハッシュ リスト | ソルト + キー ストレッチ (PBKDF2、bcrypt、scrypt) |
| **解析的** | アルゴリズムの代数的ショートカット | 査読済み、公的に検証された暗号 |
| **実装** | バグ / コーディングの不備 (数学的問題ではない) | セキュアコーディング、パッチ適用、形式的検証 |
| **統計的** | RNG が貧弱または偏りがある | NIST 承認の CSPRNG を使用する |
| **フォールト インジェクション** | 電圧、温度、レーザー障害によるキーの漏洩 | 改ざん防止 HSM、センサー、セルフワイプ |
| **サイドチャネル** | 電力、EM、タイミング漏れ | 一定時間コード、シールド、ノイズ注入 |
| **タイミング** | オペレーション期間を測定 (サイドチャネルのバリエーション) | コードパスを均等化し、RSA/ECDSA をブラインド化 |
| **頻度分析** (暗号文のみ) | 単純な暗号における文字の分布 | 最新の多アルファベット/ブロック暗号を使用する |
| **既知の平文** | P + C ペアを持つ | 強力な暗号を使用する (AES、ChaCha20) |
| **選択された平文** | 攻撃者は選択された P を入力 | 耐性のある設計 (AES、最新のブロック モード) |
| **選択された暗号文** | Oracle が攻撃者の C を復号化 | パディング防止モード (OAEP、GCM) |
| **中間者** | 2 ラウンドの暗号化 (例: 2DES) | 3 ラウンド以上を使用 (3DES、AES) |
| **中間者 (MITM)** | ハンドシェイクを偽装し、2 つのキーを使用 | 相互認証、証明書、ピンニング |
| **誕生日 / 衝突** | 同じハッシュを持つデュアル入力 | 長いハッシュ (≥ 256 ビット)、衝突耐性アルゴリズム |
| **リプレイ** | キャプチャしたパケットを再送信 | タイムスタンプ、ノンス、ワンタイムトークン |

🔥 **重要な概念:** 追加のキービットごとにブルートフォースの時間が 2 倍になります。安全な設計 = アルゴリズムの強度 × 完璧な実装 × 適切なキー管理。

＃＃ まとめ  

* **非対称暗号化** により、公開鍵と秘密鍵のペアと PKI 発行の証明書を使用して、見知らぬ人同士でもスケーラブルで信頼できる通信が可能になります。  
* **デジタル署名** はハッシュと非対称暗号化を組み合わせて、整合性、認証、否認防止を実現します。  
* **キー管理** のベスト プラクティス (強力なアルゴリズム、秘密のプライベート キー、ローテーション、HSM) により、暗号の耐久性が長期にわたって維持されます。  
* **ハイブリッド暗号化** (例: TLS 1.3) は、非対称キー交換と高速な対称バルク暗号化を組み合わせて、実用的なパフォーマンスを実現します。  
* **適用された暗号化** により、保存中のデータ (BitLocker、FileVault)、電子メール (PGP、S/MIME)、Web (TLS)、ネットワーク (IPSec、SSH)、およびブロックチェーン、軽量 IoT、準同型分析などの新しい分野のデータが保護されます。  
* **攻撃の状況** は、ブルートフォース、分析、実装、サイドチャネル、MITM、リプレイ、衝突の手法に及びます。防御には、健全なアルゴリズム、十分なキー サイズ、強化された実装、および綿密な運用管理が必要です。

これらの原則をマスターすれば、CISSP 試験や現場で弱い暗号を見つけ出し、適切な修正を選択できるようになります。🚀
