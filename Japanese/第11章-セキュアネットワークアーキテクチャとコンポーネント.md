# 第11章: セキュアネットワークアーキテクチャとコンポーネント

- [勉強の基本](#study-essentials)
- [OSIモデル](#osi-model)
  - [OSI モデルの歴史](#history-of-the-osi-model)
  - [OSI機能](#osi-functionality)
  - [カプセル化/カプセル化解除](#encapsulationdeencapsulation)
  - [OSIレイヤー](#osi-layers)
- [TCP/IP モデル](#tcpip-model)
- [ネットワークトラフィックの分析](#analyzing-network-traffic)
- [共通アプリケーション層プロトコル](#common-application-layer-protocols)
- [トランスポート層プロトコル](#transport-layer-protocols)
- [ドメインネームシステム](#domain-name-system)
  - [DNSポイズニング](#dns-poisoning)
  - [ドメインハイジャック](#domain-hijacking)
- [インターネット プロトコル (IP) ネットワーク](#internet-protocol-ip-networking)
  - [IPv4 対 IPv6](#ipv4-vs-ipv6)
  - [IPクラス](#ip-classes)
  - [ICMP](#icmp)
  - [IGMP](#igmp)
- [ARPに関する懸念](#arp-concerns)
- [セキュア通信プロトコル](#secure-communication-protocols)
- [多層プロトコルの影響](#implications-of-multilayer-protocols)
  - [統合プロトコル](#converged-protocols)
  - [ボイスオーバーインターネットプロトコル (VoIP)](#voice-over-internet-protocol-voip)
  - [ソフトウェア定義ネットワーク](#software-defined-network)
- [セグメンテーション](#segmentation)
- [エッジネットワーク](#edge-networks)
- [ワイヤレスネットワーク](#wireless-networks)
  - [SSIDのセキュリティ保護](#securing-the-ssid)
  - [ワイヤレスチャネル](#wireless-channels)
  - [サイト調査の実施](#conducting-a-site-survey)
  - [ワイヤレスセキュリティ](#wireless-security)
  - [Wi-Fi 保護セットアップ (WPS)](#wi-fi-protected-setup-wps)
  - [ワイヤレスMACフィルター](#wireless-mac-filter)
  - [ワイヤレスアンテナ管理](#wireless-antenna-management)
  - [キャプティブポータルの使用](#using-captive-portals)
  - [一般的な Wi-Fi セキュリティ手順](#general-wi-fi-security-procedure)
  - [無線通信](#wireless-communications)
  - [無線攻撃](#wireless-attacks)
- [衛星通信](#satellite-communications)
- [セルラーネットワーク](#cellur-networks)
- [コンテンツ配信ネットワーク (CDN)](#content-distribution-networks-cdns)
- [セキュアネットワークコンポーネント](#secure-network-components)
  - [ハードウェアの安全な操作](#secure-operation-of-hardware)
  - [共通ネットワーク機器](#common-network-equipment)
  - [ネットワークアクセス制御](#network-access-control)
  - [ファイアウォール](#firewalls)
  - [エンドポイントセキュリティ](#endpoint-security)
  - [ケーブル配線、トポロジー、および伝送メディア技術](#cabling-topology-and-transmission-media-technology)
  - [伝送メディア](#transmission-media)
  - [トランスポートアーキテクチャ](#transport-architecture)
  - [ネットワークトポロジ](#network-topologies)
  - [イーサネット](#ethernet)
  - [サブテクノロジー](#サブテクノロジー)
- [要約](#summary)

## 勉強の基本
| 要点（最初の文） | 詳細（残りの内容） |
|---|---|
| OSI モデルの層を理解します。 | OSI 層は、アプリケーション、プレゼンテーション、セッション、トランスポート、ネットワーク、データ リンク、および物理です。 |
| ネットワーク コンテナーの名前を把握します。 | ネットワーク コンテナーは、OSI レイヤー 7 ～ 5 のプロトコル データ ユニット (PDU)、レイヤー 4 のセグメント (TCP) またはデータグラム (UDP)、レイヤー 3 のパケット、レイヤー 2 のフレーム、およびレイヤー 1 のビットです。 |
| MACアドレスについて理解しましょう。 | メディアアクセス制御（MAC）アドレスは、16進数で表記される6バイト（48ビット）のバイナリアドレスで、ハードウェアアドレス、物理アドレス、NICアドレス、イーサネットアドレスとも呼ばれます。アドレスの最初の3バイト（24ビット）は組織固有識別子（OUI）で、ベンダーまたはメーカーを表します。 |
| TCP/IP モデルを理解します。 | DARPA モデルまたは DOD モデルとも呼ばれるこのモデルには、アプリケーション (プロセスとも呼ばれます)、トランスポート (ホスト間とも呼ばれます)、インターネット (インターネットワーキングとも呼ばれます)、およびリンク (ネットワーク インターフェイスやネットワーク アクセスという用語が使用される場合もあります) の 4 つの層があります。 |
| DNSについて理解しましょう。 | ドメインネームシステム（DNS）は、パブリックネットワークとプライベートネットワークの両方で使用される階層的な命名体系です。DNSは、人間が理解しやすい完全修飾ドメイン名（FQDN）とIPアドレスを結び付けます。DNSSECとDoHはDNSのセキュリティ機能です。 |
| DNSポイズニングについて理解しましょう。 | DNSポイズニングとは、クライアントが目的のシステムにアクセスするために使用するDNS情報を偽造する行為です。不正なDNSサーバー、ファーミング、hostsファイルの改ざん、IP設定の破壊、DNSクエリのスプーフィング、プロキシの偽装などによって実行される可能性があります。 |
| ARPについて理解しましょう。 | アドレス解決プロトコル（ARP）は、論理アドレスと物理アドレスの相互運用性に不可欠です。ARPはIPアドレスをMACアドレスに変換するために使用されます。また、ARPポイズニングについても理解しましょう。 |
| マイクロセグメンテーションについて理解しましょう。 | マイクロセグメンテーションとは、内部ネットワークを多数のサブゾーンに分割することです。サブゾーンは、高価値サーバーやクライアント、エンドポイントデバイスといった単一のデバイス単位にまで及ぶこともあります。各ゾーンは、内部セグメンテーションファイアウォール（ISFW）、サブネット、またはVLANによって分離されます。 |
| エッジネットワークについて理解しましょう。 | エッジネットワークとは、ネットワーク内のエッジデバイスにコンピューティングリソースを戦略的に割り当てる、綿密に設計されたデータアーキテクチャです。この設計により、処理能力の需要が中央サーバーから分散され、デバイスが処理ワークロードの大部分を処理できるようになります。 |
| 様々な無線技術について理解しましょう。 | 携帯電話、Bluetooth（802.15.1およびBluetooth SIG）、Wi-Fi無線ネットワーク（802.11）は、それぞれ異なる技術でありながら、すべて無線技術と呼ばれています。それぞれの違い、長所、短所を理解しましょう。802.11ネットワークのセキュリティ保護の基本を理解しましょう。RFID、NFC、衛星通信、ナローバンド、Zigbeeについても理解しましょう。 |
| サイトサーベイについて理解する。| サイトサーベイとは、無線信号強度、品質、干渉をRF信号検出器を用いて正式に評価することです。サイトサーベイは、無線基地局を所定の場所に設置し、そのエリア全体から信号測定値を収集することで実施されます。|
| WPS攻撃について理解する。 | Wi-Fi Protected Setup（WPS）は、セキュリティ保護されたワイヤレスネットワークに新しいクライアントを追加する際の手間を省くことを目的としています。WPSが起動すると、ネットワークを検索した最初の新しいワイヤレスクライアントが自動的に接続されます。 |
| キャプティブ ポータルについて理解します。 | キャプティブ ポータルは、新しく接続したクライアントを Web ベースのポータル アクセス制御ページにリダイレクトする認証手法です。 |
| ワイヤレス攻撃について理解する。 | 攻撃には、ウォードライビング、ワイヤレス スキャナー/クラッカー、不正アクセス ポイント、Evil Twin、分離、妨害、IV 乱用、リプレイなどがあります。 |
| CDN について理解しておいてください。 | コンテンツ配信ネットワーク (CDN) またはコンテンツ配信ネットワークは、インターネット上の多数のデータ センターに展開されるリソース サービスのコレクションであり、ホストされたコンテンツの低遅延、高パフォーマンス、高可用性を実現します。 |
| NACについて理解しましょう。| ネットワークアクセス制御（NAC）とは、セキュリティポリシーを厳格に遵守し、適用することで環境へのアクセスを制御するという概念です。802.1X、事前認証、事後認証、エージェントベース、エージェントレスについて理解しましょう。|
| ファイアウォールの様々な種類を理解しましょう。 | ファイアウォールには、静的パケットフィルタリング、アプリケーションレベル、回線レベル、ステートフルインスペクション、NGFW、ISFWなど、様々な種類があります。また、仮想ファイアウォール、フィルター／ルール／ACL／タプル、要塞ホスト、イングレス、エグレス、RTBH、ステートレスとステートフル、WAF、SWG、TCPラッパー、DPI、コンテンツフィルタリングとURLフィルタリングについても理解しましょう。 |
| プロキシについて理解しましょう。 | プロキシサーバーは、クライアントとサーバー間の仲介として使用されます。プロキシは、プライベートネットワーク上のクライアントに、クライアントのIDを保護しながらインターネットアクセスを提供するという文脈で最もよく使用されます。フォワード、リバース、透過、非透過について理解しましょう。 |
| エンドポイント セキュリティについて理解します。 | エンドポイント セキュリティとは、ネットワークや通信チャネルがセキュリティを提供しているかどうかにかかわらず、各デバイスがローカル セキュリティを維持する必要があるという概念です。エンドポイント検出および対応 (EDR) は、ファイアウォール、侵入検知システム (IDS)、マルウェア対策を組み合わせたものです。マネージド検出および対応 (MDR) は、EDR とセキュリティ情報イベント管理 (SIEM)、ネットワーク トラフィック分析 (NTA)、ネットワーク IDS を組み合わせたものです。エンドポイント保護プラットフォーム (EPP) は、EDR の侵入防止システム (IPS) の一種です。拡張検出および対応 (XDR) は、EDR、MDR、EPP を組み合わせたもので、多くの場合、クラウドベースのリモート監視および分析が組み合わされています。 |
| 一般的なLANテクノロジーについて理解しておきましょう。 | 最も一般的なLANテクノロジーはイーサネットです。また、アナログ通信とデジタル通信、同期通信と非同期通信、デュプレックス、ベースバンド通信とブロードバンド通信、ブロードキャスト、マルチキャスト、ユニキャスト、エニーキャスト、ジオキャスト通信、CSMA、CSMA/CD、CSMA/CA、トークンパッシング、ポーリングについても理解しておきましょう。 |

## OSIモデル
開放型システム間相互接続（OSI）参照モデルは、通信システムやコンピューティングシステムの機能を、その基盤となる内部構造に関係なく標準化する**7層の概念フレームワーク**です。プロトコル、ハードウェア、セキュリティ制御を特定の層にマッピングすることで、セキュリティ専門家は**脆弱性を特定**🔍し、適切な対策を講じることができます。

### OSIモデルの歴史
* **1970～1973** — DARPA が **TCP/IP (ARPANET) モデル** を開発し、大規模なパケット スイッチングを実現しました。  
* **1970 年代後半** — **国際標準化機構 (ISO)** が相互運用性を確保するためにベンダー中立モデルの作業を開始しました。  
* **1984** — ISO が **ISO 7498** を発行し、7 層の OSI モデルを正式に定義しました。  
* 実際には TCP/IP に取って代わることはありませんでしたが、OSI モデルは、ネットワーク設計、診断、およびセキュリティに関する **普遍的な教育およびトラブルシューティングのリファレンス** になりました。

### OSI機能
* **垂直抽象化:** 各レイヤーは上位レイヤーに _サービス_ を提供し、下位レイヤーからの _サービス_ に依存します。  
* **ピア層通信:** 論理的な会話は、異なるホスト上の一致する層間で **水平に** 発生します (例: トランスポート ↔ トランスポート)。  
* **モジュール性:** 設計者は、スタック全体を書き換えることなく、1 つのレイヤーをアップグレードまたは保護できます (例: レイヤー 4 に TLS を追加する)。  
* **ベンダー中立性:** インターフェイスはオープン スタンダードによって定義されており、複数のベンダーの機器の相互運用が可能になります。

### カプセル化/非カプセル化
| フェーズ | アクション | 結果のプロトコル データ ユニット (PDU) | セキュリティに関する考慮事項 |
|-------|--------|-------------------------------------|-------------------------|
| **カプセル化 ↓** | 各層は、上位層からのペイロードに **ヘッダー** (場合によってはフッター) を追加します。 | ビット → フレーム → パケット → セグメント/データグラム → PDU | ヘッダーからメタデータ (IP アドレスなど) が明らかになる場合があります 🎯。機密性が必要な場合は暗号化またはトンネリングします。 |
| **送信 ↔** | 物理メディア (銅線、光ファイバー、RF) が **ビット ストリーム** を伝送します。 | ビット | 物理的な攻撃 (盗聴、EMI) には、シールド、TEMPEST、光ファイバー、またはリンク暗号化が必要です。 |
| **カプセル化解除 ↑** | 各層は**自身のヘッダー/フッターを削除**し、ペイロードを渡します。 | PDU の順序を逆にします | 整合性チェック (CRC、チェックサム、MAC) により、転送中にデータが変更されていないことを確認します。 |

> :memo: **ニーモニック**  
> 「すべての人にデータ処理が必要だとわかっている」（上→下）  
> 「ソーセージピザを道に投げないでください」（下→上）

### OSIレイヤー
以下は「1ページ」の参照表です。試験に備えてしっかり覚えておきましょう。

| # | レイヤー | PDU 名 | 主な役割 | プロトコル/技術の例 | ここで一般的に動作するデバイス | セキュリティの焦点 |
|---|--------|----------|-----------|-----------|---------------------------------|----------------|
| 7 | **アプリケーション** | PDU | ユーザー アプリとサービス (HTTP、FTP) のインターフェイス。 | HTTP、SMTP、SNMP、SSH | プロキシ、DLP ゲートウェイ | 入力検証、認証、アプリ ファイアウォール |
| 6 | **プレゼンテーション** | PDU | 構文/形式の変換、**暗号化**、圧縮。 | TLS/SSL、ASN.1、MIME | SSL アクセラレータ | 暗号の選択、キー管理、データサニタイズ |
| 5 | **セッション** | PDU | **セッション**の構築、維持、終了、ダイアログ制御 (単方向/半二重/全二重)。 | NetBIOS、RPC、PPTP 制御 | セッション ボーダー コントローラー | トークン/セッション ハイジャック防止、タイムアウト ポリシー |
| 4 | **トランスポート** | **セグメント** (TCP) / **データグラム** (UDP) | エンドツーエンドの信頼性、フロー/エラー制御、**ポート**。 | TCP、UDP、TLS、QUIC | ファイアウォール、ロードバランサー | ポートフィルタリング、ステートフルインスペクション、DoS緩和 |
| 3 | **ネットワーク** | **パケット** | 論理アドレス指定 (**IP**)、ルーティング、フラグメンテーション。 | IPv4/IPv6、ICMP、IPsec、OSPF | ルーター、レイヤー 3 スイッチ | ACL、ルート認証、スプーフィング対策 |
| 2 | **データ リンク** | **フレーム** | MAC アドレス指定、LAN スイッチング、CRC、VLAN。 | イーサネット (802.3)、ARP、PPP、STP | スイッチ、ブリッジ、NIC | ポート セキュリティ、STP ガード、MAC フィルタリング |
| 1 | **物理** | **ビット** | 信号、電圧、ケーブル、無線、光学 | UTP、ファイバー、802.11 RF、DSL | ハブ、リピーター、メディアコンバーター | ケーブルロック、シールド、TEMPEST、CCTV |

#### 主要なレイヤー固有の注意事項
* **レイヤー7 – アプリケーション**  
  * ここで扱うのは_プロトコル_であり、**アプリ自体ではありません**。例：ブラウザ（ソフトウェア）はHTTP/HTTPS（レイヤー7プロトコル）を使用します。  
  * 一般的な攻撃: XSS、CSRF、SQLi - 安全なコーディング、WAF、コンテンツ セキュリティ ポリシー (CSP) を適用します。

* **レイヤー6 – プレゼンテーション**  
  * **シリアル化** (例: JSON ↔ バイナリ)、文字セット (UTF-8)、および **暗号化** を処理します🗝️。  
  * 純粋な TCP/IP では、多くのプレゼンテーション機能がアプリケーション ライブラリまたは TLS に組み込まれています。

* **レイヤー5 – セッション**  
  * 長い転送のチェックポイントを維持します (再開に便利です)。  
  * 最新の TCP スタックではセッションとトランスポートが混在していますが、試験問題では依然としてセッションとトランスポートは別個のものとして扱われます。

* **レイヤー4 – トランスポート**  
  * **TCP** = 接続指向、信頼性あり (SYN → SYN-ACK → ACK ハンドシェイク)。  
  * **UDP** = コネクションレス、ベストエフォート。VoIP/ゲームで人気があります。  
  * **TLS** はここで最も頻繁に動作します (アプリ ヘッダーを含むトランスポート ペイロード全体を暗号化します)。

* **レイヤー3 – ネットワーク**  
  * **CIDR、サブネット、ルーティング プロトコル** を実装します。  
  * ファイアウォールは、**ステートレス ACL** にパケット属性 (送信元/宛先 IP、プロトコル) を使用し、ステートフル デバイスは接続を追跡します。  
  * **ICMP** = 制御/ステータス (ping、traceroute)。マッピングとDoS攻撃を減らすためにブロックまたはレート制限を設定します。

* **レイヤー2 – データリンク**  
  * **MAC フラッディング** と **ARP スプーフィング** はスイッチの動作を悪用します。ポート セキュリティと DHCP スヌーピングで軽減します。  
  * VLAN ホッピング攻撃はトランクの誤った設定を悪用します。タグ付けポリシーを適用し、未使用のポートを無効にします。

* **レイヤー1 – 物理**  
  * 脅威には盗聴、EMI、盗聴、ハードウェアの改ざんが含まれます。  
  * 対策: **光ファイバー** ケーブル、導管、ファラデーケージ、冗長リンク、環境制御。

### クイックルック比較表: PDU、アドレス、デバイス
| OSI 層 | PDU | アドレス タイプ | 代表的なデバイス | 注目すべき攻撃例 |
|-----------|-----|--------------|-------------------------|-------------------------|
| 7～5 | (PDU) | — | リバースプロキシ、APIゲートウェイ | ヘッダーインジェクション、リプレイ |
| 4 | セグメント / データグラム | **ポート番号** | ステートフル ファイアウォール、ロード バランサー | SYN フラッド、UDP 増幅 |
| 3 | パケット | **IP アドレス** | ルーター、IPS/IDS | IP スプーフィング、BGP ハイジャック |
| 2 | フレーム | **MAC アドレス** | スイッチ、ブリッジ | ARP ポイズニング、MAC フラッディング |
| 1 | ビット | — | ハブ、リピーター | タップ、信号干渉 |

### 試験のヒント ✨
1. **セキュリティ制御をレイヤーにマッピング** — 例：WAF (7)、IPSec (3)、802.1X (2)。  
2. **PDU の名前とヘッダーを覚えておいてください**。「どのレイヤーがフレームをビットに変換しますか?」スタイルの MCQ を想定してください。  
3. **TCP と UDP の特性を区別** し、TLS が適合する場所を理解できるようになります。  
4. 一部の OSI レイヤーは TCP/IP では「欠落」している (プレゼンテーション機能とセッション機能が他の機能に吸収されている) ことを認識してください。  
5. 攻撃の追跡を練習します。**どのレイヤー**で検出/防止を行う必要があるかを特定します。

## TCP/IP モデル
**伝送制御プロトコル/インターネットプロトコル（TCP/IP）モデル**（DARPAモデルまたはDoDモデルとも呼ばれる）は、現実世界のプロトコルを**4層**（アプリケーション、トランスポート、インターネット、リンク）にマッピングします。TCP/IPは7層OSI参照モデルよりもシンプルですが、同じ機能領域をカバーしています。**試験問題はOSIとTCP/IPの名称を頻繁に切り替えるので、翻訳できるように準備しておいてください。**

| TCP/IP 層 | OSI とほぼ同等 | 主要な責任 | 代表的なプロトコル | 主要なセキュリティ上の懸念事項 |
|--------------|------------------------|------------------------|-------------------------|-----------------------|
| アプリケーション | OSI レイヤー 7-5 | ユーザー レベルのサービス、データ フォーマット、セッション管理 | HTTP/HTTPS、SMTP、DNS、SNMP、FTP、SSH | 入力検証、authN/Z、暗号化、デフォルト認証情報の強化 |
| トランスポート | OSI レイヤー 4 | エンドツーエンド接続、信頼性、ポート | **TCP、UDP、TLS、QUIC** | SYN フラッド、ポートスキャン 🔍、弱い暗号 |
| インターネット | OSI レイヤー 3 | 論理アドレス指定、ルーティング、フラグメンテーション | IPv4/IPv6、ICMP、IPsec、OSPF、BGP | IP スプーフィング、ルート ハイジャック、ICMP トンネリング |
| リンク | OSI レイヤー 2-1 | 物理シグナリング、MAC アドレス指定、フレーミング | イーサネット、Wi-Fi、PPP | ARP スプーフィング、VLAN ホッピング、盗聴 |

**セキュリティへの影響**  
* 機密性ではなく、回復力と相互運用性のために設計されているため、多くのプロトコルはデフォルトで **プレーンテキスト** になっています。  
* 一般的なスタック欠陥: バッファ オーバーフロー、シーケンス番号予測、フラグメント攻撃、サイズ超過のパケット、SYN フラッド、AitM ハイジャック。  
* 緩和策: ステートフル ファイアウォール、ヘッダー整合性チェック、IPS、TLS/IPsec、ネットワーク セグメンテーション。

**試験のヒント📝**  
「どの TCP/IP 層が <タスク> を処理するか」または「プロトコル X を OSI 層にマッピングする」を予測し、双方向マッピング テーブルを練習します。

## ネットワークトラフィックの分析
ネットワーク トラフィック分析は、**トラブルシューティング、パフォーマンス チューニング、脅威の検出** をサポートしますが、盗聴も可能にする可能性があります。

### プロトコルアナライザー（スニファー）
* NIC を **無差別モード** (宛先 MAC を無視) に設定してフレーム/パケットをキャプチャします。  
* ツールは、オープンソースの **Wireshark** からエンタープライズ プラットフォーム (NetWitness、Omnipeek、NetScout) まで多岐にわたります。  
* **キャプチャ フィルター** (保存する内容を決定) と **表示フィルター** (表示する内容を決定) を提供します。

| 機能 | 利点 | セキュリティ上の注意 |
|---------|---------|-----------------|
| 16 進数 + ASCII デコード | ビットレベルまでの詳細な検査 | 機密ペイロードの公開 👀 |
| 再構成 | 完全な TCP ストリームを表示 | 攻撃者はフラグメントを隠すことができるため、IDS も再構成できるようにする |
| 自動化されたヒューリスティック | 不正なパケット、既知の IoC を検出 | ヒューリスティックはゼロデイ手法に遅れをとっています |

**法的および倫理的考慮事項**  
トラフィックをキャプチャすると、プライバシー法や雇用主のポリシーに違反する可能性があります。書面による許可を取得し、「必要最小限のキャプチャ」の原則に従ってください。

**試験のヒント📝**  
**スニファー**（生データキャプチャ）と**プロトコルアナライザ**（デコード/解釈）の違いを理解しましょう。プロミスキャスモードとモニターモード、そしてフィルターの種類に関する質問が予想されます。

## 共通アプリケーション層プロトコル
アプリケーション層プロトコルはTCP、UDP、またはその両方で実行されます。**デフォルトポート、安全な代替ポート、主なリスク**を覚えておきましょう。

| プロトコル | デフォルト ポート | 目的 | 安全な代替手段 / 強化 | 一般的なリスク |
|----------|-----------------|---------|--------------------------------|---------------|
| Telnet | TCP 23 | リモート CLI | **SSH** (TCP 22) | プレーンテキスト認証情報、AitM |
| FTP | TCP 21 (制御)、20/一時 (データ) | ファイル転送 | **SFTP (SSH)** または **FTPS (TLS)** | クリアテキスト、バウンス攻撃 |
| TFTP | UDP 69 | シンプルなファイル転送（認証なし） | VPN で回避またはトンネリング | 設定の盗難、マルウェアのドロップ |
| SMTP | TCP 25 | 電子メールリレー | **SMTPS (STARTTLS 587 / 465)** | スプーフィング、ヘッダーインジェクション |
| POP3 | TCP 110 | メールのプル、ローカル ストレージ | **POPS (995)** | クリアテキスト クレデンシャル |
| IMAP4 | TCP 143 | メールの取得、サーバー ストレージ | **IMAPS (993)** | 資格情報の盗難 |
| DHCP | UDP 67/68 | 動的 IP 構成 | DHCP スヌーピング、MAC バインディング | 不正サーバー、枯渇 |
| HTTP | TCP 80 | Web コンテンツ | **HTTPS (443)** | セッション ハイジャック、XSS |
| HTTPS | TCP 443 | TLS で保護された HTTP | 強化された暗号、HSTS | 弱い TLS バージョン |
| LPD | TCP 515 | 印刷スプール | IPsec/VPN の使用 | ジョブ操作 |
| X ウィンドウ | TCP 6000-6063 | リモート GUI | VPN、SSH -X | キーストローク スヌープ |
| NFS | TCP 2049 | ファイル共有 | NFSv4 + Kerberos | UID スプーフィング、クリアテキスト |
| SNMP | UDP 161/162 | ネットワーク管理 | **SNMPv3** (認証+暗号化) | コミュニティ文字列ブルートフォース |

**試験のヒント📝**  
ポート番号と安全な代替ポートは、頻繁にテストされる項目です。フラッシュカードに記録しておきましょう。多くの「レガシー」プロトコルは、コンプライアンスのためにSSH、TLS、またはVPNトンネルでラップする必要があることを認識しておきましょう。

## トランスポート層プロトコル
トランスポート層メカニズムは、ポートを介して**多重化、信頼性、および接続管理**を提供します。

### ポート範囲
* **Well-Known / サービス ポート 0-1023** — サーバー用に予約済み (例: 80 HTTP)。  
* **登録済み 1024-49 151** — ベンダー登録アプリ。  
* **動的/一時的 49 152-65 535** — クライアント ソース ポート。OS は 1023 より大きい値を使用する場合があります。

*ソケット* = **IP アドレス + ポート**; 1 つのホスト上で複数のセッションを可能にします。

### TCP と UDP

| 機能 | TCP | UDP |
|---------|-----|-----|
| タイプ | コネクション指向、信頼性 | コネクションレス、ベストエフォート |
| ハンドシェイク | 3 ウェイ (SYN → SYN/ACK → ACK) | なし |
| 確認応答 | はい (ウィンドウごとに) | オプションのチェックサムのみ |
| シーケンスと並べ替え | 組み込み | なし |
| オーバーヘッド | 高い 📦 | 最小限 |
| ユースケース | ファイル転送、Web、メール | VoIP、ストリーミング、DNS |
| ティアダウン | FIN/ACK 正常または RST 突然 | 正式なティアダウンなし |
| 一般的な攻撃 | SYN フラッド、セッション ハイジャック、RST スプーフィング | UDP フラッド、増幅 |

> **FIN vs. RST**  
> *FIN* = 正常終了、*RST* = 即時中止 - RST ストームを使用してセッションを強制的にドロップできます。

### 追加のトランスポート層プロトコル
* **TLS (トランスポート層セキュリティ)** — セグメントを暗号化し、暗号スイートをネゴシエートし、整合性とオプションのクライアント認証を提供します。  
* **QUIC** — HTTP/3 で使用される、ハンドシェイクを高速化するために TLS 1.3 + UDP を組み合わせた Google プロトコル。  
* **SCTP** — ストリーム制御伝送プロトコル。マルチホーミングとマルチストリーミングをサポートします。ニッチですが試験に値します。

### 信頼性とフロー制御
* **スライディング ウィンドウ** は ACK フィードバックに基づいてセグメント数を調整します。  
* **輻輳制御** (スロースタート、AIMD) はネットワークの崩壊を防ぎます。高度な質問についてはアルゴリズムを学習してください。

**試験のヒント📝**  
シナリオでは、要件に応じてTCPとUDPのどちらを選択すべきかを問う質問が想定されます（例：「ミッションクリティカルなデータベース同期」→TCP、「VoIP通話」→UDP）。3ウェイハンドシェイクのフラグ順序とFINとRSTの動作を記憶しておきましょう。

### クイックリファレンスチートシート
| 暗記すべきトピック | ワンライナー |
|-------------------|------------|
| TCP/IP ↔ OSI マッピング | アプリケーション ↔ 7-5、トランスポート ↔ 4、インターネット ↔ 3、リンク ↔ 2-1 |
| ポート範囲 | 0 ～ 1023 は既知、1024 ～ 49151 は登録済み、49152 ～ 65535 は一時的 |
| TCP ハンドシェイク フラグ | SYN → SYN/ACK → ACK |
| 安全な代替 | Telnet → SSH、FTP → SFTP/FTPS、SNMPv1/v2 → SNMPv3 |
| スニファーとアナライザー | スニファーはキャプチャし、アナライザーはデコード/解釈します |

### 期末試験のポイント
* すべての**セキュリティ制御**をそのレイヤーにリンクします: TLS (トランスポート)、IPsec (インターネット)、MAC フィルタリング (リンク)。  
* **パケットフローをデコード**できるようになります。「クライアントがSYNを送信し、サーバーがSYN/ACKを応答します…」次のステップを特定します。  
* **誤った構成** (例: オープン SNMP コミュニティ、匿名 FTP) が実際の攻撃にどのように影響するかを理解します。  
* **Wireshark キャプチャ フィルター** (`tcp.port == 443`) とディスプレイ フィルター (`ip.addr == 10.0.0.5`) を練習します。これらの用語は試験に出ます。

## ドメインネームシステム
DNSは**人間が読める名前**をIPアドレスに変換し、事実上すべてのTCP/IP接続の基盤となっています。DNSの階層構造と攻撃対象領域を理解することは、CISSPの取得に不可欠です。

### DNSポイズニング
* **目標**: ユーザーが攻撃者が管理するホストにアクセスできるように、偽の名前から IP へのデータを挿入します。
* **ベクター**
  * **不正な DNS サーバー** は、16 ビットの *クエリ ID (QID)* に一致して、正規のサーバーよりも速く応答します。
  * **キャッシュ ポイズニング** は再帰リゾルバに偽のレコードを挿入し、TTL の有効期限が切れるまで持続します。
  * **hosts ファイルの改ざん** により、ローカル マッピングが上書きされます (標的が絞られます)。
  * **DHCP オプション スプーフィング** により、クライアントは悪意のあるリゾルバを使用するようになります。
  * **ファーミング**: 汚染されたキャッシュまたはホスト ファイルによる大量リダイレクト。
* **防御**
  * **DNSSEC** 🔑—ゾーン データに署名し、クライアントが署名を検証します。
  * **DNS を分割** - 内部ゾーンと外部ゾーンを分離し、着信 UDP/TCP 53 をブロックします。
  * 厳密なゾーン転送 ACL。信頼できない IP への AXFR を無効にします。
  * **DoH / ODoH** はクライアントのクエリを暗号化し、匿名化します。
  * NIDS を展開して、異常な TTL、QID スプレー、管轄外の回答にフラグを立てます。

### ドメインハイジャック
* **攻撃**: ドメインのレジストラレコードの不正変更。不正な手法としては、盗難された認証情報、XSRF、レジストラの脆弱性攻撃、ログイン時の中間者攻撃などが挙げられます。
* **影響**: ブランドの損害、資格情報の収集、マルウェアのホスティング。
* **緩和策**
  * レジストラ MFA + ハードウェア トークン。
  * レジストリ **EPP ロック** (clientTransferProhibited、serverUpdateProhibited)。
  * 確認済みの支払い元で自動更新されます。
  * WHOIS / RDAP の変更を監視し、DNSSEC DS レコードを設定します。

> **ホモグラフ攻撃** は、類似したUnicode文字を利用して、偽のIDN（例：раypal.com）を登録します。ブラウザのPunycode表示ツールとフィッシング対策ツールを使用してください。

## インターネットプロトコル（IP）ネットワーク

### IPv4 と IPv6

| 機能 | IPv4 | IPv6 |
|---------|------|------|
| アドレス サイズ | 32 ビット | **128 ビット** |
| 表記 | ドット付き 10 進数 (192.0.2.1) | 16 進数/カルテット (2001:db8::1) |
| 総アドレス数 | ≈43億 | 3.4 × 10³⁸ (事実上無尽蔵) |
| 組み込みセキュリティ | アドオン IPsec | IPsec 必須 |
| 構成 | DHCP / 手動 | SLAAC、DHCPv6 (ステートフル/ステートレス) |
| QoS | DiffServ/DSCP (ほとんど使用されない) | フロー ラベル + DSCP |
| 移行 | デュアルスタック、トンネリング、NAT-PT | N/A |
| ループバック | 127.0.0.1 | ::1/128 |

*セキュリティの落とし穴*: フィルタリングされていないデュアル スタックは秘密のチャネルを開きます。有効にする前に、ファイアウォール、IDS、ログ ツールが IPv6 を解析していることを確認してください。

### IP クラス (レガシー IPv4)
| クラス | 最初のオクテットの範囲 | デフォルトのマスク | 一般的なホスト | 注記 |
|-------|------------------|--------------|---------------|-------|
| A | 1–126 | 255.0.0.0 (/8) | 16 M | 127.xxx = ループバック |
| B | 128–191 | 255.255.0.0 (/16) | 65 K | 169.254.xx = 新規 |
| C | 192–223 | 255.255.255.0 (/24) | 254 | 192.168.0.0/16 プライベート |
| D | 224～239 | 該当なし | マルチキャスト | IGMP 参加 |
| E | 240～255 | n/a | 実験的 | まれにルーティングされる |

現代のネットワークでは、**CIDR / VLSM** を使用して、クラス ルールを超えた可変長サブネットを切り分けます。

### ICMP
* **目的**: ヘルスチェック、診断 (ping、traceroute)、エラー メッセージ (例: タイプ 3 宛先到達不能)。
* **セキュリティ上の問題**
  * 帯域幅 DoS (スマーフィ、ping フラッド)、*ping of death*。
  * 偵察: TTL と応答コードによる OS フィンガープリンティング。
* **強化**
  * 信頼できないゾーンからのエコー要求をレート制限またはドロップします。
  * プロファイリングを減らすために、送信タイプ 13 タイムスタンプをブロックします。

### IGMP
* ホストが **マルチキャスト グループに参加/離脱** できるようにします (クラス D 224.0.0.0/4)。
* バージョン: IGMPv2 (Leave メッセージ)、IGMPv3 (ソース固有のマルチキャスト)。
* セキュリティ: スイッチ/ルーターで不要なマルチキャストをフィルタリングします。必要がない場合は IGMP スヌーピングを無効にします。

### クイックリファレンス

| プロトコル | OSI レイヤー | ポート / ICMP タイプ | 主な試験ポイント |
|----------|-----------|---------------------|-----------------|
| DNS | 7-5 | UDP/TCP 53 | キャッシュポイズニング、DNSSEC、分割DNS |
| ICMP | 3 | N/A (プロトコル 1) | エコー、時間超過、到達不能コード |
| IGMP | 3 | N/A (プロトコル 2) | マルチキャスト参加/離脱、ルーターに依存 |
| IPv6 | 3 | N/A | 128 ビット、SLAAC、必須 IPsec |

### 試験の洞察
* **DNS レコード タイプ** (A、AAAA、PTR、MX、CNAME、SOA、NS) を記憶します。
* **TTL とホップ制限** の違いを理解する (IPv4 と IPv6)。
* **DNSSEC vs. DoH** とキャッシュポイズニングに対する防御に関するシナリオの質問が予想されます。
* **CIDR サブネット** を計算し、指定されたホスト数に対して正しいマスクを識別できるようになります。
* 一般的な **ICMP 攻撃シグネチャ** と推奨されるルーター ACL を認識します。

## ARPに関する懸念
アドレス解決プロトコルは、IPv4 **論理アドレス (IP)** ➜ **物理アドレス (MAC)** をマッピングします。  
ARP 要求/応答は *認証されていないブロードキャスト* (EtherType 0x0806) であるため、悪用される可能性があります。

### 攻撃対象領域
| テクニック | 仕組み | 影響 | 検出/軽減 |
|-----------|--------------|--------|------------------------|
| **ARP キャッシュ ポイズニング / スプーフィング** | 攻撃者は偽造された MAC ↔ IP バインディングで応答し、被害者はキャッシュを上書きします。 | トラフィックの迂回 → MitM 🕵️、セッション ハイジャック、DoS。 | スイッチの **ポート セキュリティ**、動的 ARP 検査、`arpwatch`、ホスト ファイアウォールによる迷惑応答のブロック。 |
| **Gratuitous ARP の悪用** | 偽の一方的な ARP 更新が定期的に送信されます。 | ブロードキャスト クエリのない永続的なスプーフィング。 | 上記と同じです。過剰な Gratuitous ARP を監視します。 |
| **静的エントリの上書き** | 悪意のあるスクリプトが非永続的な静的エントリを挿入します。 | 再起動するまでルートを誤らせます。 | エンドポイントを強化し、管理スクリプトを許可リストに登録し、GPO を踏みつけます。 |

> **試験のヒント** — 覚えておいてください: ARP は **OSI レイヤー 2** にあり、イーサネット フレームで IP + MAC を伝送します。ポイズニング対策は主に *スイッチ* 機能に属します。

## 安全な通信プロトコル
これらのプロトコルは、盗聴や改ざんを防ぐために、通常のトラフィックを **暗号化 + 整合性** サービスでラップします。

| プロトコル | レイヤー | 目的 | コア暗号 | 注記 |
|----------|--------|----------|----------|--------|
| **IPsec** | 3 | サイト間またはホスト VPN | AH (認証) および ESP (暗号化/認証) | *トランスポート* モードと *トンネル* モード; IPv6 ネイティブ。 |
| **TLS** | 4 (encaps squeeze) | 任意の TCP/UDP アプリ (HTTPS、SMTPS、SIP) を暗号化 | X.509 + 対称 | SSL に取って代わり、相互認証をサポートします。 |
| **SSH** | 7→5 | セキュアなリモート シェル、ポート転送、SFTP | KEX + 対称 + MAC | 軽量のホスト間 VPN として機能します。 |
| **Kerberos** | 5 | レルム内の SSO と相互認証 | 対称チケット、TGT 🗝️ | 時間同期に依存し、資格情報の再生を軽減します。 |
| **Signal プロトコル** | 7 | エンドツーエンドの音声 / テキスト | ダブルラチェット + X3DH | 完全な前方秘匿性。WhatsApp、Signal で使用されます。 |
| **S-RPC** | 7 | リモート プロシージャの AuthN | デジタル署名 | 従来の NFS 環境以外ではほとんど使用されません。 |

## 多層プロトコルの影響
TCP/IP の **カプセル化** により、プロトコルの内部に他のプロトコルをスタックすることが可能になり、柔軟性と隠れたリスクが生まれます。

＃＃＃ 利点
* サービスの組み合わせ (例: HTTPS over IPsec over Ethernet)。
* 1 つまたは複数のレイヤーで暗号化を挿入します。
* トランスポート層の障害に対する耐性があります。

### 欠点
* **秘密チャネル** は禁止されたアプリをトンネリングできます (FTP-in-HTTP、Loki ICMP トンネル)。
* セキュリティアプライアンスは外側のヘッダーのみを検査する場合があります ➜ **フィルターバイパス**。
* 境界を越えた VLAN タグホッピングまたはプロトコルの混乱。

### 統合プロトコル
特殊なトラフィックを一般的な Ethernet/IP に統合します。

| 例 | カプセル化されるもの | ユースケース | セキュリティに関する注意事項 |
|---------|----------------------|----------|---------------|
| **SAN / iSCSI** | TCP での SCSI コマンド | LAN/WAN 経由のストレージ | イニシエーターを認証し、VLAN / VRF で分離します。 |
| **InfiniBand over Ethernet (IBoE)** | Ethernet 内の InfiniBand フレーム | HPC クラスター | Lossless Ethernet (DCB) が必要です。 |
| **Compute Express Link (CXL)** | 共有メモリ / コヒーレンス | CPU ⇄ アクセラレータ相互接続 | まだ発展途上 - ファームウェアの更新に注意してください。 |

### ボイスオーバーインターネットプロトコル（VoIP）
* オーディオ (RTP/SRTP) + コールセットアップ (SIP/H.323) を IP パケットにカプセル化します。  
* 攻撃: *ヴィッシング*、SPIT、発信者 ID スプーフィング、コール マネージャーに対する DoS、VLAN ホッピング。  
* **セキュア RTP (SRTP)** はオーディオに AES + HMAC を追加します。TLS で保護された SIP と共に展開します。
* VoIP のセッション初期化プロトコルの安全なバージョンである **SIPS** は、セッション初期化プロセスを安全に保つために TLS 暗号化を追加します。

### ソフトウェア定義ネットワーク (SDN)
* **コントロール プレーン* (決定) を *データ プレーン* (転送) から分離します。  
* 中央 **コントローラ** は、サウスバウンド API (OpenFlow など) を介してコモディティ スイッチをプログラムし、ノースバウンド REST API をアプリに公開します。  
* パートナーのコンセプト: **NFV** は、ファイアウォール、ロードバランサー、IDS を VM/コンテナとして仮想化します。

| 利点 | リスク |
|---------|------|
| ベンダー中立性、即時パス更新、きめ細かなマイクロセグメンテーション 🚀 | コントローラー = 単一侵害ポイント、AAA、TLS、ロールベースの API が必要 |

## セグメンテーション
ネットワークを分割するとパフォーマンスが向上し、爆発半径が制限されます。

### メソッド
| タイプ | 実装方法 | 主な目的 |
|------|-----------------|------------|
| **物理的** | ケーブル、スイッチ、*エアギャップ*を分離 | 絶対的な分離 🔐 |
| **インバンド (論理)** | 共有インフラ + VLAN、VPN | トラフィックの分離、より簡単な運用 |
| **帯域外** | 管理ネットワーク、IPMI | 制御トラフィックの保護 |
| **マイクロセグメンテーション** | 分散ファイアウォール、VXLAN、SDN | ワークロードごとのポリシー、ゼロトラストの調整 |

| テクノロジー | 主な目的 | 分離の範囲 | 一般的な展開/ユースケース | 主なセキュリティ上の利点 | 注意事項と制限事項 |
|------------|-----------------|-----------------|------------------------------|----------------------|---------------------|
| **VLAN** (仮想ローカル エリア ネットワーク) | スイッチ上で論理的に分離されたレイヤー 2 ブロードキャスト ドメイン | 部門、フロア、または機能グループ | エンタープライズ キャンパス ネットワーク、VoIP とデータの分離 | ブロードキャスト トラフィックを制限、追加のハードウェアなしで基本的なセグメンテーションを実現 | VLAN 間ルーティングにはレイヤー 3 デバイスが必要、誤って構成された場合は VLAN ホッピング攻撃を受ける |
| **VPN** (仮想プライベート ネットワーク) | 信頼できないネットワーク上に暗号化されたトンネルを作成 | ユーザー対サイトまたはサイト対サイト | 在宅勤務者のリモート アクセス、ブランチ オフィス接続 | インターネット全体の機密性と整合性 | 遅延が発生し、エンドポイントのセキュリティ構成に依存 |
| **VRF** (仮想ルーティングおよび転送) | 1 台のルータで複数の独立したルーティング テーブルを維持 | 顧客、テナント、またはサービス インスタンス | サービス プロバイダー MPLS バックボーン、重複する IP 範囲を持つ大企業 | ルート漏洩を防止、テナントごとのトラフィック分離 | レイヤー 3 のみで動作、ACL/QoS と組み合わせない限り物理インターフェイスは共有されます |
| **VDOM** (仮想ドメイン) / 仮想システム | ファイアウォール/スイッチを複数の論理デバイスに仮想化 | 事業部門または顧客 | テナントごとのポリシー セットを提供する次世代ファイアウォール | ドメインごとに専用のルール ベースとログ、強力な管理者分離 | 物理リソースを消費します。コンテキスト間の構成ミスによりギャップが生じる可能性があります |
| **VPC** (仮想プライベート クラウド) | パブリック クラウド内で分離されたソフトウェア定義ネットワークを提供 | クラウド テナント ネットワーク全体 | AWS VPC、Azure VNet - 多層アプリケーション ホスティング | サブネット レベルの ACL、セキュリティ グループ、ルート テーブルはテナント制御 | プロバイダーの共有ファブリック上に常駐。出力フィルタリングは多くの場合追加 |
| **マイクロセグメンテーション** | きめ細かなワークロードレベルの分離 (ゼロトラスト) | 単一の VM、コンテナ、またはエンドポイント | ソフトウェア定義オーバーレイ (例: VMware NSX、Kubernetes ネットワーク ポリシー) | East-West トラフィック フィルタリング、ワークロード粒度での最小権限 🔐 | ポリシーの拡散リスク、自動化および可視化ツールへの依存度が高い |

## エッジネットワーク
コンピューティング/ストレージを**ユーザーまたはセンサーの近くに**移動して、レイテンシを削減します。

| コンセプト | 説明 | セキュリティの焦点 |
|---------|--------------|----------------|
| **エッジイングレス** | 外部データがエッジクラスターに入るポイント | DDoS フィルタリング、TLS オフロード |
| **エッジ出力** | インターネットまたはコアへの送信パス | データ損失防止、ルート検証 |
| **エッジ ピアリング** | エッジ間の直接トラフィック交換 | 相互 BGP フィルター、脅威情報の共有 |

エッジ + CDN + 5G = 超低レイテンシアプリ（AR/VR、自動運転車）。コントローラーAPIを保護し、広範囲に展開されたエッジノードへの一貫したパッチ適用を実現します。

### CDN が実現するもの  
**コンテンツ配信ネットワーク（CDN）**は、画像、動画セグメント、CSS/JSファイルといった静的アセットを世界中のキャッシュノード群に複製し、地理的に最も近いノードからユーザーリクエストに応答します。これにより、ラウンドトリップ時間が短縮され、オリジンの帯域幅とCPU負荷が軽減され、トラフィック急増時にオリジンが保護されます。その結果、ページの読み込み速度が速くなり、動画ストリーミングがスムーズになり、エグレスコストが削減されます。

### エッジサービスが実現するもの  
**エッジサービス** は、CDN キャッシュと同じ Point of Presence (PoP) でコンピューティング機能とセキュリティ機能を実行することで、単なるキャッシュ機能の枠を超えています。サーバーレスコード (Lambda@Edge など)、リアルタイム分析、WAF/DDoS フィルタリング、ゼロトラストプロキシは、エンドユーザーから数ミリ秒単位で実行され、超低レイテンシの IoT 制御、パーソナライズされたコンテンツ、データ主権コンプライアンス、クラウドコアへのトラフィック削減を実現します。しかも、堅牢なセキュリティは維持されます。

### エッジピアリングの成果  
**エッジピアリング**は、企業のオンプレミスネットワーク（またはISPバックボーン）とクラウドプロバイダーのエッジPoP（PoP）間に、インターネットエクスチェンジ（IX）または専用回線を介して直接、多くの場合プライベートな接続を構築します。これにより、混雑したパブリックインターネットセグメントを迂回する最短経路の高帯域幅ルートが提供され、レイテンシがさらに短縮され、大容量転送のスループットが保証され、クラウドからの送信料金が削減され、ルートの可視性とセキュリティが向上します。

### エッジサービスと CDN の違い

| アスペクト | **エッジ サービス (エッジ コンピューティング)** | **CDN (コンテンツ配信ネットワーク)** |
|--------|-------------------------------------|------------------------------------|
| **主な目標** | **処理、セキュリティ、分析** をユーザー/デバイスの近くで実行し、超低レイテンシを実現します。 | オリジンをオフロードしながら、**静的コンテンツをキャッシュして配信** します。 |
| **一般的な機能** | • サーバーレス関数 (Lambda@Edge、Cloudflare Workers) <br>• API オフロードとレート制限 <br>• AI/ML 推論、IoT データ準備 <br>• ゼロトラスト/SASE プロキシ、エッジ WAF | • 静的オブジェクト キャッシュ (画像、CSS/JS、ビデオ セグメント) <br>• HTTP/2 および TLS 終了 <br>• オリジン フェイルオーバーとリクエストの折りたたみ |
| **データ タイプ** | 動的またはリアルタイムのデータ ストリーム、API 呼び出し、センサー フィード | 主にキャッシュ可能な **静的** ファイルとメディア |
| **レイテンシ目標** | 10～50 ミリ秒未満 (5G/IoT の場合は 1 ミリ秒未満になる場合もあります) | ユーザーの距離に応じて数十～数百ミリ秒 |
| **代表的なサービス** | AWS Lambda@Edge、Azure Front Door ルール エンジン、Google Distributed Cloud Edge、Cloudflare Workers | AWS CloudFront、Azure CDN、Google Cloud CDN、Akamai、Fastly |
| **補助機能** | • エッジ WAF / DDoS 軽減 <br>• 相互認証による TLS 終了 <br>• データ主権処理ゾーン <br>• ローカル AI/分析 | • 地理的ルーティングと負荷分散 <br>• Gzip/Brotli 圧縮 <br>• 署名付き URL / トークン認証 |
| **主な利点** | • インタラクティブなワークロードに対するミリ秒単位の応答 <br>• オリジン/クラウド コアからコンピューティングをオフロード <br>• データ所在地法に準拠 <br>• ゼロトラスト アーキテクチャに不可欠 | • 大幅な帯域幅の節約とオリジンの保護 <br>• 導入が簡単 (DNS 変更) <br>• グローバル コンテンツの高速化 |
| **一般的な使用例** | リアルタイム IoT 制御、AR/VR レンダリング、パーソナライズされた API 応答、インライン データ サニタイズ | ビデオ ストリーミング、大規模な Web サイト アセットの配信、ソフトウェア アップデートの配布 |
| **関係** | 多くの場合**統合**されており、エッジ PoP はコンピューティングと CDN の両方の機能を実行します。 | キャッシュ レイヤーとして機能し、動的ロジックのためにエッジ コンピューティングで拡張できます。 |

### クイックルックチートシート
| トピック | 覚えておくべきワンライナー |
|-------|----------------------|
| ARP 攻撃 | **レイヤー 2**; ポート セキュリティまたは DAI で停止します。 |
| IPsec モード | *トランスポート* = ペイロードを暗号化します。 *トンネル* = IP 全体を暗号化します。 |
| TLS ハンドシェイク | ClientHello → ServerHello → 証明書 → キー交換 → 完了。 |
| SDN 方向 | **サウスバウンド** = コントローラー → スイッチ; **ノースバウンド** = コントローラー → アプリ。 |
| VXLAN | レイヤー 2 フレームを UDP でカプセル化してレイヤー 3 にまたがります。 |

## ワイヤレスネットワーク
Wi-Fi (IEEE 802.11) は「無制限」な接続を可能にしますが、RF 傍受、不正アクセスポイント、RF 妨害によって攻撃対象領域が拡大します。導入スタイルには、**アドホック/Wi-Fi Direct** (ピアツーピア) と **インフラストラクチャ** (AP 中心) の 2 種類があります。インフラストラクチャは、スタンドアロン、有線拡張、エンタープライズ拡張 (ESSID ローミング)、ブリッジのいずれかを選択できます。AP のフォームファクタは、**ファット (スタンドアロン)** と **シン (コントローラ管理)** です。

| 修正 | Wi-Fi Gen | 最大速度* | バンド | 主な機能 |
|-----------|------------|-----------|-----------|------------|
| 802.11 | — | 2 Mb/s | 2.4 GHz | オリジナル DSSS/FHSS |
| 802.11b | Wi-Fi 1 | 11 Mb/s | 2.4 GHz | DSSS (CCK) |
| 802.11a | Wi-Fi 2 | 54 Mb/s | 5 GHz | OFDM |
| 802.11g | Wi-Fi 3 | 54 Mb/s | 2.4 GHz | OFDM + レガシー互換 |
| 802.11n | Wi-Fi 4 | 600 Mb/s | 2.4 / 5 GHz | MIMO |
| 802.11ac | Wi-Fi5 | 3.5Gb/秒 | 5GHz | MU-MIMO、80/160 MHz |
| 802.11ax | Wi-Fi 6/6E | 9.6Gb/秒 | 1～7,125GHz | OFDMA、TWT |
| 802.11be | Wi-Fi 7 | 40 Gb/s | 1-7.25 GHz | 320 MHz、4096-QAM |
\*理論上のPHYレートであり、スループットではありません。

### SSIDのセキュリティ保護
* **デフォルトの SSID** を識別しない文字列に変更します。
* **ビーコンを無効** にするのは不明瞭化のためだけです。SSID はデータ フレームに引き続き表示されます。
* 強力なパスフレーズまたは 802.1X で **WPA2/WPA3** を使用します。SSID を非表示にすることはセキュリティにはなりません。

### 無線チャンネル
* 2.4 GHz: 22 MHz 幅のチャネル。重複をなくすには **1/6/11** (US) を選択します。
* 5 GHz: 20 MHz 間隔、チャネルは重複しません - 40/80/160 MHz に結合します。
* 6 GHz (Wi-Fi 6E): 連続した 1.2 GHz スペクトル → 7 つの 160 MHz チャネル。
* 配置ルール: CCI を削減するために、重複しないチャネルで隣接する AP をずらします。

### サイト調査の実施
1. AP を一時的に配置し、RF アナライザー (Ekahau、NetAlly) を使用してテスト エリアを歩きます。  
2. RSSI と SNR を記録し、ホット/コールド ゾーンを示す **ヒート マップ** 🗺️ を生成します。  
3. AP 電力、アンテナの種類/方向を調整するか、AP を追加します。SLA が満たされるまで繰り返します。

### ワイヤレスセキュリティ
| 生成 | 暗号化と認証 | 事前共有モード | エンタープライズ モード |
|------------|---------------|-----------------|-----------------|
| WEP | RC4 + 24 ビット IV | 静的キー (解読時間 <1 分) | N/A |
| WPA | RC4 + **TKIP/LEAP** | PSK (8〜63 文字) | 802.1X/EAP-TLS |
| **WPA2** | **AES-CCMP** | WPA2-PSK | WPA2-ENT (EAP) |
| **WPA3** | AES-CCMP-128/192 | **SAE** (Dragonfly) | 802.1X + 192 ビット スイート |

**一般的な強化チェックリスト** 🔒  
FW を更新 → 管理者パスワードを変更 → WPA2/3 ENT または SAE を有効にする → キーをローテーション → ファイアウォール/VLAN を使用して WLAN を分離 → WIDS/WIPS を展開 → ゲストに対して VPN を強制。

### Wi-Fi 保護セットアップ (WPS)
プッシュボタン/PINによるオンボーディング用に設計されていますが、**PINはブルートフォース攻撃を受ける可能性があります（4時間未満）**。WPSを常に無効にするか、ファームウェアをアップグレードしてください。WPSをオフにするとWPSが完全に無効になります。

### ワイヤレス MAC フィルター
NIC MACアドレスのAP許可リスト。セキュリティは最小限です。MACアドレスは平文でブロードキャストされるため、簡単に偽装できます。小規模で静的な環境でのみ使用してください。

### ワイヤレスアンテナ管理
* **オムニ** (ダイポール「ラバーダック」) は 360° 放射します。  
* **指向性** (八木アンテナ、パネルアンテナ、放物線アンテナ) ビームを集中 → 範囲を拡張し、漏れを低減します。  
ガイドライン: AP を中央に配置し、金属/EMI を避け、電力を段階的に調整し、デフォルト設定を文書化します。

### キャプティブポータルの使用
新規ユーザーをAUP同意、バウチャー、または支払いのためのウェブスプラッシュページにリダイレクトします。認証情報を保護するためHTTPSを強制し、RADIUSと連携して会計処理を行います。

### 一般的な Wi-Fi セキュリティ手順
1. ファームウェアのパッチ  
2. デフォルトの管理者認証情報とSSIDを変更する  
3. WPA3-ENT（またはWPA2-ENT）を有効にする  
4. 個人モードの場合、長いPSKは20文字以上  
5. WPSとUPnPを無効にする  
6. WLAN を LAN から分離する (ファイアウォール/VLAN)  
7. ゲストのクライアント分離を有効にする  
8. WIDS/WIPS + NIDSを導入する  
9. 機密トラフィックにはVPNを要求する  
10. すべてのRFイベントをログに記録して監視する 📈  

### 無線通信
#### RFの基礎
* 周波数 = サイクル/秒 (Hz)。Wi-Fi、Bluetooth、Zigbee は 2.4/5/6 GHz ISM 帯域で動作します。
* 多重化/効率: **FHSS、DSSS、OFDM、OFDMA、MIMO、MU-MIMO**。

#### Bluetooth と BLE
短距離（100 m以下）2.4 GHz PAN。ペアリングのデフォルトPINが脆弱。攻撃範囲：
* **Bluesnarfing** (データ盗難)、**Bluebugging** (リモート制御)、**BLUFFS** (セッション キーの破壊)。  
防御: アイドル状態のときは無効にし、数値比較/BLE セキュア接続を強制します。

#### RFID / NFC
読み取りフィールドで動作するパッシブタグ。NFCは4cm未満。リスク：スキミング、クローン、リレー。ファラデースリーブ、相互認証チップを使用し、使用しない場合はNFCを無効にしてください。

### ワイヤレス攻撃
| 攻撃 | 方法 | 緩和策 |
|--------|--------|------------|
| **ウォードライビング** | SSID と設定をスキャン | SSID ビーコン、WPA3、WIDS を無効にする |
| **不正 AP** | 組織内の許可されていない AP | 802.1X、AP ホワイトリスト、WIDS スイープ |
| **Evil Twin** | SSID/BSSID を複製してクライアントを乗っ取る | 証明書を検証し、保存された SSID、VPN を削除する |
| **分離/認証解除** | 偽装管理フレーム → DoS | WPA3 + 802.11w、WIPS |
| **妨害** | SNR を低下させるために RF をフラッドする | チャネル ホップ、指向性アンテナ、ソースの位置特定 |
| **IV/リプレイ** | 弱い IV (WEP) を悪用するか、フレームを再送信します | AES-CCMP を使用し、リプレイ保護を有効にします |

## 衛星通信
衛星リンクは、主に 3 つの軌道領域で地球局と人工衛星間の RF を使用します。

| 軌道 | 高度 | フットプリント | レイテンシー | 一般的な使用 |
|-------|-----------|-----------|-----------|------------|
| **LEO** | 160～2,000 km | 小型 | 20～40 ms | 広帯域衛星群（Starlink）、画像 |
| **MEO** | 2 000 – 35 786 km | 中 | 50～150 ms | GPS、一部のデータリレー |
| **GEO** | 35,786 km (赤道) | 非常に大きい、静止 | 500 ms 以上 | TV、従来の VSAT、SATCOM |

*セキュリティに関する注意事項*  
* ダウンリンク/アップリンクは傍受される可能性があります - エンドツーエンドの暗号化 (IPsec、TLS、FS 変調) を使用します。  
* GEO 遅延はリアルタイム プロトコルの妨げになります。TCP オプティマイザーまたは UDP ベースのトランスポートを選択してください。

## 携帯電話ネットワーク
携帯電話システムは、基地局がサービスを提供するセルにカバレッジを分割します。世代標準はおよそ10年ごとに進化します。

| 世代 | コア技術 | ピーク DL (理論値) | 暗号化 | セキュリティ上の懸念 |
|------------|-----------|------------------------|-----------|-------------------|
| 2G (GSM/CDMA) | 回線/パケット ミックス | 384 kb/s | A5/1、CAVE | 弱い暗号は解読可能、IMSI キャッチャー |
| 3G (UMTS) | W-CDMA | 2 Mb/s | KASUMI | SS7 シグナリング攻撃 |
| 4G (LTE) | OFDMA | 1 Gb/s (静的) | AES-128 SNOW | IMSI キャッチ、不正 eNodeB |
| 5G (NR) | OFDMA + mmWave | 10 Gb/s | 256 ビット AES、SUCI プライバシー | ネットワーク スライシング分離、SDN コア |

**ベスト プラクティス:** キャリア リンクを信頼できないものとして扱い、機密データを TLS またはモバイル VPN でトンネリングし、MDM ベースラインを適用し、不正なベース ステーション (IMSI キャッチャー) を検出します。

## コンテンツ配信ネットワーク（CDN）
CDN はコンテンツを多数のエッジ PoP に複製し、RTT を短縮して DDoS を吸収します。

| 利点 | セキュリティへの影響 |
|---------|---------------------|
| レイテンシの短縮 | TLS オフロードでは証明書の信頼を維持する必要があります。HSTS を推奨 |
| 負荷吸収 | CDN は DDoS のフロントエンドとして機能するが、実際の IP は隠蔽される。誤った設定によりオリジンが漏洩する |
| 地理的フェイルオーバー | PoP GDPR / データ主権制御を整合させる必要があります |

クライアント側の P2P CDN (例: BitTorrent ベース) は負荷を共有しますが、データの整合性が複雑になります。強力なハッシュ検証と署名されたマニフェストを実装します。

## セキュアネットワークコンポーネント
### ハードウェアの安全な操作
* **冗長電源** – 1 + 1 または N + 1 給電のデュアル PSU。UPS/GENSET と組み合わせます。  
* **保証とベンダー サポート** – 重要な機器の RMA が 4 時間以内の場合の SLA。  
* **強化されたファームウェア** – 使用されていないサービスを無効にし、署名を検証し、パッチ ウィンドウをスケジュールします。  
* **環境** – 温度/湿度センサー、ロックベゼル、不正開封防止シールを備えたラック。

### 一般的なネットワーク機器
| デバイス | OSI レイヤー | 目的 | セキュリティに関する注意事項 |
|--------|-----------|---------|---------------|
| リピーター/ハブ | 1 | ブースト/ファンアウト信号 | スイッチに置き換えられました。ACL 機能はありません |
| スイッチ | 2 (ルーティング付き 3) | MAC ベースのフレーム転送、VLAN | STP ガード、DHCP スヌーピングの有効化 |
| ルーター | 3 | IP パケットをルーティング | ACL、BGP 認証で強化 |
| マルチプレクサ/アグリゲーター | 1-2 | 複数のリンクを結合 | QoS 分離を確保 |
| ジャンプボックス | 4-7 | 制御された管理ピボット | MFA、セッション記録 |
| センサー/コレクター (SoC) | さまざま | SIEM へのテレメトリ | キー マテリアルを保護し、更新を検証 |

### ネットワークアクセス制御
* **Preadmission** – VLAN を許可する前にポスチャがチェックされます。  
* **入院後** – 継続的なモニタリング、動的な検疫。  
* **エージェント** – 永続的 (サービス) または解除可能 (CAPTIVE ポータル)。  
* リアルタイム VLAN ステアリングのために 802.1X (ポート) + RADIUS 属性を組み合わせます。  
* ゼロ トラストに準拠: 接続ごとにデバイスの健全性と ID を確認します。

**目標**
- 既知の攻撃を直接的に、ゼロデイ攻撃を間接的に防止/軽減する
- ネットワーク全体にセキュリティポリシーを適用する
- IDを使用してアクセス制御を実行する

### ファイアウォール
| タイプ | 主な特徴 | 一般的なレイヤー | ユースケース |
|------|---------------------|------------------|----------|
| 静的パケット フィルター | IP/ポートの ACL | 3-4 | エッジ ルーター、RTBH |
| ステートフル インスペクション | セッション、動的ルールを追跡 | 3-5 | コア境界 |
| アプリケーション / WAF | レイヤー 7 プロトコル (HTTP、SIP) を解析 | 7 | Web/API を保護 |
| 回線プロキシ (SOCKS) | TCP 回線を作成し、クライアントを非表示にします | 4-5 | 出力制御 |
| NGFW / UTM | DPI + IPS + URL + AV |マルチ |支社 |
| ISFW | 内部セグメンテーション、マイクロセグメンテーション | 2-7 | 横方向の移動の封じ込め |
| ホスト ファイアウォール | ローカル OS フィルター | 3-7 | エンドポイントの強化 |

**ルール管理の原則**  
* 暗黙的な拒否（最後のルール） - 例外を文書化します。  
* 最小権限 - 必要な src/dst/port のみを許可します。  
* 入力フィルターと出力フィルターを分離: WAN 上で RFC 1918 をドロップし、LAN から出るときに DNS/HTTP ポリシーを適用します。  
* ログ: ブート、ポリシー変更、サービスクラッシュ、高レートドロップ。

**プロキシパターン**  
* **フォワードプロキシ** – クライアントの匿名性、送信フィルタリング。  
* **リバース プロキシ** – オリジンを隠し、TLS 終了とキャッシュを有効にします。  
* **透過的 vs. 明示的** – PAC ファイルまたはインライン L2 リダイレクト。

堅牢なアーキテクチャは、境界 NGFW、DMZ リバース プロキシ、東西の ISFW、およびホスト ファイアウォールを階層化し、すべて SIEM/SOAR によって調整されて適応型応答を実現します。

#### ファイアウォール層アーキテクチャ

ファイアウォール アーキテクチャの「層」は、ファイアウォール ソリューションが外部ネットワークから分離する **個別の保護ゾーンの数 (信頼レベル)** によって決まります。  
- **シングル ティア:** 保護されたゾーンが 1 つ (例: 内部 LAN のみ)。
- **2 層:** 2 つの保護ゾーン (例: DMZ と内部 LAN)。
- - **3 層:** 3 つの保護ゾーン (例: DMZ、アプリケーション サブネット、ユーザー LAN)。  
- **4 層 (およびそれ以上):** 4 つ以上の保護ゾーン。各ゾーンは追加のファイアウォール層によって分離されます。

| 層数 | 標準的なトポロジ | インターフェース/ゾーン | 主な使用例 | 利点 | 制限/リスク |
|------------|------------------|------------------|--------------------|--------------------------|---------------------|
| **シングル ティア ファイアウォール** | 内部 LAN の前に 1 台のセキュリティ アプライアンス (または ACL 付きのルーター) を配置します。| • 外部 (インターネット)<br>• 内部 (LAN) | 小規模オフィス、ラボ、ホーム ネットワーク。| • コストと複雑さを最小限に抑えます。<br>• 管理が容易です。| • DMZ なし - パブリック サービスは LAN 内に配置されます。<br>• 単一障害点。<br>• 多層防御は限定的です。|
| **2 層ファイアウォール** | ① 外部境界ファイアウォール/ルーター<br>② 内部ファイアウォール。通常はそれらの間に DMZ があります (スクリーン サブネット)。 | • 外部<br>• DMZ (パブリック サーバー)<br>• 内部 | 中小企業が一般向けサービス (Web、メール) をホストしています。 | • DMZ はパブリック サーバーを分離します。<br>• 2 つのデバイスが階層化フィルタリング (パケット フィルター + ステートフル) を提供します。 | • コストと管理のオーバーヘッドが高くなります。<br>• すべての内部ホストの信頼レベルは引き続き共有されます。 |
| **3 層ファイアウォール** | 2 つのファイアウォールのカスケード **および** 追加の内部セグメンテーション層 (例: ユーザー LAN とサーバー LAN)。 | • 外部<br>• DMZ<br>• アプリケーションまたはサーバー LAN<br>• 内部 (ユーザー LAN) | 重要なサーバーをユーザー ワークステーションから分離する必要がある企業。 | • きめ細かい信頼ゾーン。<br>• 横方向の移動を制限します。<br>• PCI または HIPAA セグメンテーションをサポートします。 | • ルーティング/ACL が複雑です。<br>• 潜在的なパフォーマンスのボトルネック。 |
| **4 層ファイアウォール** | 多層「ゼロトラスト」スタック、多くの場合:<br>1) エッジ ファイアウォール<br>2) DMZ ファイアウォール<br>3) アプリケーション ファイアウォール / WAF<br>4) データセンターまたはデータベース ファイアウォール | • 外部<br>• DMZ<br>• アプリケーション層<br>• データ層<br>• 内部 | 高度なセキュリティ環境 (金融機関、政府機関) またはマイクロセグメント化されたデータセンター。 | • すべての OSI レイヤーで多層防御。<br>• 東西トラフィックの厳格な制御。<br>• 厳格な規制要件を満たしています。 | • 最もコストが高く、運用が複雑です。<br>• 厳格な変更管理と監視が必要です。 |
<img 幅="1536" 高さ="1024" alt="画像" src="https://github.com/user-attachments/assets/0f89001e-8ee1-48c9-b055-ec2dfa943f86" />

> **CISSP試験のためのクイックヒント**
> - *シングル ティア* = 最小限の保護。DMZ なし。  
> - *2 層* = 2 つのフィルタリング段階を持つスクリーン サブネット (DMZ) を導入します。  
> - *3 層* = 専用の内部セグメンテーション層 (多くの場合、アプリケーション サーバー) を追加します。  
> - *4 層* (およびそれ以上) = ゼロ トラストとマイクロ セグメンテーションの原則に準拠した、きめ細かなマルチゾーン アーキテクチャ。

### エンドポイントセキュリティ
エンドポイントセキュリティは、ネットワークに接続するあらゆるデバイス（ノートパソコン、ワークステーション、モバイル、IoT、サーバーなど）にセキュリティ境界を拡張します。脆弱なホストが1つでも存在すると、企業のセキュリティ管理が損なわれる可能性があるため、エンドポイントではローカルで**多層防御**を実施する必要があります。

#### コアコントロール
| レイヤー | テクニック | なぜ重要なのか |
|-------|------------|----------------|
| ハードウェア | UEFI/TPM セキュア ブート、ドライブ暗号化 (BitLocker、FileVault) | ルートキットをブロックし、盗難時に保存データを保護 |
| OS の強化 | ブロートウェアの削除、ベースライン イメージのパッチ適用、最小権限の適用、アプリケーションの許可リスト | 攻撃対象領域を削減し、一貫したゴールド イメージでコンプライアンスを確保 |
| ネットワーク | ホスト ファイアウォール、802.1X サプリカント、ローカル IDS/IPS | 横方向の移動を阻止し、VLAN アクセス前にポスチャを検証します |
| マルウェアと脅威 | リアルタイム ML、動作ヒューリスティック、分離されたサンドボックスを備えた EDR/EPP | シグネチャ AV を超えるファイルレス攻撃とゼロデイ攻撃を検出 |
| データ | DLP エージェント、フルディスクおよびファイル/フォルダーの暗号化、制御されたリムーバブルメディア | データの流出を防ぎ、デバイス紛失のリスクを軽減します |
| ユーザー | MFA、画面ロックのタイムアウト、セキュリティ意識向上トレーニング | クレデンシャル スタッフィングやショルダー サーフィンを阻止 |

**EDR ↔ MDR ↔ XDR**  
* EDR はデバイスのテレメトリとローカル応答に重点を置いています。  
* MDR は、24 時間 365 日対応のアウトソーシングされた脅威ハンティング/SOC を追加します。  
* XDR は、エンドポイント + ネットワーク + クラウド信号を 1 つの相関検出ファブリックに統合します。

#### エンドポイントビルドライフサイクル
1. マスター イメージ (CIS ベンチマーク済み) から**プロビジョニング**します。  
2. 継続的な構成のために **MDM/UEM** に登録します。  
3. 実稼働 VLAN の前に NAC 経由で **ポスチャを検証** します。  
4. **セキュア ポリシー** (FW、DLP、USB 制御) を適用します。  
5. **監視と対応** (EDR アラート → SOAR ランブック)。  
6. 暗号化ワイプと資産追跡機能を備えたデバイスを**廃止**します。

### ケーブル配線、トポロジー、伝送メディア技術
適切なメディアを選択すると、**スループット、距離、EMI 耐性、および物理的なセキュリティ** に影響します。

#### ツイストペアのカテゴリ
| キャット | 速度 / 信号 | 最大距離* | 一般的な使用 |
|-----|-------------------|---------------|-------------|
| 5e | 1 Gb/s | 100 m | レガシー ギガビット |
| 6 | 1 Gb/s (10 Gb/s ≤ 55 m) | 100 m | 標準アクセス レイヤー |
| 6a | 10 Gb/s | 100 m | データセンター ToR |
| 7 | 10 Gb/s (シールド付き) | 100 m | ANSI/TIA 認識なし |
| 8 | 25～40 Gb/s（シールド付き） | 30 m | スイッチからサーバーへのリンク |

\*水平実行の ANSI/TIA 制限。

**同軸 (RG-6)** は引き続き DOCSIS ケーブル モデムに電力を供給します。従来の 10Base-2/5 は現在では廃止されています。

#### 光ファイバークイックビュー
| モード | コア径 | 光源 | 最大距離 (10 Gb/s) | セキュリティ |
|------|--------|--------------|--------------------|----------|
| **MMF** | 50/62.5 µm | LED/VCSEL 850 nm | 400 m | 低コスト、より簡単な終端 |
| **SMF** | 9 µm | レーザー 1310/1550 nm | 10 km+ | EMI 耐性、盗聴困難 |

高密度波長分割多重 (DWDM) により、ストランドあたり 40 ～ 96 λ チャネルが可能になり、バックボーンの容量が大幅に増加します。

### 伝送メディア
信号品質は**減衰、EMI/RFI、クロストーク、ジッター、SNR**に左右されます。対策：

* ツイストレートと STP フォイル (UTP)。  
* ファイバーのガラス コア - 放射放出がなく、**TEMPEST** 要件をサポートします。  
* 物理的な改ざんや火災に対する規制に適合した安全な導管とプレナム定格のジャケット。  
* メディアが盗聴された場合にデータを保護するための暗号化 (MACsec、TLS、IPsec)。

### トランスポートアーキテクチャ
#### ネットワークプレーン
| 飛行機 | 役割 | 技術例 |
|-------|------|--------------|
| データ (転送) | 高速パケット スイッチング/キューイング | L3 スイッチの ASIC |
| 制御 | ルーティング/ACL 状態の構築 | OSPF、BGP、SDN OpenFlow |
| 管理 | 構成とテレメトリ | NETCONF、SNMP、REST API |

#### パラダイムの切り替え
| メソッド | レイテンシ | エラー処理 |
|--------|---------|----------------|
| **カットスルー** | µs (ヘッダーのみ読み取り) | CRC エラー転送 |
| **ストア アンド フォワード** | 上位 (フレームをバッファリング) | 完全な FCS チェック、不良フレームをドロップ |

低遅延 HFT ポッド内ではカットスルーを使用し、セキュリティまたは WAN エッジではストア アンド フォワードを使用します。

### ネットワークトポロジー
| トポロジ | 長所 | 短所 | 今日では一般的か? |
|----------|------|------|---------------|
| **Star** | 障害の分離が容易、スケーラブル | ハブ/スイッチ = SPOF | ✅ (イーサネット) |
| **バス** | 最小限のケーブル | 単一のトランク障害でネットワークが停止 | ❌ レガシー |
| **リング** | 予測可能な遅延 | 中断 = 停止 (デュアルの場合を除く) | ❌ (FDDI レガシー) |
| **メッシュ (フル / 部分)** | 冗長パス、高復元力 | コストのかかるリンク | ✅ データセンター リーフ スパイン |
| **ハイブリッド** | 柔軟性のためのミックス | 設計の複雑さ | ✅ キャンパス コア |

論理と物理は異なる場合があります。たとえば、イーサネットは物理的にはスターですが、ハブ上の**論理はバス**です。

### イーサネット
IEEE 802.3はフレームフォーマット（MACヘッダー + FCS）とCSMA/CD（半二重レガシー）を定義しています。最新のスイッチドイーサネットは衝突を排除し、**全二重**をサポートしています。

| フレーバー | 中 | シグナリング | 最大セグメント |
|--------|---------|-----------|-------------|
| 100Base-TX | Cat 5 | 4B/5B、MLT-3 | 100 m |
| 1000Base-SX | MMF | 8B/10B | 550 m |
| 10GBase-T | Cat 6/6a | 128-DSQ PAM-16 | 55/100 m |
| 25/40/100GBase-SR4 | MMF MPO | PAM-4 | 70～100 m |

### サブテクノロジー
#### シグナリング
* **デジタル** (離散的な 0/1) と **アナログ** (連続)。  
* **ベースバンド** (単一チャネル - イーサネット) と **ブロードバンド** (複数の RF キャリア - DOCSIS)。

#### メディアアクセス方法
| テクニック | 使用者 | 衝突戦略 |
|-----------|---------|--------------------|
| CSMA/CD | レガシー ハブ イーサネット | 検出とバックオフ |
| CSMA/CA | 802.11 Wi-Fi | RTS/CTS で回避 |
| トークン パッシング | FDDI、トークン リング | 衝突なし |
| ポーリング | メインフレーム SNA | マスターがターンを許可 |

#### キャストモード
* **ユニキャスト** – 1 → 1 (TCP)。  
* **ブロードキャスト** – 1 → すべて (ARP)。  
* **マルチキャスト** – 1 → 多数選択 (IGMP)。  
* **エニーキャスト** – 1 → 最も近いもの (DNS ルート)。  
* **Geocast** – 1 → エリア内の受信機 (車両ネットワーク)。

＃＃＃ まとめ
* **エンドポイント セキュリティ** は、すべてのデバイスを独自のセキュリティ ゾーンに変換します。EDR/XDR と強力な強化が非常に重要です。  
* ケーブル配線の制限を理解する: UTP ≤ 100 m、MMF 400 m @ 10 Gb/s、SMF 数 km。ファイバーは EMI およびタッピングに耐性があります。  
* トランスポート アーキテクチャは、**データ、制御、管理プレーン** を分離します。カットスルーとストア アンド フォワードの切り替えにより、遅延と整合性がトレードオフされます。  
* トポロジは回復力に影響します。LAN ではスターが主流で、データ センターではリーフ スパイン メッシュが主流です。  
* イーサネット フレーミングと速度 (10 Mb → 100 Gb+) は、ほとんどの有線ネットワークの基盤となります。  
* サブテクノロジー (ベースバンド/ブロードバンド、CSMA バリアント、キャスト タイプ) は、トラフィックがメディアを共有し、受信者に到達する方法を説明します。  
ワイヤーからワークロードまでのこれらのレイヤーを把握し、CISSP の期待に沿ってネットワークを設計および防御します。🚀
